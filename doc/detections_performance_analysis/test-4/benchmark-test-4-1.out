
set role to aatams;
set role to aatams;
SET
-- Low selectivity filtering (large number of rows returned for each filter)
-- Test Case 1 - 2716283 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
limit 100;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=75.04..476.71 rows=100 width=279) (actual time=8.259..12.962 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=75.04..983740.11 rows=244897 width=279) (actual time=8.257..12.924 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=74.75..542040.70 rows=244897 width=239) (actual time=1.999..5.633 rows=100 loops=1)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.760..3.166 rows=98 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.492..2.829 rows=98 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.436..2.714 rows=98 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.298..1.496 rows=98 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.237..0.283 rows=2 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 16
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.210..0.239 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.175..0.194 rows=2 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.136..0.136 rows=1 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 158
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.035..0.035 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.014..0.014 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.007 rows=27 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.019..0.067 rows=159 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.035..0.053 rows=2 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.019..0.020 rows=1 loops=2)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.011..0.017 rows=9 loops=2)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.008 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.055..0.569 rows=49 loops=2)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=1.114..1.114 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.672 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.036..0.036 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.018 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.226..0.226 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.171 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.021..0.024 rows=1 loops=98)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=98)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.013..0.015 rows=1 loops=98)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.009..0.010 rows=1 loops=98)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.005..0.006 rows=1 loops=98)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=92)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=92)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.003..0.004 rows=1 loops=92)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=92)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 13.571 ms
(61 rows)

-- Test Case 2 - 3913743 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
limit 100;
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2.39..789.19 rows=100 width=279) (actual time=57.143..70.456 rows=100 loops=1)
   ->  Nested Loop  (cost=2.39..599078.28 rows=76141 width=279) (actual time=57.141..70.418 rows=100 loops=1)
         ->  Nested Loop  (cost=2.25..557707.97 rows=228803 width=260) (actual time=57.061..69.489 rows=100 loops=1)
               ->  Nested Loop  (cost=2.12..519575.57 rows=228803 width=263) (actual time=57.054..69.241 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.83..425154.26 rows=228803 width=248) (actual time=57.044..68.891 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.69..360725.41 rows=228803 width=217) (actual time=57.035..68.623 rows=100 loops=1)
                                 ->  Nested Loop  (cost=1.55..319392.92 rows=228803 width=201) (actual time=57.026..68.354 rows=100 loops=1)
                                       ->  Nested Loop  (cost=1.27..243426.12 rows=228803 width=152) (actual time=56.988..67.971 rows=100 loops=1)
                                             ->  Nested Loop  (cost=1.12..197233.18 rows=232476 width=146) (actual time=56.977..67.701 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=0.85..125746.25 rows=232476 width=146) (actual time=56.965..67.366 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=0.56..53094.76 rows=232476 width=138) (actual time=56.921..66.877 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.00..19589.97 rows=22 width=86) (actual time=38.210..66.459 rows=5 loops=1)
                                                                     Join Filter: (tag.id = sensor.tag_id)
                                                                     Rows Removed by Join Filter: 21349
                                                                     ->  Nested Loop  (cost=0.00..17870.54 rows=20 width=88) (actual time=38.078..58.230 rows=5 loops=1)
                                                                           Join Filter: (surgery.tag_id = tag.id)
                                                                           Rows Removed by Join Filter: 29433
                                                                           ->  Nested Loop  (cost=0.00..15499.10 rows=20 width=80) (actual time=37.652..47.436 rows=5 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 15791
                                                                                 ->  Nested Loop  (cost=0.00..14216.16 rows=20 width=72) (actual time=37.544..41.601 rows=5 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 20912
                                                                                       ->  Nested Loop  (cost=0.00..12878.16 rows=20 width=56) (actual time=32.825..32.902 rows=6 loops=1)
                                                                                             Join Filter: (animal.species_id = species.id)
                                                                                             Rows Removed by Join Filter: 83
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.006..0.019 rows=89 loops=1)
                                                                                             ->  Materialize  (cost=0.00..1765.25 rows=183 width=56) (actual time=0.321..0.369 rows=1 loops=89)
                                                                                                   ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=28.552..32.774 rows=1 loops=1)
                                                                                                         Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                         Rows Removed by Filter: 36586
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.005..0.908 rows=3486 loops=6)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.019..2.519 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.004..0.728 rows=3159 loops=5)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.017..1.476 rows=3923 loops=1)
                                                                           ->  Materialize  (cost=0.00..221.40 rows=7227 width=8) (actual time=0.002..1.346 rows=5888 loops=5)
                                                                                 ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..2.668 rows=7227 loops=1)
                                                                     ->  Materialize  (cost=0.00..140.60 rows=5307 width=22) (actual time=0.005..1.014 rows=4271 loops=5)
                                                                           ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.019..2.004 rows=5307 loops=1)
                                                               ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.051..0.069 rows=20 loops=5)
                                                                     Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.004 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 71.561 ms
(60 rows)

-- Test Case 3 - 17098775 rows limited to first 100
explain analyze select * from detection_extract_test_view
where timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3.39..571.82 rows=100 width=279) (actual time=1.114..11.791 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=3.39..31977844.24 rows=5625584 width=279) (actual time=1.112..11.753 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=3.10..21831467.95 rows=5625584 width=239) (actual time=1.052..10.655 rows=100 loops=1)
               ->  Nested Loop  (cost=1.69..12376246.08 rows=5287633 width=193) (actual time=0.950..8.610 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.55..11308727.81 rows=5372518 width=187) (actual time=0.946..8.328 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.41..8537379.53 rows=16144362 width=168) (actual time=0.941..8.047 rows=100 loops=1)
                                 ->  Merge Join  (cost=1.13..3572860.21 rows=16144362 width=168) (actual time=0.916..7.605 rows=100 loops=1)
                                       Merge Cond: (receiver_deployment.id = valid_detection.receiver_deployment_id)
                                       ->  Nested Loop  (cost=0.56..188303.48 rows=5710 width=132) (actual time=0.883..2.172 rows=2 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 16
                                             ->  Nested Loop  (cost=0.56..186931.88 rows=5710 width=135) (actual time=0.877..2.145 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=0.28..184575.50 rows=5710 width=120) (actual time=0.869..2.117 rows=2 loops=1)
                                                         Join Filter: (installation.project_id = receiver_project.id)
                                                         Rows Removed by Join Filter: 86
                                                         ->  Nested Loop  (cost=0.28..178149.81 rows=5710 width=89) (actual time=0.857..2.058 rows=2 loops=1)
                                                               Join Filter: (installation_station.installation_id = installation.id)
                                                               Rows Removed by Join Filter: 112
                                                               ->  Nested Loop  (cost=0.28..168724.94 rows=5710 width=73) (actual time=0.848..1.978 rows=2 loops=1)
                                                                     Join Filter: (receiver_deployment.station_id = installation_station.id)
                                                                     Rows Removed by Join Filter: 2873
                                                                     ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..457.79 rows=5710 width=24) (actual time=0.008..0.010 rows=2 loops=1)
                                                                     ->  Materialize  (cost=0.00..55.46 rows=1964 width=57) (actual time=0.006..0.774 rows=1438 loops=2)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.005..0.757 rows=1964 loops=1)
                                                               ->  Materialize  (cost=0.00..3.65 rows=110 width=32) (actual time=0.002..0.029 rows=57 loops=2)
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.031 rows=110 loops=1)
                                                         ->  Materialize  (cost=0.00..2.12 rows=75 width=39) (actual time=0.002..0.023 rows=44 loops=2)
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.015 rows=75 loops=1)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.009..0.010 rows=1 loops=2)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.009 rows=9 loops=2)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.009 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..3183595.42 rows=16144362 width=52) (actual time=0.030..5.364 rows=100 loops=1)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 2460
                                 ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=100)
                                       Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = receiver.organisation_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.016..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.013..0.015 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.010..0.011 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.006..0.007 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=99)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=99)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=99)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=99)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 12.214 ms
(59 rows)

-- Test Case 4 -  2716283 ^ 3913743 -> 1420919 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=4520.123..4522.402 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=4520.121..4522.379 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=4520.051..4521.427 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=4520.043..4521.164 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=4520.032..4520.700 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=4519.862..4520.469 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=4518.974..4519.515 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=31.925..4168.806 rows=2300454 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.242..3114.249 rows=2300454 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.156..29.974 rows=159 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.127..28.853 rows=114 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.099..27.612 rows=114 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.049..25.324 rows=113 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.434 rows=2504 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.950..23.950 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.368..23.862 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.819 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.321..22.321 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.440..22.312 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=2.018..2.018 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.950 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.007..0.008 rows=1 loops=114)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.006..0.008 rows=1 loops=114)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.030..12.899 rows=14468 loops=159)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=5.661..5.661 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..3.815 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.149..0.149 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.068..0.127 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.053..0.078 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.013 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.025..0.025 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.015..0.024 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.036 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.868..0.868 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.479 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.148..0.148 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.097 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 4522.900 ms
(69 rows)

-- Test Case 5 - 2716283 ^ 17098775 -> 902906 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=387.12..886.77 rows=100 width=279) (actual time=4.564..7.893 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=387.12..375160.94 rows=75008 width=279) (actual time=4.563..7.872 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=386.83..239875.54 rows=75008 width=239) (actual time=4.477..6.774 rows=100 loops=1)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=4.416..4.784 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=4.263..4.574 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=4.218..4.467 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=3.440..3.620 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.092..0.150 rows=4 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.088..0.131 rows=4 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.043..0.054 rows=4 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.035..0.035 rows=1 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.023..0.023 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.009..0.009 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.007 rows=27 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.010 rows=1 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.007..0.015 rows=4 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.017..0.017 rows=1 loops=4)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.004 rows=1 loops=4)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=0.819..0.850 rows=25 loops=4)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 118
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=0.144..0.144 rows=802 loops=4)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.756..0.756 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.421 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.018 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.137..0.137 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.093 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.016..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.013..0.015 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.010..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 8.206 ms
(62 rows)

-- Test Case 6 - 3913743 ^ 17098775 -> 2233756 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=354.52..1250.94 rows=100 width=279) (actual time=13.707..87.126 rows=100 loops=1)
   ->  Nested Loop  (cost=354.52..209410.30 rows=23321 width=279) (actual time=13.705..87.102 rows=100 loops=1)
         ->  Nested Loop  (cost=354.38..196739.36 rows=70078 width=260) (actual time=13.644..86.136 rows=100 loops=1)
               ->  Nested Loop  (cost=354.24..185060.13 rows=70078 width=263) (actual time=13.638..85.874 rows=100 loops=1)
                     ->  Nested Loop  (cost=353.96..156140.68 rows=70078 width=248) (actual time=13.618..85.472 rows=100 loops=1)
                           ->  Nested Loop  (cost=353.82..136407.35 rows=70078 width=217) (actual time=13.612..85.191 rows=100 loops=1)
                                 ->  Nested Loop  (cost=353.67..123747.99 rows=70078 width=201) (actual time=13.605..84.919 rows=100 loops=1)
                                       ->  Nested Loop  (cost=353.40..100480.81 rows=70078 width=152) (actual time=13.584..84.559 rows=100 loops=1)
                                             ->  Nested Loop  (cost=353.25..86332.79 rows=71203 width=146) (actual time=13.576..84.278 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=352.97..64437.30 rows=71203 width=146) (actual time=13.553..83.893 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=352.69..42183.63 rows=71203 width=138) (actual time=13.524..83.383 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.85..9870.73 rows=22 width=86) (actual time=4.004..72.898 rows=37 loops=1)
                                                                     ->  Nested Loop  (cost=0.57..9863.45 rows=20 width=88) (actual time=3.996..72.742 rows=37 loops=1)
                                                                           ->  Nested Loop  (cost=0.29..9856.58 rows=20 width=80) (actual time=3.982..72.597 rows=37 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 137502
                                                                                 ->  Nested Loop  (cost=0.29..8573.65 rows=20 width=72) (actual time=3.910..39.015 rows=36 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 141989
                                                                                       ->  Nested Loop  (cost=0.29..7235.65 rows=20 width=56) (actual time=0.079..1.110 rows=37 loops=1)
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.006..0.043 rows=211 loops=1)
                                                                                             ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.004..0.004 rows=0 loops=211)
                                                                                                   Index Cond: (id = animal.species_id)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 1
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.000..0.421 rows=3839 loops=37)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.456 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.000..0.372 rows=3821 loops=36)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.858 rows=3923 loops=1)
                                                                           ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=37)
                                                                                 Index Cond: (id = surgery.tag_id)
                                                                                 Heap Fetches: 0
                                                                     ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=37)
                                                                           Index Cond: (tag_id = tag.id)
                                                               ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.270..0.280 rows=3 loops=37)
                                                                     Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                     Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     Rows Removed by Filter: 735
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.102..0.102 rows=742 loops=37)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.004 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 87.805 ms
(59 rows)

-- Test Case 7 - 2716283 ^ 3913743 ^ 17098775 -> 690003 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=485.535..487.419 rows=100 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=485.533..487.394 rows=100 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=485.456..486.464 rows=100 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=485.447..486.198 rows=100 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=485.423..485.746 rows=100 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=483.765..484.027 rows=100 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=35.221..457.257 rows=183150 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=31.019..370.813 rows=183150 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.531..26.512 rows=73 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.517..26.125 rows=57 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.489..25.731 rows=57 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.081 rows=408 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.453..25.453 rows=167 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.942..25.362 rows=167 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.545 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.847..23.847 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.566..23.772 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.514 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.519..22.519 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.620..22.511 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.005 rows=1 loops=57)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.005 rows=1 loops=57)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.127..3.927 rows=2509 loops=73)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 1582
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.877..0.877 rows=5034 loops=73)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.173..4.173 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.508 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.144..0.144 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.060..0.118 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.044..0.069 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.015 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.020..0.020 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.020 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.012..0.036 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.636..1.636 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.165..1.171 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.222 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.142..0.142 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.091 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 487.863 ms
(73 rows)

 
-- High selectivity filtering (small number of rows returned for each filter)
-- Test Case 8 - 5909 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
limit 100;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=75.04..476.71 rows=100 width=279) (actual time=1.681..5.218 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=75.04..983740.11 rows=244897 width=279) (actual time=1.680..5.197 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=74.75..542040.70 rows=244897 width=239) (actual time=1.621..4.132 rows=100 loops=1)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.530..2.004 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.380..1.799 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.336..1.690 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.470..0.754 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.352..0.404 rows=3 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 31
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.344..0.363 rows=3 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.335..0.341 rows=3 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.282..0.282 rows=1 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 872
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.021..0.021 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 27
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.007 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 7
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.006 rows=28 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.103 rows=873 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.051..0.055 rows=3 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.006..0.006 rows=1 loops=3)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.010 rows=11 loops=3)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.044..0.095 rows=33 loops=3)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.846..0.846 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.432 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.019 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.137..0.137 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.084 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.011..0.013 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.008..0.009 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 5.502 ms
(61 rows)

-- Test Case 9 - 2153 rows
set geqo_threshold to 12;
SET
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
limit 100;
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2.39..789.19 rows=100 width=279) (actual time=46.590..50.248 rows=100 loops=1)
   ->  Nested Loop  (cost=2.39..599078.28 rows=76141 width=279) (actual time=46.588..50.215 rows=100 loops=1)
         ->  Nested Loop  (cost=2.25..557707.97 rows=228803 width=260) (actual time=46.510..49.273 rows=100 loops=1)
               ->  Nested Loop  (cost=2.12..519575.57 rows=228803 width=263) (actual time=46.503..49.023 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.83..425154.26 rows=228803 width=248) (actual time=46.492..48.664 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.69..360725.41 rows=228803 width=217) (actual time=46.484..48.395 rows=100 loops=1)
                                 ->  Nested Loop  (cost=1.55..319392.92 rows=228803 width=201) (actual time=46.475..48.130 rows=100 loops=1)
                                       ->  Nested Loop  (cost=1.27..243426.12 rows=228803 width=152) (actual time=46.445..47.783 rows=100 loops=1)
                                             ->  Nested Loop  (cost=1.12..197233.18 rows=232476 width=146) (actual time=46.436..47.504 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=0.85..125746.25 rows=232476 width=146) (actual time=46.424..47.160 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=0.56..53094.76 rows=232476 width=138) (actual time=46.396..46.685 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.00..19589.97 rows=22 width=86) (actual time=23.315..46.184 rows=4 loops=1)
                                                                     Join Filter: (tag.id = sensor.tag_id)
                                                                     Rows Removed by Join Filter: 15976
                                                                     ->  Nested Loop  (cost=0.00..17870.54 rows=20 width=88) (actual time=23.266..39.976 rows=4 loops=1)
                                                                           Join Filter: (surgery.tag_id = tag.id)
                                                                           Rows Removed by Join Filter: 22661
                                                                           ->  Nested Loop  (cost=0.00..15499.10 rows=20 width=80) (actual time=23.085..32.256 rows=4 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 11824
                                                                                 ->  Nested Loop  (cost=0.00..14216.16 rows=20 width=72) (actual time=23.046..28.028 rows=4 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 11799
                                                                                       ->  Nested Loop  (cost=0.00..12878.16 rows=20 width=56) (actual time=22.753..22.785 rows=4 loops=1)
                                                                                             Join Filter: (animal.species_id = species.id)
                                                                                             Rows Removed by Join Filter: 53
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.006..0.016 rows=57 loops=1)
                                                                                             ->  Materialize  (cost=0.00..1765.25 rows=183 width=56) (actual time=0.347..0.398 rows=1 loops=57)
                                                                                                   ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.750..22.687 rows=1 loops=1)
                                                                                                         Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                         Rows Removed by Filter: 36586
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.003..0.850 rows=2951 loops=4)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.507 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.003..0.643 rows=2957 loops=4)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.874 rows=3923 loops=1)
                                                                           ->  Materialize  (cost=0.00..221.40 rows=7227 width=8) (actual time=0.002..1.159 rows=5666 loops=4)
                                                                                 ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.005..1.314 rows=7227 loops=1)
                                                                     ->  Materialize  (cost=0.00..140.60 rows=5307 width=22) (actual time=0.003..0.974 rows=3995 loops=4)
                                                                           ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.004..1.322 rows=5307 loops=1)
                                                               ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.048..0.110 rows=25 loops=4)
                                                                     Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 51.120 ms
(60 rows)

-- Test Case 10 - 1065 rows
explain analyze select * from detection_extract_test_view
  where timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=398.97..1704.98 rows=100 width=279) (actual time=6.926..11.841 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=398.97..6772.29 rows=488 width=279) (actual time=6.924..11.809 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=398.68..5892.13 rows=488 width=239) (actual time=6.857..10.688 rows=100 loops=1)
               ->  Nested Loop  (cost=397.27..4950.72 rows=459 width=193) (actual time=6.769..8.629 rows=100 loops=1)
                     ->  Nested Loop  (cost=397.13..4858.12 rows=466 width=187) (actual time=6.763..8.344 rows=100 loops=1)
                           ->  Nested Loop  (cost=396.99..4617.80 rows=1400 width=168) (actual time=6.756..8.081 rows=100 loops=1)
                                 ->  Nested Loop  (cost=396.85..4384.47 rows=1400 width=171) (actual time=6.750..7.812 rows=100 loops=1)
                                       ->  Hash Join  (cost=396.57..3806.73 rows=1400 width=156) (actual time=6.732..7.336 rows=100 loops=1)
                                             Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                             ->  Hash Join  (cost=337.39..3728.30 rows=1400 width=156) (actual time=5.861..6.388 rows=100 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Hash Join  (cost=334.70..3706.36 rows=1400 width=125) (actual time=5.797..6.262 rows=100 loops=1)
                                                         Hash Cond: (installation_station.installation_id = installation.id)
                                                         ->  Hash Join  (cost=330.23..3682.64 rows=1400 width=109) (actual time=5.718..6.137 rows=100 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Hash Join  (cost=260.04..3591.45 rows=1400 width=60) (actual time=4.439..4.786 rows=100 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.083..0.317 rows=100 loops=1)
                                                                           Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                     ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.329..4.329 rows=5710 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                                           ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.613 rows=5710 loops=1)
                                                               ->  Hash  (cost=45.64..45.64 rows=1964 width=57) (actual time=1.263..1.263 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 179kB
                                                                     ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.480 rows=1964 loops=1)
                                                         ->  Hash  (cost=3.10..3.10 rows=110 width=32) (actual time=0.063..0.063 rows=110 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 8kB
                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.026 rows=110 loops=1)
                                                   ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.044..0.044 rows=75 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.017 rows=75 loops=1)
                                             ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.850..0.850 rows=1519 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.006..0.438 rows=1519 loops=1)
                                       ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.receiver_id)
                                 ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = receiver.model_id)
                           ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = receiver.organisation_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
               ->  Nested Loop Left Join  (cost=1.41..2.04 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.68 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..1.24 rows=1 width=22) (actual time=0.010..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.90 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.56 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 12.181 ms
(60 rows)

-- Test Case 11 - 5909 ^ 2153 -> 609 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=36.217..38.281 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=36.215..38.258 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=36.146..37.323 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=36.137..37.065 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=36.126..36.616 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=35.958..36.385 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=35.060..35.423 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.998..34.982 rows=1590 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.690..29.845 rows=1590 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.582..26.723 rows=14 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.567..26.651 rows=14 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.538..26.561 rows=14 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.528..24.531 rows=14 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.402 rows=2773 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.501..23.501 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.349..23.477 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.499 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.296..22.296 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.422..22.288 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.988..1.988 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.916 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.005 rows=1 loops=14)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=14)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.024..0.174 rows=114 loops=14)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.285..4.285 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.492 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.110..0.110 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.063..0.102 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.049..0.073 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.013 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.019 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.879..0.879 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.482 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.146..0.146 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.087 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 38.761 ms
(69 rows)

-- Test Case 12 - 5909 ^ 1065 -> 55 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.633..4.263 rows=55 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.631..4.242 rows=55 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3373.72 rows=6 width=239) (actual time=0.574..3.629 rows=55 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3371.58 rows=6 width=239) (actual time=0.568..3.436 rows=55 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3368.94 rows=6 width=215) (actual time=0.561..3.250 rows=55 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3366.85 rows=6 width=215) (actual time=0.555..3.052 rows=55 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3364.85 rows=6 width=215) (actual time=0.544..2.884 rows=55 loops=1)
                                       ->  Nested Loop  (cost=27.78..3361.41 rows=6 width=193) (actual time=0.531..2.616 rows=55 loops=1)
                                             ->  Nested Loop  (cost=27.63..3360.22 rows=6 width=187) (actual time=0.526..2.468 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3356.96 rows=19 width=168) (actual time=0.523..2.317 rows=55 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3349.38 rows=19 width=168) (actual time=0.516..2.123 rows=55 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 825
                                                               ->  Nested Loop  (cost=27.21..3343.62 rows=19 width=171) (actual time=0.506..1.841 rows=55 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3335.78 rows=19 width=156) (actual time=0.497..1.573 rows=55 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.025..1.015 rows=1065 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.295..0.295 rows=64 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.089..0.249 rows=64 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.081..0.118 rows=15 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.071..0.098 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.020 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.024..0.024 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.007..0.012 rows=15 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.002..0.006 rows=4 loops=15)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=55)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=55)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.56 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=55)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=55)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=55)
               Index Cond: (animal.species_id = id)
 Total runtime: 4.574 ms
(58 rows)

-- Test Case 13 -  2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.69..5500.06 rows=2 width=279) (actual time=33.072..34.176 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.69..5500.06 rows=2 width=279) (actual time=33.069..34.161 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.004..0.015 rows=51 loops=1)
         ->  Materialize  (cost=2141.69..5493.92 rows=6 width=260) (actual time=0.619..0.640 rows=55 loops=51)
               ->  Nested Loop  (cost=2141.69..5493.89 rows=6 width=260) (actual time=31.556..32.335 rows=55 loops=1)
                     ->  Nested Loop  (cost=2141.55..5492.70 rows=6 width=254) (actual time=31.547..32.181 rows=55 loops=1)
                           ->  Nested Loop  (cost=2141.27..5490.31 rows=6 width=254) (actual time=31.536..31.999 rows=55 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 825
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.006 rows=16 loops=1)
                                 ->  Materialize  (cost=2141.27..5487.72 rows=6 width=257) (actual time=1.767..1.974 rows=55 loops=16)
                                       ->  Nested Loop  (cost=2141.27..5487.69 rows=6 width=257) (actual time=28.270..31.437 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.99..5485.22 rows=6 width=242) (actual time=28.261..31.260 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.84..5483.53 rows=6 width=211) (actual time=28.253..31.100 rows=55 loops=1)
                                                         Join Filter: (installation_station.installation_id = installation.id)
                                                         Rows Removed by Join Filter: 5995
                                                         ->  Index Scan using installation_project_id_index on installation  (cost=0.14..16.50 rows=110 width=32) (actual time=0.006..0.045 rows=110 loops=1)
                                                         ->  Materialize  (cost=2140.70..5457.14 rows=6 width=195) (actual time=0.242..0.260 rows=55 loops=110)
                                                               ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.647..28.011 rows=55 loops=1)
                                                                     ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.635..27.823 rows=55 loops=1)
                                                                           ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.623..27.615 rows=55 loops=1)
                                                                                 ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.595..27.436 rows=55 loops=1)
                                                                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                                       ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.023..0.649 rows=1065 loops=1)
                                                                                             Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                       ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.397..26.397 rows=27 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                                             ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.033..26.368 rows=27 loops=1)
                                                                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.007..26.236 rows=27 loops=1)
                                                                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.535 rows=3923 loops=1)
                                                                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.969..24.969 rows=27 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.545..24.953 rows=27 loops=1)
                                                                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.567 rows=3920 loops=1)
                                                                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.522..23.522 rows=35 loops=1)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.354..23.499 rows=35 loops=1)
                                                                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.472 rows=4023 loops=1)
                                                                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.304..22.304 rows=1 loops=1)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.430..22.297 rows=1 loops=1)
                                                                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                                             Rows Removed by Filter: 36586
                                                                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=27)
                                                                                                         Index Cond: (tag_id = surgery.tag_id)
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                                                                       Index Cond: (id = sensor.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                                                 Index Cond: (id = valid_detection.receiver_deployment_id)
                                                                     ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.station_id)
                                                   ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.002 rows=1 loops=55)
                                                         Index Cond: (id = installation.project_id)
                                             ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=55)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 34.717 ms
(66 rows)

-- Test Case 14 -  5909 ^ 2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.838..33.042 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.836..33.028 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Nested Loop  (cost=2141.26..5476.66 rows=1 width=260) (actual time=26.761..31.781 rows=55 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 9460
               ->  Nested Loop  (cost=2141.26..5465.77 rows=1 width=254) (actual time=26.688..28.957 rows=55 loops=1)
                     ->  Nested Loop  (cost=2140.98..5465.37 rows=1 width=254) (actual time=26.677..28.753 rows=55 loops=1)
                           Join Filter: (receiver.model_id = device_model.id)
                           Rows Removed by Join Filter: 825
                           ->  Nested Loop  (cost=2140.98..5464.01 rows=1 width=257) (actual time=26.662..28.389 rows=55 loops=1)
                                 ->  Nested Loop  (cost=2140.70..5463.60 rows=1 width=242) (actual time=26.651..28.186 rows=55 loops=1)
                                       Join Filter: (installation_station.installation_id = installation.id)
                                       ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.031..0.070 rows=1 loops=1)
                                             Join Filter: (installation.project_id = receiver_project.id)
                                             Rows Removed by Join Filter: 109
                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.014..0.026 rows=1 loops=1)
                                                   Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                   Rows Removed by Filter: 74
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                       ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.611..28.086 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.600..27.885 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.588..27.681 rows=55 loops=1)
                                                         ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.545..27.422 rows=55 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.025..0.633 rows=1065 loops=1)
                                                                     Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.364..26.364 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.056..26.337 rows=27 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.031..26.210 rows=27 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.490 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.994..24.994 rows=27 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.586..24.975 rows=27 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.543 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.563..23.563 rows=35 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.394..23.538 rows=35 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.490 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.344..22.344 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.479..22.336 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=27)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=55)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=55)
                                       Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=55)
                     ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                           Index Cond: (id = valid_detection.receiver_download_id)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.023 rows=173 loops=55)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=55)
 Total runtime: 33.486 ms
(66 rows)

-- Mixed selectivity filtering
-- Test Case 15 - 5909 ^ 833188 -> 184 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=48.510..1408.486 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=48.508..1408.441 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=48.435..1407.015 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=48.427..1406.677 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=48.406..1406.054 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=48.220..1405.768 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=47.336..1404.789 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.135..1298.718 rows=702071 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.823..976.150 rows=702071 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.720..28.548 rows=83 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.708..27.899 rows=68 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.679..27.018 rows=68 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.630..24.799 rows=67 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.428 rows=2240 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.580..23.580 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.452..23.519 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.503 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.288..22.288 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.067..22.281 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=2.025..2.025 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.947 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.008..0.009 rows=1 loops=68)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.007 rows=1 loops=68)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.036..7.873 rows=8459 loops=83)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.288..4.288 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.522 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.110..0.110 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.063..0.103 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.048..0.073 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.014 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.017 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.861..0.861 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.448 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.146..0.146 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.098 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 1408.968 ms
(69 rows)

-- Test Case 16 - 5909 ^ 17098775 -> 3889 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=387.12..886.77 rows=100 width=279) (actual time=1.730..5.172 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=387.12..375160.94 rows=75008 width=279) (actual time=1.729..5.147 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=386.83..239875.54 rows=75008 width=239) (actual time=1.680..4.080 rows=100 loops=1)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=1.608..2.026 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=1.462..1.807 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=1.421..1.713 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=0.652..0.872 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.051..0.078 rows=3 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.048..0.069 rows=3 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.042..0.047 rows=3 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.033..0.033 rows=1 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.022..0.022 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 27
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.008 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 7
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.006 rows=28 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.009..0.009 rows=1 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.007..0.010 rows=3 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.006..0.006 rows=1 loops=3)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=3)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=0.190..0.251 rows=33 loops=3)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 148
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=0.067..0.067 rows=210 loops=3)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.760..0.760 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.431 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.015 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.136..0.136 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.095 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.011..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.008..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 5.487 ms
(62 rows)

-- Test Case 17 - 2716283 ^ 464 -> 448 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=32.247..35.241 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=32.245..35.211 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=32.176..34.267 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=32.169..33.985 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=32.159..33.509 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=31.987..33.272 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=31.090..32.310 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.902..32.074 rows=104 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.603..27.673 rows=104 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.539..26.628 rows=8 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.485..26.546 rows=8 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.457..26.492 rows=8 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.434..24.459 rows=8 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.346 rows=2541 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.526..23.526 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.507..23.517 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.533 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.331..22.331 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.496..22.326 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.998..1.998 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.934 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.005 rows=1 loops=8)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.008..0.009 rows=1 loops=8)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.021..0.121 rows=13 loops=8)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.271..4.271 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.527 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.152..0.152 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.069..0.132 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.054..0.079 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.015 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.012..0.038 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.877..0.877 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.456 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.146..0.146 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.086 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 35.731 ms
(69 rows)

-- Test Case 18 - 2716283 ^ 2005 -> 4 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2013-06-08 00:00:00+00' and '2013-06-08 01:00:00+00'
limit 100;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.728..3.419 rows=4 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.727..3.417 rows=4 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3884.18 rows=7 width=239) (actual time=2.669..3.327 rows=4 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3881.69 rows=7 width=239) (actual time=2.662..3.309 rows=4 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3878.61 rows=7 width=215) (actual time=2.654..3.290 rows=4 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3876.17 rows=7 width=215) (actual time=2.646..3.270 rows=4 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3873.84 rows=7 width=215) (actual time=2.634..3.248 rows=4 loops=1)
                                       ->  Nested Loop  (cost=27.78..3870.07 rows=7 width=193) (actual time=2.618..3.216 rows=4 loops=1)
                                             ->  Nested Loop  (cost=27.63..3868.68 rows=7 width=187) (actual time=2.613..3.203 rows=4 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3864.90 rows=22 width=168) (actual time=2.608..3.188 rows=4 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3856.39 rows=22 width=168) (actual time=2.599..3.167 rows=4 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 60
                                                               ->  Nested Loop  (cost=27.21..3849.91 rows=22 width=171) (actual time=2.587..3.128 rows=4 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3840.83 rows=22 width=156) (actual time=2.576..3.104 rows=4 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3808.21 rows=1613 width=52) (actual time=0.094..1.936 rows=1839 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2013-06-08 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-06-08 01:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.797..0.797 rows=282 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.072..0.609 rows=282 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.063..0.143 rows=45 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.052..0.078 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.018 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.025..0.025 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.008..0.044 rows=45 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.007 rows=6 loops=45)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.005..0.005 rows=1 loops=4)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=4)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.38 rows=1 width=16) (actual time=0.004..0.005 rows=1 loops=4)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=4)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.003 rows=1 loops=4)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.53 rows=1 width=22) (actual time=0.005..0.005 rows=1 loops=4)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=4)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=4)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.003..0.003 rows=1 loops=4)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=4)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.004 rows=1 loops=4)
               Index Cond: (animal.species_id = id)
 Total runtime: 3.736 ms
(58 rows)

-- Test Case 19 - 464 ^ 17098775 -> 6 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=354.52..1250.94 rows=100 width=279) (actual time=10.280..74.685 rows=6 loops=1)
   ->  Nested Loop  (cost=354.52..209410.30 rows=23321 width=279) (actual time=10.279..74.684 rows=6 loops=1)
         ->  Nested Loop  (cost=354.38..196739.36 rows=70078 width=260) (actual time=10.224..74.576 rows=6 loops=1)
               ->  Nested Loop  (cost=354.24..185060.13 rows=70078 width=263) (actual time=10.218..74.557 rows=6 loops=1)
                     ->  Nested Loop  (cost=353.96..156140.68 rows=70078 width=248) (actual time=10.208..74.525 rows=6 loops=1)
                           ->  Nested Loop  (cost=353.82..136407.35 rows=70078 width=217) (actual time=10.203..74.506 rows=6 loops=1)
                                 ->  Nested Loop  (cost=353.67..123747.99 rows=70078 width=201) (actual time=10.197..74.485 rows=6 loops=1)
                                       ->  Nested Loop  (cost=353.40..100480.81 rows=70078 width=152) (actual time=10.189..74.456 rows=6 loops=1)
                                             ->  Nested Loop  (cost=353.25..86332.79 rows=71203 width=146) (actual time=10.182..74.436 rows=6 loops=1)
                                                   ->  Nested Loop  (cost=352.97..64437.30 rows=71203 width=146) (actual time=10.173..74.404 rows=6 loops=1)
                                                         ->  Nested Loop  (cost=352.69..42183.63 rows=71203 width=138) (actual time=10.148..74.340 rows=6 loops=1)
                                                               ->  Nested Loop  (cost=0.85..9870.73 rows=22 width=86) (actual time=5.418..72.298 rows=24 loops=1)
                                                                     ->  Nested Loop  (cost=0.57..9863.45 rows=20 width=88) (actual time=5.408..72.145 rows=20 loops=1)
                                                                           ->  Nested Loop  (cost=0.29..9856.58 rows=20 width=80) (actual time=5.394..72.037 rows=20 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 78440
                                                                                 ->  Nested Loop  (cost=0.29..8573.65 rows=20 width=72) (actual time=3.626..52.211 rows=20 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 78380
                                                                                       ->  Nested Loop  (cost=0.29..7235.65 rows=20 width=56) (actual time=1.550..30.332 rows=20 loops=1)
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.555 rows=4023 loops=1)
                                                                                             ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.007..0.007 rows=0 loops=4023)
                                                                                                   Index Cond: (id = animal.species_id)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 1
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.001..0.488 rows=3920 loops=20)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.501 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.000..0.420 rows=3923 loops=20)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.871 rows=3923 loops=1)
                                                                           ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=20)
                                                                                 Index Cond: (id = surgery.tag_id)
                                                                                 Heap Fetches: 0
                                                                     ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.006 rows=1 loops=20)
                                                                           Index Cond: (tag_id = tag.id)
                                                               ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.083..0.083 rows=0 loops=24)
                                                                     Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                     Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     Rows Removed by Filter: 19
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.013..0.013 rows=19 loops=24)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.008..0.009 rows=1 loops=6)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=6)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.003 rows=1 loops=6)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.003..0.004 rows=1 loops=6)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=6)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.002 rows=1 loops=6)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=6)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=6)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=6)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 75.342 ms
(59 rows)

-- Test Case 20 - 833188 ^ 5489 -> 210 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 100;
                                                                                                                                             QUERY PLAN                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2473.59..12305.40 rows=7 width=279) (actual time=274.395..277.533 rows=100 loops=1)
   ->  Nested Loop  (cost=2473.59..12305.40 rows=7 width=279) (actual time=274.393..277.510 rows=100 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 9533
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.004..0.013 rows=46 loops=1)
         ->  Materialize  (cost=2473.59..12288.44 rows=20 width=260) (actual time=5.664..5.934 rows=209 loops=46)
               ->  Nested Loop  (cost=2473.59..12288.34 rows=20 width=260) (actual time=260.542..271.817 rows=210 loops=1)
                     ->  Nested Loop  (cost=2473.44..12284.37 rows=20 width=254) (actual time=260.533..271.236 rows=210 loops=1)
                           ->  Nested Loop  (cost=2473.16..12277.66 rows=20 width=254) (actual time=260.521..270.547 rows=210 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 3150
                                 ->  Nested Loop  (cost=2473.16..12271.66 rows=20 width=257) (actual time=260.496..269.547 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2472.88..12263.40 rows=20 width=242) (actual time=260.485..268.716 rows=210 loops=1)
                                             Join Filter: (installation_station.installation_id = installation.id)
                                             Rows Removed by Join Filter: 22890
                                             ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.073..0.172 rows=110 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.028 rows=110 loops=1)
                                                   ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.048..0.048 rows=75 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.004..0.022 rows=75 loops=1)
                                             ->  Materialize  (cost=2470.19..12223.15 rows=20 width=195) (actual time=0.811..2.362 rows=210 loops=110)
                                                   ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=89.162..257.521 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=89.151..256.794 rows=210 loops=1)
                                                               ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=89.138..255.926 rows=210 loops=1)
                                                                     ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.315..27.871 rows=147 loops=1)
                                                                           ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.301..27.230 rows=119 loops=1)
                                                                                 ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.271..26.627 rows=119 loops=1)
                                                                                       Hash Cond: (surgery.release_id = animal_release.id)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.539 rows=3923 loops=1)
                                                                                       ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.158..25.158 rows=117 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                             ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.682..25.097 rows=117 loops=1)
                                                                                                   Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                   ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.542 rows=3920 loops=1)
                                                                                                   ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.626..23.626 rows=125 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                                         ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.474..23.559 rows=125 loops=1)
                                                                                                               Hash Cond: (animal.species_id = species.id)
                                                                                                               ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.505 rows=4023 loops=1)
                                                                                                               ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.295..22.295 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.071..22.288 rows=1 loops=1)
                                                                                                                           Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                                           Rows Removed by Filter: 36586
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                       Index Cond: (id = surgery.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                 Index Cond: (tag_id = tag.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.548..1.549 rows=1 loops=147)
                                                                           Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                                           ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.546..1.546 rows=0 loops=147)
                                                                                 ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.628..0.628 rows=5041 loops=147)
                                                                                       Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                                 ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.900..0.900 rows=5668 loops=147)
                                                                                       Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=210)
                                                                     Index Cond: (id = valid_detection.receiver_deployment_id)
                                                         ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=210)
                                                               Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=210)
                                             Index Cond: (id = receiver_deployment.receiver_id)
                                 ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=210)
                                       ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.004..0.008 rows=16 loops=1)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=210)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=210)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 278.014 ms
(70 rows)

-- Test Case 21 - 5909 ^ 2153 ^ 17098775 -> 284 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=34.182..36.287 rows=100 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=34.180..36.251 rows=100 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=34.112..35.339 rows=100 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=34.105..35.077 rows=100 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=34.095..34.625 rows=100 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=32.444..32.900 rows=100 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.598..32.555 rows=1209 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.449..27.837 rows=1209 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.197..26.083 rows=17 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.184..26.006 rows=17 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.154..25.912 rows=17 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.344 rows=2490 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.115..25.115 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.707..25.095 rows=27 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.541 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.685..23.685 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.518..23.666 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.503 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.464..22.464 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.570..22.456 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=17)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=17)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.037..0.081 rows=71 loops=17)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 22
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.024..0.024 rows=99 loops=17)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.130..4.130 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.488 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.108..0.108 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.061..0.094 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.047..0.072 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.015 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.020..0.020 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.009..0.019 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.015 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.627..1.627 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.163..1.188 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.005..0.214 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.141..0.141 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.086 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 36.743 ms
(73 rows)

-- Test Case 22 - 5909 ^ 833188 ^ 5489 -> 13 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 100;
                                                                                                                                       QUERY PLAN                                                                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470.75..12251.27 rows=1 width=279) (actual time=88.024..257.074 rows=13 loops=1)
   ->  Nested Loop  (cost=2470.75..12251.27 rows=1 width=279) (actual time=88.023..257.070 rows=13 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 650
         ->  Nested Loop  (cost=2470.75..12249.09 rows=1 width=260) (actual time=87.950..256.730 rows=13 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 2236
               ->  Nested Loop  (cost=2470.75..12238.20 rows=1 width=254) (actual time=87.881..256.043 rows=13 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 195
                     ->  Nested Loop  (cost=2470.75..12236.84 rows=1 width=257) (actual time=87.872..255.956 rows=13 loops=1)
                           ->  Nested Loop  (cost=2470.47..12236.43 rows=1 width=242) (actual time=87.862..255.898 rows=13 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 197
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.029..0.069 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.015..0.027 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.019 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2470.47..12229.77 rows=20 width=195) (actual time=87.821..255.766 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=87.811..255.095 rows=210 loops=1)
                                             ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=87.799..254.390 rows=210 loops=1)
                                                   ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=87.786..253.583 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.508..27.990 rows=147 loops=1)
                                                               ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.493..27.389 rows=119 loops=1)
                                                                     ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.467..26.824 rows=119 loops=1)
                                                                           Hash Cond: (surgery.release_id = animal_release.id)
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.536 rows=3923 loops=1)
                                                                           ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.348..25.348 rows=117 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                 ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.882..25.307 rows=117 loops=1)
                                                                                       Hash Cond: (animal_release.animal_id = animal.id)
                                                                                       ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.521 rows=3920 loops=1)
                                                                                       ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.844..23.844 rows=125 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                             ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.642..23.805 rows=125 loops=1)
                                                                                                   Hash Cond: (animal.species_id = species.id)
                                                                                                   ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.560 rows=4023 loops=1)
                                                                                                   ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.491..22.491 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.232..22.482 rows=1 loops=1)
                                                                                                               Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                               Rows Removed by Filter: 36586
                                                                     ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=119)
                                                                           Index Cond: (id = surgery.tag_id)
                                                                           Heap Fetches: 0
                                                               ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                     Index Cond: (tag_id = tag.id)
                                                         ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.531..1.532 rows=1 loops=147)
                                                               Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                               ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.530..1.530 rows=0 loops=147)
                                                                     ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.629..0.629 rows=5041 loops=147)
                                                                           Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.883..0.883 rows=5668 loops=147)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=210)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=210)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=210)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=13)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=13)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.022 rows=173 loops=13)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.006 rows=51 loops=13)
 Total runtime: 257.392 ms
(69 rows)

-- Test Case 23 - 5909 ^ 833188 ^ 17098775 -> 54 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=34.499..1358.816 rows=54 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=34.496..1358.788 rows=54 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=34.427..1357.929 rows=54 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=34.418..1357.731 rows=54 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=34.401..1357.387 rows=54 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=32.858..1355.781 rows=54 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=31.707..1257.194 rows=694779 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=27.621..945.846 rows=694779 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.567..29.112 rows=147 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.553..28.137 rows=119 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.524..27.021 rows=119 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.595 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.411..25.411 rows=117 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.927..25.343 rows=117 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.547 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.879..23.879 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.762..23.823 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.494 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.603..22.603 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.348..22.596 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=119)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=119)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.234..4.903 rows=4726 loops=147)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 942
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.881..0.881 rows=5668 loops=147)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.070..4.070 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.527 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.092..0.092 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.048..0.087 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.034..0.059 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.016..0.016 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.016 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.022 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.527..1.527 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.146..1.165 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.200 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.132..0.132 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.084 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=54)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=54)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=54)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 1359.124 ms
(73 rows)

-- Test Case 24 - 2716283 ^ 464 ^ 3129 -> 2 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.380..30.415 rows=2 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.379..30.413 rows=2 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 100
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.308..30.308 rows=2 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 344
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=27.236..30.178 rows=2 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 30
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=27.225..30.156 rows=2 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=27.217..30.143 rows=2 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.025..0.065 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.023 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=27.186..30.070 rows=2 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=27.175..30.055 rows=2 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=27.164..30.040 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=27.152..30.023 rows=2 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=27.140..30.005 rows=2 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.100..2.775 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.375..26.375 rows=24 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.187..26.354 rows=24 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.161..26.225 rows=20 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.474 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.998..24.998 rows=20 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.485..24.989 rows=20 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.538 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.586..23.586 rows=20 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.569..23.571 rows=20 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.505 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.409..22.409 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.513..22.402 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=20)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=2)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.005..0.005 rows=1 loops=2)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.005..0.005 rows=1 loops=2)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.005..0.005 rows=1 loops=2)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=2)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.002 rows=16 loops=2)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.028 rows=173 loops=2)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.007 rows=51 loops=2)
 Total runtime: 30.718 ms
(66 rows)

-- Test Case 25 - 2716283 ^ 464 ^ 17098775 -> 4 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=31.623..33.407 rows=4 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=31.622..33.404 rows=4 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=31.554..33.306 rows=4 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=31.546..33.289 rows=4 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=31.536..33.266 rows=4 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=29.863..31.589 rows=4 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.549..31.424 rows=6 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.398..27.266 rows=6 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.352..26.557 rows=24 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.338..26.461 rows=20 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.310..26.362 rows=20 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.509 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.138..25.138 rows=20 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.627..25.127 rows=20 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.496 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.724..23.724 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.685..23.707 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.516 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.506..22.506 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.519..22.500 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=20)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=20)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.028..0.028 rows=0 loops=24)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 19
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.010..0.010 rows=19 loops=24)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.132..4.132 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.522 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.144..0.144 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.061..0.121 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.045..0.070 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.020 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.012..0.034 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.640..1.640 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.165..1.201 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.215 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.141..0.141 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.080 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.003 rows=1 loops=4)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=4)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 33.846 ms
(73 rows)

-- Test Case 26 - 2716283 ^ 3913743 ^ 3129 -> 52 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.839..43.455 rows=52 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.837..43.440 rows=52 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2600
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.767..42.255 rows=52 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 8944
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=27.694..39.479 rows=52 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 780
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=27.683..39.128 rows=52 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=27.674..38.921 rows=52 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 554
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.024..0.063 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.022 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=27.644..38.719 rows=606 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=27.632..36.778 rows=606 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=27.620..34.836 rows=606 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=27.569..32.572 rows=606 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=27.557..30.706 rows=606 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.035..1.787 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=27.496..27.496 rows=215 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 30kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.330..27.352 rows=215 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.303..26.645 rows=168 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.508 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.282..25.282 rows=167 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.797..25.226 rows=167 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.558 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.710..23.710 rows=174 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.435..23.606 rows=174 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.508 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.408..22.408 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.526..22.399 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=168)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=606)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=606)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=606)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=606)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=52)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=52)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=52)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=52)
 Total runtime: 43.776 ms
(67 rows)

\q
