
set role to aatams;
set role to aatams;
SET
-- Low selectivity filtering (large number of rows returned for each filter)
-- Test Case 1 - 2716283 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
limit 100;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=75.04..476.71 rows=100 width=279) (actual time=7.919..11.590 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=75.04..983740.11 rows=244897 width=279) (actual time=7.917..11.568 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=74.75..542040.70 rows=244897 width=239) (actual time=1.661..4.311 rows=100 loops=1)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.539..2.223 rows=98 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.311..1.938 rows=98 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.240..1.810 rows=98 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.194..0.684 rows=98 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.167..0.199 rows=2 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 16
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.138..0.152 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.124..0.132 rows=2 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.107..0.107 rows=1 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 158
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.035..0.035 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.014..0.014 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.006 rows=27 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.006..0.033 rows=159 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.014..0.019 rows=2 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.009..0.009 rows=1 loops=2)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.012..0.017 rows=9 loops=2)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.008 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.025..0.201 rows=49 loops=2)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=1.021..1.021 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.548 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.037..0.037 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.003..0.018 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.181..0.181 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.112 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=98)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=98)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.011..0.013 rows=1 loops=98)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.008..0.009 rows=1 loops=98)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=98)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=92)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=92)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.003..0.003 rows=1 loops=92)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=92)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 12.176 ms
(61 rows)

-- Test Case 2 - 3913743 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
limit 100;
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2.39..789.19 rows=100 width=279) (actual time=48.031..61.266 rows=100 loops=1)
   ->  Nested Loop  (cost=2.39..599078.28 rows=76141 width=279) (actual time=48.029..61.241 rows=100 loops=1)
         ->  Nested Loop  (cost=2.25..557707.97 rows=228803 width=260) (actual time=47.953..60.317 rows=100 loops=1)
               ->  Nested Loop  (cost=2.12..519575.57 rows=228803 width=263) (actual time=47.946..60.062 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.83..425154.26 rows=228803 width=248) (actual time=47.937..59.702 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.69..360725.41 rows=228803 width=217) (actual time=47.929..59.442 rows=100 loops=1)
                                 ->  Nested Loop  (cost=1.55..319392.92 rows=228803 width=201) (actual time=47.920..59.166 rows=100 loops=1)
                                       ->  Nested Loop  (cost=1.27..243426.12 rows=228803 width=152) (actual time=47.904..58.813 rows=100 loops=1)
                                             ->  Nested Loop  (cost=1.12..197233.18 rows=232476 width=146) (actual time=47.894..58.548 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=0.85..125746.25 rows=232476 width=146) (actual time=47.883..58.212 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=0.56..53094.76 rows=232476 width=138) (actual time=47.863..57.753 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.00..19589.97 rows=22 width=86) (actual time=31.198..57.472 rows=5 loops=1)
                                                                     Join Filter: (tag.id = sensor.tag_id)
                                                                     Rows Removed by Join Filter: 21349
                                                                     ->  Nested Loop  (cost=0.00..17870.54 rows=20 width=88) (actual time=31.094..49.911 rows=5 loops=1)
                                                                           Join Filter: (surgery.tag_id = tag.id)
                                                                           Rows Removed by Join Filter: 29433
                                                                           ->  Nested Loop  (cost=0.00..15499.10 rows=20 width=80) (actual time=30.733..40.023 rows=5 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 15791
                                                                                 ->  Nested Loop  (cost=0.00..14216.16 rows=20 width=72) (actual time=30.646..34.518 rows=5 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 20912
                                                                                       ->  Nested Loop  (cost=0.00..12878.16 rows=20 width=56) (actual time=26.726..26.795 rows=6 loops=1)
                                                                                             Join Filter: (animal.species_id = species.id)
                                                                                             Rows Removed by Join Filter: 83
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.011..0.025 rows=89 loops=1)
                                                                                             ->  Materialize  (cost=0.00..1765.25 rows=183 width=56) (actual time=0.262..0.300 rows=1 loops=89)
                                                                                                   ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=23.269..26.669 rows=1 loops=1)
                                                                                                         Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                         Rows Removed by Filter: 36586
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.003..0.760 rows=3486 loops=6)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.006..1.825 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.001..0.648 rows=3159 loops=5)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.005..1.062 rows=3923 loops=1)
                                                                           ->  Materialize  (cost=0.00..221.40 rows=7227 width=8) (actual time=0.002..1.155 rows=5888 loops=5)
                                                                                 ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.003..1.769 rows=7227 loops=1)
                                                                     ->  Materialize  (cost=0.00..140.60 rows=5307 width=22) (actual time=0.002..0.898 rows=4271 loops=5)
                                                                           ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.008..1.465 rows=5307 loops=1)
                                                               ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.027..0.041 rows=20 loops=5)
                                                                     Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 62.326 ms
(60 rows)

-- Test Case 3 - 17098775 rows limited to first 100
explain analyze select * from detection_extract_test_view
where timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3.39..571.82 rows=100 width=279) (actual time=0.913..8.429 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=3.39..31977844.24 rows=5625584 width=279) (actual time=0.912..8.387 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=3.10..21831467.95 rows=5625584 width=239) (actual time=0.854..7.315 rows=100 loops=1)
               ->  Nested Loop  (cost=1.69..12376246.08 rows=5287633 width=193) (actual time=0.795..5.361 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.55..11308727.81 rows=5372518 width=187) (actual time=0.791..5.092 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.41..8537379.53 rows=16144362 width=168) (actual time=0.787..4.824 rows=100 loops=1)
                                 ->  Merge Join  (cost=1.13..3572860.21 rows=16144362 width=168) (actual time=0.775..4.387 rows=100 loops=1)
                                       Merge Cond: (receiver_deployment.id = valid_detection.receiver_deployment_id)
                                       ->  Nested Loop  (cost=0.56..188303.48 rows=5710 width=132) (actual time=0.738..1.881 rows=2 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 16
                                             ->  Nested Loop  (cost=0.56..186931.88 rows=5710 width=135) (actual time=0.733..1.863 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=0.28..184575.50 rows=5710 width=120) (actual time=0.727..1.848 rows=2 loops=1)
                                                         Join Filter: (installation.project_id = receiver_project.id)
                                                         Rows Removed by Join Filter: 86
                                                         ->  Nested Loop  (cost=0.28..178149.81 rows=5710 width=89) (actual time=0.715..1.795 rows=2 loops=1)
                                                               Join Filter: (installation_station.installation_id = installation.id)
                                                               Rows Removed by Join Filter: 112
                                                               ->  Nested Loop  (cost=0.28..168724.94 rows=5710 width=73) (actual time=0.707..1.721 rows=2 loops=1)
                                                                     Join Filter: (receiver_deployment.station_id = installation_station.id)
                                                                     Rows Removed by Join Filter: 2873
                                                                     ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..457.79 rows=5710 width=24) (actual time=0.009..0.010 rows=2 loops=1)
                                                                     ->  Materialize  (cost=0.00..55.46 rows=1964 width=57) (actual time=0.005..0.671 rows=1438 loops=2)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.005..0.577 rows=1964 loops=1)
                                                               ->  Materialize  (cost=0.00..3.65 rows=110 width=32) (actual time=0.002..0.027 rows=57 loops=2)
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.024 rows=110 loops=1)
                                                         ->  Materialize  (cost=0.00..2.12 rows=75 width=39) (actual time=0.002..0.021 rows=44 loops=2)
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.017 rows=75 loops=1)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.005..0.005 rows=1 loops=2)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.007 rows=9 loops=2)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.006 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..3183595.42 rows=16144362 width=52) (actual time=0.032..2.439 rows=100 loops=1)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 2460
                                 ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=100)
                                       Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = receiver.organisation_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.016..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.013..0.015 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.009..0.011 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.006..0.007 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=99)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=99)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=99)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=99)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 8.826 ms
(59 rows)

-- Test Case 4 -  2716283 ^ 3913743 -> 1420919 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=3818.233..3820.320 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=3818.232..3820.297 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=3818.159..3819.367 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=3818.151..3819.101 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=3818.139..3818.650 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=3817.970..3818.422 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=3817.119..3817.496 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.637..3482.419 rows=2300454 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.908..2447.431 rows=2300454 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.851..29.199 rows=159 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.834..28.267 rows=114 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.807..27.243 rows=114 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.799..25.012 rows=113 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.451 rows=2504 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.703..23.703 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.307..23.620 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.562 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.262..22.262 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.397..22.252 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.985..1.985 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.922 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=114)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.006 rows=1 loops=114)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.019..8.647 rows=14468 loops=159)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.708..4.708 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.885 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.146..0.146 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.064..0.129 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.051..0.075 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.017 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.037 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.832..0.832 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.404 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.149..0.149 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.091 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 3820.805 ms
(69 rows)

-- Test Case 5 - 2716283 ^ 17098775 -> 902906 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=387.12..886.77 rows=100 width=279) (actual time=2.474..5.752 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=387.12..375160.94 rows=75008 width=279) (actual time=2.472..5.719 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=386.83..239875.54 rows=75008 width=239) (actual time=2.409..4.681 rows=100 loops=1)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=2.363..2.694 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=2.213..2.485 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=2.170..2.384 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=1.362..1.496 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.064..0.100 rows=4 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.060..0.087 rows=4 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.043..0.050 rows=4 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.035..0.035 rows=1 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.022..0.022 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.008 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.006 rows=27 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.010 rows=1 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.008..0.013 rows=4 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.007..0.008 rows=1 loops=4)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=4)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=0.314..0.335 rows=25 loops=4)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 118
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=0.102..0.102 rows=802 loops=4)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.795..0.795 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.441 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.017 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.136..0.136 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.082 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.016..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.013..0.015 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.010..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 6.046 ms
(62 rows)

-- Test Case 6 - 3913743 ^ 17098775 -> 2233756 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=354.52..1250.94 rows=100 width=279) (actual time=13.508..86.571 rows=100 loops=1)
   ->  Nested Loop  (cost=354.52..209410.30 rows=23321 width=279) (actual time=13.507..86.540 rows=100 loops=1)
         ->  Nested Loop  (cost=354.38..196739.36 rows=70078 width=260) (actual time=13.445..85.588 rows=100 loops=1)
               ->  Nested Loop  (cost=354.24..185060.13 rows=70078 width=263) (actual time=13.440..85.333 rows=100 loops=1)
                     ->  Nested Loop  (cost=353.96..156140.68 rows=70078 width=248) (actual time=13.430..84.954 rows=100 loops=1)
                           ->  Nested Loop  (cost=353.82..136407.35 rows=70078 width=217) (actual time=13.425..84.683 rows=100 loops=1)
                                 ->  Nested Loop  (cost=353.67..123747.99 rows=70078 width=201) (actual time=13.419..84.404 rows=100 loops=1)
                                       ->  Nested Loop  (cost=353.40..100480.81 rows=70078 width=152) (actual time=13.407..84.063 rows=100 loops=1)
                                             ->  Nested Loop  (cost=353.25..86332.79 rows=71203 width=146) (actual time=13.399..83.777 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=352.97..64437.30 rows=71203 width=146) (actual time=13.386..83.425 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=352.69..42183.63 rows=71203 width=138) (actual time=13.370..82.942 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.85..9870.73 rows=22 width=86) (actual time=3.926..72.334 rows=37 loops=1)
                                                                     ->  Nested Loop  (cost=0.57..9863.45 rows=20 width=88) (actual time=3.917..72.170 rows=37 loops=1)
                                                                           ->  Nested Loop  (cost=0.29..9856.58 rows=20 width=80) (actual time=3.904..72.026 rows=37 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 137502
                                                                                 ->  Nested Loop  (cost=0.29..8573.65 rows=20 width=72) (actual time=3.833..37.501 rows=36 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 141989
                                                                                       ->  Nested Loop  (cost=0.29..7235.65 rows=20 width=56) (actual time=0.052..0.917 rows=37 loops=1)
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.006..0.043 rows=211 loops=1)
                                                                                             ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.004 rows=0 loops=211)
                                                                                                   Index Cond: (id = animal.species_id)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 1
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.000..0.399 rows=3839 loops=37)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.476 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.000..0.373 rows=3821 loops=36)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.858 rows=3923 loops=1)
                                                                           ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=37)
                                                                                 Index Cond: (id = surgery.tag_id)
                                                                                 Heap Fetches: 0
                                                                     ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=37)
                                                                           Index Cond: (tag_id = tag.id)
                                                               ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.273..0.284 rows=3 loops=37)
                                                                     Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                     Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     Rows Removed by Filter: 735
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.106..0.106 rows=742 loops=37)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 87.251 ms
(59 rows)

-- Test Case 7 - 2716283 ^ 3913743 ^ 17098775 -> 690003 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=484.324..486.193 rows=100 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=484.322..486.168 rows=100 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=484.250..485.252 rows=100 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=484.242..484.998 rows=100 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=484.222..484.537 rows=100 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=482.560..482.809 rows=100 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=35.080..455.702 rows=183150 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=30.889..368.961 rows=183150 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.415..26.390 rows=73 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.401..26.001 rows=57 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.373..25.613 rows=57 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.077 rows=408 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.337..25.337 rows=167 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.827..25.260 rows=167 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.543 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.733..23.733 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.455..23.636 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.506 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.409..22.409 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.504..22.400 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.005 rows=1 loops=57)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=57)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.092..3.906 rows=2509 loops=73)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 1582
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.844..0.844 rows=5034 loops=73)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.162..4.162 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.547 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.152..0.152 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.068..0.137 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.053..0.077 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.012 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.025..0.025 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.038 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.638..1.638 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.167..1.202 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.207 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.143..0.143 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.089 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 486.632 ms
(73 rows)

 
-- High selectivity filtering (small number of rows returned for each filter)
-- Test Case 8 - 5909 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
limit 100;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=75.04..476.71 rows=100 width=279) (actual time=1.567..4.958 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=75.04..983740.11 rows=244897 width=279) (actual time=1.564..4.931 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=74.75..542040.70 rows=244897 width=239) (actual time=1.507..3.831 rows=100 loops=1)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.446..1.806 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.298..1.591 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.254..1.508 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.395..0.567 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.321..0.377 rows=3 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 31
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.314..0.333 rows=3 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.306..0.313 rows=3 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.282..0.282 rows=1 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 872
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.021..0.021 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 27
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.007 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 7
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.004 rows=28 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.113 rows=873 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.022..0.026 rows=3 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.005..0.005 rows=1 loops=3)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.011 rows=11 loops=3)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.018..0.047 rows=33 loops=3)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.839..0.839 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.426 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.020 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.135..0.135 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.085 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.017..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.013..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.010..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 5.255 ms
(61 rows)

-- Test Case 9 - 2153 rows
set geqo_threshold to 12;
SET
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
limit 100;
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2.39..789.19 rows=100 width=279) (actual time=46.197..49.726 rows=100 loops=1)
   ->  Nested Loop  (cost=2.39..599078.28 rows=76141 width=279) (actual time=46.195..49.693 rows=100 loops=1)
         ->  Nested Loop  (cost=2.25..557707.97 rows=228803 width=260) (actual time=46.118..48.774 rows=100 loops=1)
               ->  Nested Loop  (cost=2.12..519575.57 rows=228803 width=263) (actual time=46.111..48.523 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.83..425154.26 rows=228803 width=248) (actual time=46.100..48.151 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.69..360725.41 rows=228803 width=217) (actual time=46.092..47.889 rows=100 loops=1)
                                 ->  Nested Loop  (cost=1.55..319392.92 rows=228803 width=201) (actual time=46.084..47.625 rows=100 loops=1)
                                       ->  Nested Loop  (cost=1.27..243426.12 rows=228803 width=152) (actual time=46.070..47.285 rows=100 loops=1)
                                             ->  Nested Loop  (cost=1.12..197233.18 rows=232476 width=146) (actual time=46.061..47.019 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=0.85..125746.25 rows=232476 width=146) (actual time=46.050..46.664 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=0.56..53094.76 rows=232476 width=138) (actual time=46.034..46.217 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.00..19589.97 rows=22 width=86) (actual time=23.012..45.918 rows=4 loops=1)
                                                                     Join Filter: (tag.id = sensor.tag_id)
                                                                     Rows Removed by Join Filter: 15976
                                                                     ->  Nested Loop  (cost=0.00..17870.54 rows=20 width=88) (actual time=22.961..39.797 rows=4 loops=1)
                                                                           Join Filter: (surgery.tag_id = tag.id)
                                                                           Rows Removed by Join Filter: 22661
                                                                           ->  Nested Loop  (cost=0.00..15499.10 rows=20 width=80) (actual time=22.783..31.984 rows=4 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 11824
                                                                                 ->  Nested Loop  (cost=0.00..14216.16 rows=20 width=72) (actual time=22.743..27.618 rows=4 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 11799
                                                                                       ->  Nested Loop  (cost=0.00..12878.16 rows=20 width=56) (actual time=22.452..22.482 rows=4 loops=1)
                                                                                             Join Filter: (animal.species_id = species.id)
                                                                                             Rows Removed by Join Filter: 53
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.014 rows=57 loops=1)
                                                                                             ->  Materialize  (cost=0.00..1765.25 rows=183 width=56) (actual time=0.342..0.393 rows=1 loops=57)
                                                                                                   ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.501..22.383 rows=1 loops=1)
                                                                                                         Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                         Rows Removed by Filter: 36586
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.003..0.841 rows=2951 loops=4)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.441 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.002..0.672 rows=2957 loops=4)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.905 rows=3923 loops=1)
                                                                           ->  Materialize  (cost=0.00..221.40 rows=7227 width=8) (actual time=0.002..1.182 rows=5666 loops=4)
                                                                                 ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.478 rows=7227 loops=1)
                                                                     ->  Materialize  (cost=0.00..140.60 rows=5307 width=22) (actual time=0.003..0.966 rows=3995 loops=4)
                                                                           ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.004..1.283 rows=5307 loops=1)
                                                               ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.025..0.058 rows=25 loops=4)
                                                                     Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 50.585 ms
(60 rows)

-- Test Case 10 - 1065 rows
explain analyze select * from detection_extract_test_view
  where timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=398.97..1704.98 rows=100 width=279) (actual time=7.017..11.901 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=398.97..6772.29 rows=488 width=279) (actual time=7.016..11.871 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=398.68..5892.13 rows=488 width=239) (actual time=6.951..10.789 rows=100 loops=1)
               ->  Nested Loop  (cost=397.27..4950.72 rows=459 width=193) (actual time=6.882..8.713 rows=100 loops=1)
                     ->  Nested Loop  (cost=397.13..4858.12 rows=466 width=187) (actual time=6.875..8.421 rows=100 loops=1)
                           ->  Nested Loop  (cost=396.99..4617.80 rows=1400 width=168) (actual time=6.868..8.118 rows=100 loops=1)
                                 ->  Nested Loop  (cost=396.85..4384.47 rows=1400 width=171) (actual time=6.862..7.854 rows=100 loops=1)
                                       ->  Hash Join  (cost=396.57..3806.73 rows=1400 width=156) (actual time=6.845..7.371 rows=100 loops=1)
                                             Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                             ->  Hash Join  (cost=337.39..3728.30 rows=1400 width=156) (actual time=5.988..6.440 rows=100 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Hash Join  (cost=334.70..3706.36 rows=1400 width=125) (actual time=5.917..6.314 rows=100 loops=1)
                                                         Hash Cond: (installation_station.installation_id = installation.id)
                                                         ->  Hash Join  (cost=330.23..3682.64 rows=1400 width=109) (actual time=5.834..6.177 rows=100 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Hash Join  (cost=260.04..3591.45 rows=1400 width=60) (actual time=4.542..4.799 rows=100 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.036..0.175 rows=100 loops=1)
                                                                           Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                     ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.476..4.476 rows=5710 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                                           ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.668 rows=5710 loops=1)
                                                               ->  Hash  (cost=45.64..45.64 rows=1964 width=57) (actual time=1.273..1.273 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 179kB
                                                                     ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.492 rows=1964 loops=1)
                                                         ->  Hash  (cost=3.10..3.10 rows=110 width=32) (actual time=0.066..0.066 rows=110 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 8kB
                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.031 rows=110 loops=1)
                                                   ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.047..0.047 rows=75 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.015 rows=75 loops=1)
                                             ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.833..0.833 rows=1519 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.006..0.422 rows=1519 loops=1)
                                       ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.receiver_id)
                                 ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = receiver.model_id)
                           ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=100)
                                 Index Cond: (id = receiver.organisation_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
               ->  Nested Loop Left Join  (cost=1.41..2.04 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.68 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..1.24 rows=1 width=22) (actual time=0.010..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.90 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.56 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 12.271 ms
(60 rows)

-- Test Case 11 - 5909 ^ 2153 -> 609 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=35.062..37.102 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=35.061..37.074 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=34.991..36.155 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=34.984..35.898 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=34.974..35.436 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=34.804..35.198 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=33.935..34.270 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.078..33.843 rows=1590 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.702..28.685 rows=1590 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.632..26.744 rows=14 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.618..26.680 rows=14 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.587..26.594 rows=14 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.587..24.577 rows=14 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.381 rows=2773 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.563..23.563 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.420..23.541 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.445 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.367..22.367 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.483..22.359 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.976..1.976 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.909 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.005 rows=1 loops=14)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=14)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.012..0.090 rows=114 loops=14)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.347..4.347 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.593 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.109..0.109 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.065..0.100 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.051..0.075 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.019 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.850..0.850 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.440 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.149..0.149 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.091 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 37.591 ms
(69 rows)

-- Test Case 12 - 5909 ^ 1065 -> 55 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.586..3.996 rows=55 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.585..3.983 rows=55 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3373.72 rows=6 width=239) (actual time=0.524..3.350 rows=55 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3371.58 rows=6 width=239) (actual time=0.518..3.148 rows=55 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3368.94 rows=6 width=215) (actual time=0.512..2.957 rows=55 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3366.85 rows=6 width=215) (actual time=0.506..2.764 rows=55 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3364.85 rows=6 width=215) (actual time=0.495..2.584 rows=55 loops=1)
                                       ->  Nested Loop  (cost=27.78..3361.41 rows=6 width=193) (actual time=0.483..2.307 rows=55 loops=1)
                                             ->  Nested Loop  (cost=27.63..3360.22 rows=6 width=187) (actual time=0.478..2.158 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3356.96 rows=19 width=168) (actual time=0.475..2.002 rows=55 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3349.38 rows=19 width=168) (actual time=0.468..1.810 rows=55 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 825
                                                               ->  Nested Loop  (cost=27.21..3343.62 rows=19 width=171) (actual time=0.458..1.534 rows=55 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3335.78 rows=19 width=156) (actual time=0.449..1.282 rows=55 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.025..0.727 rows=1065 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.293..0.293 rows=64 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.088..0.245 rows=64 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.081..0.122 rows=15 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.072..0.098 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.005..0.019 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.024..0.024 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.008..0.014 rows=15 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.006 rows=4 loops=15)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=55)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=55)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.56 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=55)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=55)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=55)
               Index Cond: (animal.species_id = id)
 Total runtime: 4.303 ms
(58 rows)

-- Test Case 13 -  2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.69..5500.06 rows=2 width=279) (actual time=33.071..34.160 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.69..5500.06 rows=2 width=279) (actual time=33.069..34.151 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.004..0.009 rows=51 loops=1)
         ->  Materialize  (cost=2141.69..5493.92 rows=6 width=260) (actual time=0.619..0.640 rows=55 loops=51)
               ->  Nested Loop  (cost=2141.69..5493.89 rows=6 width=260) (actual time=31.544..32.326 rows=55 loops=1)
                     ->  Nested Loop  (cost=2141.55..5492.70 rows=6 width=254) (actual time=31.535..32.178 rows=55 loops=1)
                           ->  Nested Loop  (cost=2141.27..5490.31 rows=6 width=254) (actual time=31.524..31.989 rows=55 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 825
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
                                 ->  Materialize  (cost=2141.27..5487.72 rows=6 width=257) (actual time=1.770..1.974 rows=55 loops=16)
                                       ->  Nested Loop  (cost=2141.27..5487.69 rows=6 width=257) (actual time=28.305..31.418 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.99..5485.22 rows=6 width=242) (actual time=28.296..31.237 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.84..5483.53 rows=6 width=211) (actual time=28.288..31.079 rows=55 loops=1)
                                                         Join Filter: (installation_station.installation_id = installation.id)
                                                         Rows Removed by Join Filter: 5995
                                                         ->  Index Scan using installation_project_id_index on installation  (cost=0.14..16.50 rows=110 width=32) (actual time=0.005..0.039 rows=110 loops=1)
                                                         ->  Materialize  (cost=2140.70..5457.14 rows=6 width=195) (actual time=0.243..0.260 rows=55 loops=110)
                                                               ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.692..28.061 rows=55 loops=1)
                                                                     ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.681..27.874 rows=55 loops=1)
                                                                           ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.668..27.672 rows=55 loops=1)
                                                                                 ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.639..27.479 rows=55 loops=1)
                                                                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                                       ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.022..0.612 rows=1065 loops=1)
                                                                                             Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                       ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.436..26.436 rows=27 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                                             ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.086..26.403 rows=27 loops=1)
                                                                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.062..26.278 rows=27 loops=1)
                                                                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.556 rows=3923 loops=1)
                                                                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.023..25.023 rows=27 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.609..25.005 rows=27 loops=1)
                                                                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.539 rows=3920 loops=1)
                                                                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.582..23.582 rows=35 loops=1)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.430..23.567 rows=35 loops=1)
                                                                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.479 rows=4023 loops=1)
                                                                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.379..22.379 rows=1 loops=1)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.494..22.372 rows=1 loops=1)
                                                                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                                             Rows Removed by Filter: 36586
                                                                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=27)
                                                                                                         Index Cond: (tag_id = surgery.tag_id)
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                                                                       Index Cond: (id = sensor.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                                                 Index Cond: (id = valid_detection.receiver_deployment_id)
                                                                     ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.station_id)
                                                   ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.002 rows=1 loops=55)
                                                         Index Cond: (id = installation.project_id)
                                             ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=55)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 34.711 ms
(66 rows)

-- Test Case 14 -  5909 ^ 2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.868..33.089 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.866..33.070 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Nested Loop  (cost=2141.26..5476.66 rows=1 width=260) (actual time=26.793..31.831 rows=55 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 9460
               ->  Nested Loop  (cost=2141.26..5465.77 rows=1 width=254) (actual time=26.718..28.985 rows=55 loops=1)
                     ->  Nested Loop  (cost=2140.98..5465.37 rows=1 width=254) (actual time=26.708..28.770 rows=55 loops=1)
                           Join Filter: (receiver.model_id = device_model.id)
                           Rows Removed by Join Filter: 825
                           ->  Nested Loop  (cost=2140.98..5464.01 rows=1 width=257) (actual time=26.692..28.414 rows=55 loops=1)
                                 ->  Nested Loop  (cost=2140.70..5463.60 rows=1 width=242) (actual time=26.681..28.212 rows=55 loops=1)
                                       Join Filter: (installation_station.installation_id = installation.id)
                                       ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.031..0.070 rows=1 loops=1)
                                             Join Filter: (installation.project_id = receiver_project.id)
                                             Rows Removed by Join Filter: 109
                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.014..0.026 rows=1 loops=1)
                                                   Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                   Rows Removed by Filter: 74
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                       ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.641..28.107 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.629..27.915 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.617..27.702 rows=55 loops=1)
                                                         ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.586..27.455 rows=55 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.028..0.645 rows=1065 loops=1)
                                                                     Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.402..26.402 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.102..26.373 rows=27 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.077..26.252 rows=27 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.496 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.030..25.030 rows=27 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.623..25.006 rows=27 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.524 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.597..23.597 rows=35 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.425..23.578 rows=35 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.516 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.384..22.384 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.502..22.362 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=27)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=55)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=55)
                                       Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=55)
                     ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                           Index Cond: (id = valid_detection.receiver_download_id)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=55)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=55)
 Total runtime: 33.536 ms
(66 rows)

-- Mixed selectivity filtering
-- Test Case 15 - 5909 ^ 833188 -> 184 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=41.277..1172.736 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=41.274..1172.700 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=41.203..1171.462 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=41.196..1171.149 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=41.184..1170.599 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=41.003..1170.342 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=40.141..1169.387 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.996..1067.293 rows=702071 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.699..752.292 rows=702071 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.644..27.968 rows=83 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.631..27.449 rows=68 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.602..26.790 rows=68 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.584..24.630 rows=67 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.387 rows=2240 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.535..23.535 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.427..23.478 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.448 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.268..22.268 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.046..22.260 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.995..1.995 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.926 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=68)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=68)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.021..5.129 rows=8459 loops=83)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.273..4.273 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.538 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.106..0.106 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.063..0.095 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.051..0.075 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.018 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.013 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.839..0.839 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.452 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.149..0.149 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.082 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 1173.216 ms
(69 rows)

-- Test Case 16 - 5909 ^ 17098775 -> 3889 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=387.12..886.77 rows=100 width=279) (actual time=1.636..5.005 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=387.12..375160.94 rows=75008 width=279) (actual time=1.635..4.976 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=386.83..239875.54 rows=75008 width=239) (actual time=1.581..3.904 rows=100 loops=1)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=1.525..1.869 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=1.375..1.651 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=1.330..1.555 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=0.448..0.594 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.052..0.078 rows=3 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.049..0.069 rows=3 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.043..0.048 rows=3 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.034..0.034 rows=1 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.023..0.023 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 27
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.008 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 7
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.005 rows=28 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.009..0.009 rows=1 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.007..0.011 rows=3 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.006..0.006 rows=1 loops=3)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=3)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=0.121..0.160 rows=33 loops=3)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 148
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=0.041..0.041 rows=210 loops=3)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.872..0.872 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.454 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.037..0.037 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.021 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.139..0.139 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.089 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.017..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.011..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 5.319 ms
(62 rows)

-- Test Case 17 - 2716283 ^ 464 -> 448 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=32.337..34.713 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=32.335..34.690 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=32.265..33.754 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=32.258..33.489 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=32.248..33.026 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=32.080..32.783 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=31.192..31.825 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=31.017..31.597 rows=104 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.669..27.150 rows=104 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.635..26.720 rows=8 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.610..26.667 rows=8 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.582..26.616 rows=8 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.557..24.583 rows=8 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.345 rows=2541 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.650..23.650 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.637..23.635 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.452 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.462..22.462 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.521..22.455 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=2.002..2.002 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.935 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=8)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.005 rows=1 loops=8)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.011..0.043 rows=13 loops=8)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.322..4.322 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.580 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.148..0.148 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.066..0.120 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.052..0.076 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.031 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.869..0.869 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.468 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.147..0.147 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.082 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 35.195 ms
(69 rows)

-- Test Case 18 - 2716283 ^ 2005 -> 4 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2013-06-08 00:00:00+00' and '2013-06-08 01:00:00+00'
limit 100;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.145..2.723 rows=4 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.144..2.721 rows=4 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3884.18 rows=7 width=239) (actual time=2.090..2.634 rows=4 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3881.69 rows=7 width=239) (actual time=2.082..2.617 rows=4 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3878.61 rows=7 width=215) (actual time=2.076..2.599 rows=4 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3876.17 rows=7 width=215) (actual time=2.069..2.581 rows=4 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3873.84 rows=7 width=215) (actual time=2.058..2.560 rows=4 loops=1)
                                       ->  Nested Loop  (cost=27.78..3870.07 rows=7 width=193) (actual time=2.044..2.532 rows=4 loops=1)
                                             ->  Nested Loop  (cost=27.63..3868.68 rows=7 width=187) (actual time=2.039..2.518 rows=4 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3864.90 rows=22 width=168) (actual time=2.036..2.505 rows=4 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3856.39 rows=22 width=168) (actual time=2.027..2.485 rows=4 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 60
                                                               ->  Nested Loop  (cost=27.21..3849.91 rows=22 width=171) (actual time=2.016..2.448 rows=4 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3840.83 rows=22 width=156) (actual time=2.009..2.427 rows=4 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3808.21 rows=1613 width=52) (actual time=0.049..1.285 rows=1839 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2013-06-08 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-06-08 01:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.771..0.771 rows=282 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.070..0.592 rows=282 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.063..0.130 rows=45 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.052..0.079 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.018 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.024..0.024 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.008..0.030 rows=45 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.007 rows=6 loops=45)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=4)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.38 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=4)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=4)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=4)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.53 rows=1 width=22) (actual time=0.005..0.005 rows=1 loops=4)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=4)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=4)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.003..0.004 rows=1 loops=4)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=4)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=4)
               Index Cond: (animal.species_id = id)
 Total runtime: 3.033 ms
(58 rows)

-- Test Case 19 - 464 ^ 17098775 -> 6 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=354.52..1250.94 rows=100 width=279) (actual time=10.250..57.078 rows=6 loops=1)
   ->  Nested Loop  (cost=354.52..209410.30 rows=23321 width=279) (actual time=10.249..57.075 rows=6 loops=1)
         ->  Nested Loop  (cost=354.38..196739.36 rows=70078 width=260) (actual time=10.196..56.976 rows=6 loops=1)
               ->  Nested Loop  (cost=354.24..185060.13 rows=70078 width=263) (actual time=10.189..56.954 rows=6 loops=1)
                     ->  Nested Loop  (cost=353.96..156140.68 rows=70078 width=248) (actual time=10.181..56.928 rows=6 loops=1)
                           ->  Nested Loop  (cost=353.82..136407.35 rows=70078 width=217) (actual time=10.176..56.908 rows=6 loops=1)
                                 ->  Nested Loop  (cost=353.67..123747.99 rows=70078 width=201) (actual time=10.170..56.886 rows=6 loops=1)
                                       ->  Nested Loop  (cost=353.40..100480.81 rows=70078 width=152) (actual time=10.161..56.860 rows=6 loops=1)
                                             ->  Nested Loop  (cost=353.25..86332.79 rows=71203 width=146) (actual time=10.154..56.836 rows=6 loops=1)
                                                   ->  Nested Loop  (cost=352.97..64437.30 rows=71203 width=146) (actual time=10.144..56.807 rows=6 loops=1)
                                                         ->  Nested Loop  (cost=352.69..42183.63 rows=71203 width=138) (actual time=10.130..56.760 rows=6 loops=1)
                                                               ->  Nested Loop  (cost=0.85..9870.73 rows=22 width=86) (actual time=5.412..55.795 rows=24 loops=1)
                                                                     ->  Nested Loop  (cost=0.57..9863.45 rows=20 width=88) (actual time=5.402..55.682 rows=20 loops=1)
                                                                           ->  Nested Loop  (cost=0.29..9856.58 rows=20 width=80) (actual time=5.385..55.577 rows=20 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 78440
                                                                                 ->  Nested Loop  (cost=0.29..8573.65 rows=20 width=72) (actual time=3.655..35.249 rows=20 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 78380
                                                                                       ->  Nested Loop  (cost=0.29..7235.65 rows=20 width=56) (actual time=1.539..13.607 rows=20 loops=1)
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.596 rows=4023 loops=1)
                                                                                             ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=0 loops=4023)
                                                                                                   Index Cond: (id = animal.species_id)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 1
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.001..0.457 rows=3920 loops=20)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.480 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.000..0.419 rows=3923 loops=20)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.883 rows=3923 loops=1)
                                                                           ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=20)
                                                                                 Index Cond: (id = surgery.tag_id)
                                                                                 Heap Fetches: 0
                                                                     ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=20)
                                                                           Index Cond: (tag_id = tag.id)
                                                               ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.039..0.039 rows=0 loops=24)
                                                                     Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                     Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     Rows Removed by Filter: 19
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.011..0.011 rows=19 loops=24)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.006..0.007 rows=1 loops=6)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=6)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.003 rows=1 loops=6)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.003..0.003 rows=1 loops=6)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=6)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.002 rows=1 loops=6)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=6)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=6)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=6)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 57.727 ms
(59 rows)

-- Test Case 20 - 833188 ^ 5489 -> 210 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 100;
                                                                                                                                             QUERY PLAN                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2473.59..12305.40 rows=7 width=279) (actual time=272.214..275.380 rows=100 loops=1)
   ->  Nested Loop  (cost=2473.59..12305.40 rows=7 width=279) (actual time=272.213..275.354 rows=100 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 9533
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.004..0.008 rows=46 loops=1)
         ->  Materialize  (cost=2473.59..12288.44 rows=20 width=260) (actual time=5.614..5.888 rows=209 loops=46)
               ->  Nested Loop  (cost=2473.59..12288.34 rows=20 width=260) (actual time=258.245..269.611 rows=210 loops=1)
                     ->  Nested Loop  (cost=2473.44..12284.37 rows=20 width=254) (actual time=258.235..269.019 rows=210 loops=1)
                           ->  Nested Loop  (cost=2473.16..12277.66 rows=20 width=254) (actual time=258.224..268.317 rows=210 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 3150
                                 ->  Nested Loop  (cost=2473.16..12271.66 rows=20 width=257) (actual time=258.203..267.315 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2472.88..12263.40 rows=20 width=242) (actual time=258.192..266.501 rows=210 loops=1)
                                             Join Filter: (installation_station.installation_id = installation.id)
                                             Rows Removed by Join Filter: 22890
                                             ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.073..0.174 rows=110 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.001..0.028 rows=110 loops=1)
                                                   ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.047..0.047 rows=75 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.016 rows=75 loops=1)
                                             ->  Materialize  (cost=2470.19..12223.15 rows=20 width=195) (actual time=0.803..2.342 rows=210 loops=110)
                                                   ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=88.333..255.183 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=88.321..254.478 rows=210 loops=1)
                                                               ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=88.309..253.655 rows=210 loops=1)
                                                                     ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.468..27.997 rows=147 loops=1)
                                                                           ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.454..27.381 rows=119 loops=1)
                                                                                 ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.426..26.846 rows=119 loops=1)
                                                                                       Hash Cond: (surgery.release_id = animal_release.id)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.553 rows=3923 loops=1)
                                                                                       ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.311..25.311 rows=117 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                             ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.819..25.247 rows=117 loops=1)
                                                                                                   Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                   ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.545 rows=3920 loops=1)
                                                                                                   ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.772..23.772 rows=125 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                                         ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.632..23.692 rows=125 loops=1)
                                                                                                               Hash Cond: (animal.species_id = species.id)
                                                                                                               ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.502 rows=4023 loops=1)
                                                                                                               ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.475..22.475 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.217..22.467 rows=1 loops=1)
                                                                                                                           Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                                           Rows Removed by Filter: 36586
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                       Index Cond: (id = surgery.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                 Index Cond: (tag_id = tag.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.532..1.533 rows=1 loops=147)
                                                                           Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                                           ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.530..1.530 rows=0 loops=147)
                                                                                 ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.634..0.634 rows=5041 loops=147)
                                                                                       Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                                 ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.876..0.876 rows=5668 loops=147)
                                                                                       Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=210)
                                                                     Index Cond: (id = valid_detection.receiver_deployment_id)
                                                         ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=210)
                                                               Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=210)
                                             Index Cond: (id = receiver_deployment.receiver_id)
                                 ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=210)
                                       ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.004..0.008 rows=16 loops=1)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=210)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=210)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 275.863 ms
(70 rows)

-- Test Case 21 - 5909 ^ 2153 ^ 17098775 -> 284 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=34.270..36.330 rows=100 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=34.269..36.299 rows=100 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=34.202..35.395 rows=100 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=34.194..35.134 rows=100 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=34.184..34.673 rows=100 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=32.530..32.947 rows=100 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.708..32.602 rows=1209 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.496..27.804 rows=1209 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.233..26.113 rows=17 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.219..26.029 rows=17 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.190..25.939 rows=17 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.328 rows=2490 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.146..25.146 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.714..25.133 rows=27 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.535 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.688..23.688 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.549..23.671 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.506 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.499..22.499 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.581..22.492 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=17)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=17)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.035..0.079 rows=71 loops=17)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 22
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.023..0.023 rows=99 loops=17)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.190..4.190 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.526 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.115..0.115 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.069..0.098 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.055..0.079 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.013 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.025..0.025 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.015 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.629..1.629 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.172..1.183 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.213 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.144..0.144 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.093 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 36.793 ms
(73 rows)

-- Test Case 22 - 5909 ^ 833188 ^ 5489 -> 13 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 100;
                                                                                                                                       QUERY PLAN                                                                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470.75..12251.27 rows=1 width=279) (actual time=87.374..255.772 rows=13 loops=1)
   ->  Nested Loop  (cost=2470.75..12251.27 rows=1 width=279) (actual time=87.372..255.764 rows=13 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 650
         ->  Nested Loop  (cost=2470.75..12249.09 rows=1 width=260) (actual time=87.302..255.429 rows=13 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 2236
               ->  Nested Loop  (cost=2470.75..12238.20 rows=1 width=254) (actual time=87.234..254.756 rows=13 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 195
                     ->  Nested Loop  (cost=2470.75..12236.84 rows=1 width=257) (actual time=87.224..254.666 rows=13 loops=1)
                           ->  Nested Loop  (cost=2470.47..12236.43 rows=1 width=242) (actual time=87.214..254.609 rows=13 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 197
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.032..0.071 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.015..0.026 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2470.47..12229.77 rows=20 width=195) (actual time=87.170..254.478 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=87.160..253.785 rows=210 loops=1)
                                             ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=87.149..253.082 rows=210 loops=1)
                                                   ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=87.136..252.269 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.342..27.787 rows=147 loops=1)
                                                               ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.328..27.182 rows=119 loops=1)
                                                                     ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.303..26.652 rows=119 loops=1)
                                                                           Hash Cond: (surgery.release_id = animal_release.id)
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.534 rows=3923 loops=1)
                                                                           ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.198..25.198 rows=117 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                 ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.734..25.147 rows=117 loops=1)
                                                                                       Hash Cond: (animal_release.animal_id = animal.id)
                                                                                       ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.518 rows=3920 loops=1)
                                                                                       ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.697..23.697 rows=125 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                             ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.541..23.647 rows=125 loops=1)
                                                                                                   Hash Cond: (animal.species_id = species.id)
                                                                                                   ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.519 rows=4023 loops=1)
                                                                                                   ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.366..22.366 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.144..22.358 rows=1 loops=1)
                                                                                                               Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                               Rows Removed by Filter: 36586
                                                                     ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=119)
                                                                           Index Cond: (id = surgery.tag_id)
                                                                           Heap Fetches: 0
                                                               ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                     Index Cond: (tag_id = tag.id)
                                                         ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.524..1.524 rows=1 loops=147)
                                                               Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                               ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.522..1.522 rows=0 loops=147)
                                                                     ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.624..0.624 rows=5041 loops=147)
                                                                           Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.880..0.880 rows=5668 loops=147)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=210)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=210)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=210)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=13)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=13)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=13)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=13)
 Total runtime: 256.093 ms
(69 rows)

-- Test Case 23 - 5909 ^ 833188 ^ 17098775 -> 54 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=34.030..1344.827 rows=54 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=34.028..1344.810 rows=54 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=33.960..1343.970 rows=54 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=33.952..1343.790 rows=54 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=33.939..1343.445 rows=54 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=32.396..1341.843 rows=54 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=31.394..1241.999 rows=694779 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=27.240..933.494 rows=694779 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.523..28.978 rows=147 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.509..28.009 rows=119 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.480..26.938 rows=119 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.587 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.363..25.363 rows=117 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.847..25.303 rows=117 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.561 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.799..23.799 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.698..23.743 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.522 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.541..22.541 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.269..22.533 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=119)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=119)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.196..4.816 rows=4726 loops=147)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 942
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.883..0.883 rows=5668 loops=147)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.138..4.138 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.597 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.089..0.089 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.046..0.081 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.032..0.056 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.017..0.017 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.016 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.009..0.018 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.525..1.525 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.147..1.166 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.200 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.133..0.133 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.089 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.005 rows=1 loops=54)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=54)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=54)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 1345.145 ms
(73 rows)

-- Test Case 24 - 2716283 ^ 464 ^ 3129 -> 2 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.117..29.510 rows=2 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.116..29.508 rows=2 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 100
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.043..29.400 rows=2 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 344
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=26.975..29.278 rows=2 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 30
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=26.962..29.253 rows=2 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=26.954..29.241 rows=2 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.024..0.064 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.023 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.019 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=26.924..29.171 rows=2 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=26.912..29.154 rows=2 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=26.902..29.139 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=26.890..29.123 rows=2 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=26.877..29.103 rows=2 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.052..1.856 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.435..26.435 rows=24 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.232..26.415 rows=24 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.206..26.297 rows=20 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.520 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.042..25.042 rows=20 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.533..25.034 rows=20 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.540 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.641..23.641 rows=20 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.610..23.624 rows=20 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.493 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.453..22.453 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.537..22.447 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=20)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=2)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.005..0.005 rows=1 loops=2)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.005..0.005 rows=1 loops=2)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.005..0.006 rows=1 loops=2)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=2)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=2)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.029 rows=173 loops=2)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.008 rows=51 loops=2)
 Total runtime: 29.816 ms
(66 rows)

-- Test Case 25 - 2716283 ^ 464 ^ 17098775 -> 4 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=31.708..33.470 rows=4 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=31.706..33.467 rows=4 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=31.637..33.368 rows=4 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=31.630..33.353 rows=4 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=31.620..33.326 rows=4 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=29.943..31.649 rows=4 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.617..31.469 rows=6 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.399..27.247 rows=6 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.349..26.557 rows=24 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.336..26.459 rows=20 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.307..26.358 rows=20 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.522 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.134..25.134 rows=20 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.583..25.103 rows=20 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.557 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.685..23.685 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.678..23.677 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.484 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.505..22.505 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.535..22.498 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=20)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=20)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.027..0.027 rows=0 loops=24)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 19
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.009..0.009 rows=19 loops=24)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.195..4.195 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.566 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.152..0.152 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.069..0.143 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.054..0.079 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.015 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.025..0.025 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.044 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.641..1.641 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.169..1.199 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.202 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.142..0.142 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.094 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=4)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=4)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 33.910 ms
(73 rows)

-- Test Case 26 - 2716283 ^ 3913743 ^ 3129 -> 52 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.895..43.447 rows=52 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.893..43.425 rows=52 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2600
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.821..42.201 rows=52 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 8944
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=27.751..39.564 rows=52 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 780
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=27.739..39.222 rows=52 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=27.730..39.011 rows=52 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 554
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.025..0.065 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.023 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.013 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=27.699..38.783 rows=606 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=27.688..36.866 rows=606 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=27.676..34.893 rows=606 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=27.650..32.683 rows=606 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=27.640..30.765 rows=606 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.034..1.832 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=27.579..27.579 rows=215 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 30kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.444..27.423 rows=215 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.419..26.741 rows=168 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.490 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.394..25.394 rows=167 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.883..25.326 rows=167 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.573 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.798..23.798 rows=174 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.523..23.723 rows=174 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.521 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.496..22.496 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.574..22.488 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=168)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=606)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=606)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=606)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=606)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=52)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=52)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=52)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=52)
 Total runtime: 43.762 ms
(67 rows)

\q
