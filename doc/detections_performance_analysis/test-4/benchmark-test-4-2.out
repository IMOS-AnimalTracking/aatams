
set role to aatams;
set role to aatams;
SET
-- Low selectivity filtering (large number of rows returned for each filter)
-- Test Case 1 - 2716283 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
limit 100;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=75.04..476.71 rows=100 width=279) (actual time=7.797..11.434 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=75.04..983740.11 rows=244897 width=279) (actual time=7.795..11.408 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=74.75..542040.70 rows=244897 width=239) (actual time=1.532..4.154 rows=100 loops=1)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.425..2.106 rows=98 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.208..1.813 rows=98 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.152..1.703 rows=98 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.191..0.658 rows=98 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.166..0.197 rows=2 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 16
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.138..0.154 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.124..0.132 rows=2 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.109..0.109 rows=1 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 158
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.039..0.039 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.014..0.014 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.005 rows=27 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.007..0.034 rows=159 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.013..0.019 rows=2 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.008..0.009 rows=1 loops=2)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.011..0.017 rows=9 loops=2)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.007 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.024..0.200 rows=49 loops=2)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.940..0.940 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.503 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.037..0.037 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.003..0.019 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.170..0.170 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.104 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=98)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=98)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.011..0.012 rows=1 loops=98)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.008..0.009 rows=1 loops=98)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=98)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=92)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=92)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=92)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=92)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 11.999 ms
(61 rows)

-- Test Case 2 - 3913743 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
limit 100;
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2.39..789.19 rows=100 width=279) (actual time=47.609..60.895 rows=100 loops=1)
   ->  Nested Loop  (cost=2.39..599078.28 rows=76141 width=279) (actual time=47.607..60.863 rows=100 loops=1)
         ->  Nested Loop  (cost=2.25..557707.97 rows=228803 width=260) (actual time=47.530..59.937 rows=100 loops=1)
               ->  Nested Loop  (cost=2.12..519575.57 rows=228803 width=263) (actual time=47.523..59.679 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.83..425154.26 rows=228803 width=248) (actual time=47.513..59.335 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.69..360725.41 rows=228803 width=217) (actual time=47.499..59.062 rows=100 loops=1)
                                 ->  Nested Loop  (cost=1.55..319392.92 rows=228803 width=201) (actual time=47.490..58.760 rows=100 loops=1)
                                       ->  Nested Loop  (cost=1.27..243426.12 rows=228803 width=152) (actual time=47.474..58.404 rows=100 loops=1)
                                             ->  Nested Loop  (cost=1.12..197233.18 rows=232476 width=146) (actual time=47.463..58.135 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=0.85..125746.25 rows=232476 width=146) (actual time=47.452..57.797 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=0.56..53094.76 rows=232476 width=138) (actual time=47.431..57.341 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.00..19589.97 rows=22 width=86) (actual time=30.863..57.063 rows=5 loops=1)
                                                                     Join Filter: (tag.id = sensor.tag_id)
                                                                     Rows Removed by Join Filter: 21349
                                                                     ->  Nested Loop  (cost=0.00..17870.54 rows=20 width=88) (actual time=30.760..49.507 rows=5 loops=1)
                                                                           Join Filter: (surgery.tag_id = tag.id)
                                                                           Rows Removed by Join Filter: 29433
                                                                           ->  Nested Loop  (cost=0.00..15499.10 rows=20 width=80) (actual time=30.411..39.710 rows=5 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 15791
                                                                                 ->  Nested Loop  (cost=0.00..14216.16 rows=20 width=72) (actual time=30.325..34.181 rows=5 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 20912
                                                                                       ->  Nested Loop  (cost=0.00..12878.16 rows=20 width=56) (actual time=26.460..26.528 rows=6 loops=1)
                                                                                             Join Filter: (animal.species_id = species.id)
                                                                                             Rows Removed by Join Filter: 83
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.011..0.024 rows=89 loops=1)
                                                                                             ->  Materialize  (cost=0.00..1765.25 rows=183 width=56) (actual time=0.259..0.297 rows=1 loops=89)
                                                                                                   ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=23.004..26.404 rows=1 loops=1)
                                                                                                         Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                         Rows Removed by Filter: 36586
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.002..0.765 rows=3486 loops=6)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.006..1.769 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.002..0.646 rows=3159 loops=5)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.005..1.049 rows=3923 loops=1)
                                                                           ->  Materialize  (cost=0.00..221.40 rows=7227 width=8) (actual time=0.002..1.154 rows=5888 loops=5)
                                                                                 ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.753 rows=7227 loops=1)
                                                                     ->  Materialize  (cost=0.00..140.60 rows=5307 width=22) (actual time=0.002..0.894 rows=4271 loops=5)
                                                                           ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.008..1.506 rows=5307 loops=1)
                                                               ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.027..0.041 rows=20 loops=5)
                                                                     Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 61.926 ms
(60 rows)

-- Test Case 3 - 17098775 rows limited to first 100
explain analyze select * from detection_extract_test_view
where timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                         QUERY PLAN                                                                                                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3.39..571.82 rows=100 width=279) (actual time=0.910..8.388 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=3.39..31977844.24 rows=5625584 width=279) (actual time=0.909..8.355 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=3.10..21831467.95 rows=5625584 width=239) (actual time=0.853..7.267 rows=100 loops=1)
               ->  Nested Loop  (cost=1.69..12376246.08 rows=5287633 width=193) (actual time=0.794..5.317 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.55..11308727.81 rows=5372518 width=187) (actual time=0.790..5.043 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.41..8537379.53 rows=16144362 width=168) (actual time=0.787..4.779 rows=100 loops=1)
                                 ->  Merge Join  (cost=1.13..3572860.21 rows=16144362 width=168) (actual time=0.775..4.345 rows=100 loops=1)
                                       Merge Cond: (receiver_deployment.id = valid_detection.receiver_deployment_id)
                                       ->  Nested Loop  (cost=0.56..188303.48 rows=5710 width=132) (actual time=0.738..1.881 rows=2 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 16
                                             ->  Nested Loop  (cost=0.56..186931.88 rows=5710 width=135) (actual time=0.733..1.864 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=0.28..184575.50 rows=5710 width=120) (actual time=0.726..1.847 rows=2 loops=1)
                                                         Join Filter: (installation.project_id = receiver_project.id)
                                                         Rows Removed by Join Filter: 86
                                                         ->  Nested Loop  (cost=0.28..178149.81 rows=5710 width=89) (actual time=0.715..1.795 rows=2 loops=1)
                                                               Join Filter: (installation_station.installation_id = installation.id)
                                                               Rows Removed by Join Filter: 112
                                                               ->  Nested Loop  (cost=0.28..168724.94 rows=5710 width=73) (actual time=0.707..1.720 rows=2 loops=1)
                                                                     Join Filter: (receiver_deployment.station_id = installation_station.id)
                                                                     Rows Removed by Join Filter: 2873
                                                                     ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..457.79 rows=5710 width=24) (actual time=0.009..0.011 rows=2 loops=1)
                                                                     ->  Materialize  (cost=0.00..55.46 rows=1964 width=57) (actual time=0.005..0.661 rows=1438 loops=2)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.005..0.564 rows=1964 loops=1)
                                                               ->  Materialize  (cost=0.00..3.65 rows=110 width=32) (actual time=0.002..0.028 rows=57 loops=2)
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.023 rows=110 loops=1)
                                                         ->  Materialize  (cost=0.00..2.12 rows=75 width=39) (actual time=0.001..0.018 rows=44 loops=2)
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.014 rows=75 loops=1)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.005..0.006 rows=1 loops=2)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.005 rows=9 loops=2)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..3183595.42 rows=16144362 width=52) (actual time=0.032..2.401 rows=100 loops=1)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 2460
                                 ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=100)
                                       Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = receiver.organisation_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.016..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.013..0.015 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.010..0.011 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.006..0.007 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=99)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=99)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=99)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=99)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 8.792 ms
(59 rows)

-- Test Case 4 -  2716283 ^ 3913743 -> 1420919 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=3805.192..3807.266 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=3805.189..3807.236 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=3805.118..3806.319 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=3805.110..3806.062 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=3805.099..3805.608 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=3804.926..3805.371 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=3804.081..3804.460 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.607..3469.193 rows=2300454 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.002..2435.127 rows=2300454 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.945..29.270 rows=159 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.929..28.355 rows=114 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.903..27.331 rows=114 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.881..25.092 rows=113 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.444 rows=2504 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.785..23.785 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.399..23.705 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.582 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.353..22.353 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.476..22.345 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.999..1.999 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.932 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=114)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=114)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.019..8.631 rows=14468 loops=159)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.585..4.585 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.957 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.148..0.148 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.066..0.135 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.052..0.077 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.018 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.012..0.035 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.828..0.828 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.424 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.151..0.151 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.092 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 3807.747 ms
(69 rows)

-- Test Case 5 - 2716283 ^ 17098775 -> 902906 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=387.12..886.77 rows=100 width=279) (actual time=2.427..5.718 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=387.12..375160.94 rows=75008 width=279) (actual time=2.426..5.687 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=386.83..239875.54 rows=75008 width=239) (actual time=2.361..4.643 rows=100 loops=1)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=2.317..2.650 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=2.168..2.435 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=2.123..2.337 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=1.357..1.492 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.060..0.096 rows=4 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.056..0.082 rows=4 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.041..0.048 rows=4 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.034..0.034 rows=1 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.021..0.021 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.007 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.004 rows=27 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.009..0.009 rows=1 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.006..0.012 rows=4 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.007..0.008 rows=1 loops=4)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=4)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=0.313..0.338 rows=25 loops=4)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 118
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=0.101..0.101 rows=802 loops=4)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.754..0.754 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.401 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.015 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.135..0.135 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.093 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.016..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.013..0.015 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.010..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 6.018 ms
(62 rows)

-- Test Case 6 - 3913743 ^ 17098775 -> 2233756 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=354.52..1250.94 rows=100 width=279) (actual time=13.474..86.569 rows=100 loops=1)
   ->  Nested Loop  (cost=354.52..209410.30 rows=23321 width=279) (actual time=13.473..86.539 rows=100 loops=1)
         ->  Nested Loop  (cost=354.38..196739.36 rows=70078 width=260) (actual time=13.414..85.596 rows=100 loops=1)
               ->  Nested Loop  (cost=354.24..185060.13 rows=70078 width=263) (actual time=13.409..85.336 rows=100 loops=1)
                     ->  Nested Loop  (cost=353.96..156140.68 rows=70078 width=248) (actual time=13.399..84.965 rows=100 loops=1)
                           ->  Nested Loop  (cost=353.82..136407.35 rows=70078 width=217) (actual time=13.394..84.684 rows=100 loops=1)
                                 ->  Nested Loop  (cost=353.67..123747.99 rows=70078 width=201) (actual time=13.387..84.411 rows=100 loops=1)
                                       ->  Nested Loop  (cost=353.40..100480.81 rows=70078 width=152) (actual time=13.377..84.065 rows=100 loops=1)
                                             ->  Nested Loop  (cost=353.25..86332.79 rows=71203 width=146) (actual time=13.369..83.779 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=352.97..64437.30 rows=71203 width=146) (actual time=13.357..83.425 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=352.69..42183.63 rows=71203 width=138) (actual time=13.341..82.935 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.85..9870.73 rows=22 width=86) (actual time=3.925..72.326 rows=37 loops=1)
                                                                     ->  Nested Loop  (cost=0.57..9863.45 rows=20 width=88) (actual time=3.916..72.164 rows=37 loops=1)
                                                                           ->  Nested Loop  (cost=0.29..9856.58 rows=20 width=80) (actual time=3.902..72.025 rows=37 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 137502
                                                                                 ->  Nested Loop  (cost=0.29..8573.65 rows=20 width=72) (actual time=3.832..37.491 rows=36 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 141989
                                                                                       ->  Nested Loop  (cost=0.29..7235.65 rows=20 width=56) (actual time=0.052..0.919 rows=37 loops=1)
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.006..0.055 rows=211 loops=1)
                                                                                             ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=0 loops=211)
                                                                                                   Index Cond: (id = animal.species_id)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 1
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.000..0.396 rows=3839 loops=37)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.482 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.000..0.373 rows=3821 loops=36)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.872 rows=3923 loops=1)
                                                                           ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=37)
                                                                                 Index Cond: (id = surgery.tag_id)
                                                                                 Heap Fetches: 0
                                                                     ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=37)
                                                                           Index Cond: (tag_id = tag.id)
                                                               ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.273..0.284 rows=3 loops=37)
                                                                     Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                     Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     Rows Removed by Filter: 735
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.105..0.105 rows=742 loops=37)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.004 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 87.238 ms
(59 rows)

-- Test Case 7 - 2716283 ^ 3913743 ^ 17098775 -> 690003 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=485.440..487.311 rows=100 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=485.437..487.283 rows=100 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=485.367..486.372 rows=100 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=485.359..486.117 rows=100 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=485.338..485.655 rows=100 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=483.660..483.907 rows=100 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=35.215..457.239 rows=183150 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=31.033..370.286 rows=183150 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.503..26.489 rows=73 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.489..26.094 rows=57 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.461..25.702 rows=57 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.093 rows=408 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.425..25.425 rows=167 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.929..25.350 rows=167 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.537 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.836..23.836 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.563..23.756 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.501 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.519..22.519 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.587..22.510 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.005 rows=1 loops=57)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=57)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.093..3.915 rows=2509 loops=73)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 1582
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.844..0.844 rows=5034 loops=73)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.151..4.151 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.557 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.152..0.152 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.069..0.132 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.053..0.077 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.015 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.025..0.025 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.012..0.035 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.651..1.651 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.170..1.205 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.005..0.223 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.142..0.142 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.079 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 487.748 ms
(73 rows)

 
-- High selectivity filtering (small number of rows returned for each filter)
-- Test Case 8 - 5909 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
limit 100;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=75.04..476.71 rows=100 width=279) (actual time=1.570..4.964 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=75.04..983740.11 rows=244897 width=279) (actual time=1.570..4.932 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=74.75..542040.70 rows=244897 width=239) (actual time=1.512..3.865 rows=100 loops=1)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.452..1.817 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.302..1.595 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.257..1.505 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.396..0.566 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.323..0.378 rows=3 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 31
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.315..0.333 rows=3 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.307..0.313 rows=3 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.282..0.282 rows=1 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 872
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.021..0.021 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 27
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.006 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 7
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.004 rows=28 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.001..0.108 rows=873 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.023..0.027 rows=3 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.006..0.006 rows=1 loops=3)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.011 rows=11 loops=3)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.018..0.044 rows=33 loops=3)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.841..0.841 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.447 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.035..0.035 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.017 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.135..0.135 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.095 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.017..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.010..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 5.245 ms
(61 rows)

-- Test Case 9 - 2153 rows
set geqo_threshold to 12;
SET
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
limit 100;
                                                                                                      QUERY PLAN                                                                                                      
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2.39..789.19 rows=100 width=279) (actual time=46.118..49.638 rows=100 loops=1)
   ->  Nested Loop  (cost=2.39..599078.28 rows=76141 width=279) (actual time=46.116..49.605 rows=100 loops=1)
         ->  Nested Loop  (cost=2.25..557707.97 rows=228803 width=260) (actual time=46.039..48.695 rows=100 loops=1)
               ->  Nested Loop  (cost=2.12..519575.57 rows=228803 width=263) (actual time=46.032..48.441 rows=100 loops=1)
                     ->  Nested Loop  (cost=1.83..425154.26 rows=228803 width=248) (actual time=46.020..48.080 rows=100 loops=1)
                           ->  Nested Loop  (cost=1.69..360725.41 rows=228803 width=217) (actual time=46.013..47.820 rows=100 loops=1)
                                 ->  Nested Loop  (cost=1.55..319392.92 rows=228803 width=201) (actual time=46.004..47.541 rows=100 loops=1)
                                       ->  Nested Loop  (cost=1.27..243426.12 rows=228803 width=152) (actual time=45.990..47.216 rows=100 loops=1)
                                             ->  Nested Loop  (cost=1.12..197233.18 rows=232476 width=146) (actual time=45.981..46.940 rows=100 loops=1)
                                                   ->  Nested Loop  (cost=0.85..125746.25 rows=232476 width=146) (actual time=45.970..46.596 rows=100 loops=1)
                                                         ->  Nested Loop  (cost=0.56..53094.76 rows=232476 width=138) (actual time=45.954..46.133 rows=100 loops=1)
                                                               ->  Nested Loop  (cost=0.00..19589.97 rows=22 width=86) (actual time=22.963..45.836 rows=4 loops=1)
                                                                     Join Filter: (tag.id = sensor.tag_id)
                                                                     Rows Removed by Join Filter: 15976
                                                                     ->  Nested Loop  (cost=0.00..17870.54 rows=20 width=88) (actual time=22.912..39.732 rows=4 loops=1)
                                                                           Join Filter: (surgery.tag_id = tag.id)
                                                                           Rows Removed by Join Filter: 22661
                                                                           ->  Nested Loop  (cost=0.00..15499.10 rows=20 width=80) (actual time=22.735..31.913 rows=4 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 11824
                                                                                 ->  Nested Loop  (cost=0.00..14216.16 rows=20 width=72) (actual time=22.693..27.550 rows=4 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 11799
                                                                                       ->  Nested Loop  (cost=0.00..12878.16 rows=20 width=56) (actual time=22.386..22.420 rows=4 loops=1)
                                                                                             Join Filter: (animal.species_id = species.id)
                                                                                             Rows Removed by Join Filter: 53
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.014 rows=57 loops=1)
                                                                                             ->  Materialize  (cost=0.00..1765.25 rows=183 width=56) (actual time=0.342..0.392 rows=1 loops=57)
                                                                                                   ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.458..22.318 rows=1 loops=1)
                                                                                                         Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                         Rows Removed by Filter: 36586
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.003..0.848 rows=2951 loops=4)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.471 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.002..0.680 rows=2957 loops=4)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.905 rows=3923 loops=1)
                                                                           ->  Materialize  (cost=0.00..221.40 rows=7227 width=8) (actual time=0.002..1.169 rows=5666 loops=4)
                                                                                 ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.328 rows=7227 loops=1)
                                                                     ->  Materialize  (cost=0.00..140.60 rows=5307 width=22) (actual time=0.002..0.971 rows=3995 loops=4)
                                                                           ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.004..1.264 rows=5307 loops=1)
                                                               ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.025..0.058 rows=25 loops=4)
                                                                     Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=100)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=100)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 50.500 ms
(60 rows)

-- Test Case 10 - 1065 rows
explain analyze select * from detection_extract_test_view
  where timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=398.97..1704.98 rows=100 width=279) (actual time=6.947..11.656 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=398.97..6772.29 rows=488 width=279) (actual time=6.945..11.624 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=398.68..5892.13 rows=488 width=239) (actual time=6.879..10.539 rows=100 loops=1)
               ->  Nested Loop  (cost=397.27..4950.72 rows=459 width=193) (actual time=6.807..8.535 rows=100 loops=1)
                     ->  Nested Loop  (cost=397.13..4858.12 rows=466 width=187) (actual time=6.801..8.252 rows=100 loops=1)
                           ->  Nested Loop  (cost=396.99..4617.80 rows=1400 width=168) (actual time=6.796..7.993 rows=100 loops=1)
                                 ->  Nested Loop  (cost=396.85..4384.47 rows=1400 width=171) (actual time=6.790..7.726 rows=100 loops=1)
                                       ->  Hash Join  (cost=396.57..3806.73 rows=1400 width=156) (actual time=6.774..7.275 rows=100 loops=1)
                                             Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                             ->  Hash Join  (cost=337.39..3728.30 rows=1400 width=156) (actual time=5.921..6.346 rows=100 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Hash Join  (cost=334.70..3706.36 rows=1400 width=125) (actual time=5.838..6.205 rows=100 loops=1)
                                                         Hash Cond: (installation_station.installation_id = installation.id)
                                                         ->  Hash Join  (cost=330.23..3682.64 rows=1400 width=109) (actual time=5.755..6.066 rows=100 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Hash Join  (cost=260.04..3591.45 rows=1400 width=60) (actual time=4.480..4.715 rows=100 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.037..0.163 rows=100 loops=1)
                                                                           Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                     ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.414..4.414 rows=5710 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                                           ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.622 rows=5710 loops=1)
                                                               ->  Hash  (cost=45.64..45.64 rows=1964 width=57) (actual time=1.258..1.258 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 179kB
                                                                     ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.523 rows=1964 loops=1)
                                                         ->  Hash  (cost=3.10..3.10 rows=110 width=32) (actual time=0.065..0.065 rows=110 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 8kB
                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.026 rows=110 loops=1)
                                                   ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.061..0.061 rows=75 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.019 rows=75 loops=1)
                                             ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.831..0.831 rows=1519 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.006..0.429 rows=1519 loops=1)
                                       ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                                             Index Cond: (id = receiver_deployment.receiver_id)
                                 ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                                       Index Cond: (id = receiver.model_id)
                           ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
                                 Index Cond: (id = receiver.organisation_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
               ->  Nested Loop Left Join  (cost=1.41..2.04 rows=1 width=46) (actual time=0.016..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.68 rows=1 width=46) (actual time=0.013..0.015 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..1.24 rows=1 width=22) (actual time=0.010..0.011 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.90 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.56 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 11.983 ms
(60 rows)

-- Test Case 11 - 5909 ^ 2153 -> 609 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=34.902..36.919 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=34.900..36.890 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=34.831..35.992 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=34.824..35.729 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=34.813..35.283 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=34.642..35.035 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=33.794..34.128 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.968..33.702 rows=1590 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.651..28.603 rows=1590 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.580..26.704 rows=14 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.567..26.636 rows=14 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.538..26.556 rows=14 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.528..24.528 rows=14 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.388 rows=2773 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.502..23.502 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.339..23.483 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.469 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.287..22.287 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.424..22.280 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.987..1.987 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.925 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=14)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=14)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.012..0.088 rows=114 loops=14)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.285..4.285 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.571 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.110..0.110 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.066..0.108 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.051..0.075 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.013 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.024 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.830..0.830 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.414 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.149..0.149 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.092 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 37.406 ms
(69 rows)

-- Test Case 12 - 5909 ^ 1065 -> 55 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.598..3.961 rows=55 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.597..3.944 rows=55 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3373.72 rows=6 width=239) (actual time=0.538..3.325 rows=55 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3371.58 rows=6 width=239) (actual time=0.532..3.133 rows=55 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3368.94 rows=6 width=215) (actual time=0.525..2.940 rows=55 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3366.85 rows=6 width=215) (actual time=0.519..2.754 rows=55 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3364.85 rows=6 width=215) (actual time=0.508..2.577 rows=55 loops=1)
                                       ->  Nested Loop  (cost=27.78..3361.41 rows=6 width=193) (actual time=0.496..2.320 rows=55 loops=1)
                                             ->  Nested Loop  (cost=27.63..3360.22 rows=6 width=187) (actual time=0.492..2.167 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3356.96 rows=19 width=168) (actual time=0.488..2.022 rows=55 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3349.38 rows=19 width=168) (actual time=0.482..1.822 rows=55 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 825
                                                               ->  Nested Loop  (cost=27.21..3343.62 rows=19 width=171) (actual time=0.472..1.545 rows=55 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3335.78 rows=19 width=156) (actual time=0.463..1.295 rows=55 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.024..0.734 rows=1065 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.296..0.296 rows=64 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.091..0.245 rows=64 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.084..0.125 rows=15 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.074..0.100 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.014 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.024..0.024 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.007..0.015 rows=15 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.007 rows=4 loops=15)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=55)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=55)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.56 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=55)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=55)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=55)
               Index Cond: (animal.species_id = id)
 Total runtime: 4.278 ms
(58 rows)

-- Test Case 13 -  2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.69..5500.06 rows=2 width=279) (actual time=33.087..34.185 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.69..5500.06 rows=2 width=279) (actual time=33.086..34.173 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.004..0.013 rows=51 loops=1)
         ->  Materialize  (cost=2141.69..5493.92 rows=6 width=260) (actual time=0.619..0.640 rows=55 loops=51)
               ->  Nested Loop  (cost=2141.69..5493.89 rows=6 width=260) (actual time=31.554..32.335 rows=55 loops=1)
                     ->  Nested Loop  (cost=2141.55..5492.70 rows=6 width=254) (actual time=31.546..32.193 rows=55 loops=1)
                           ->  Nested Loop  (cost=2141.27..5490.31 rows=6 width=254) (actual time=31.535..31.999 rows=55 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 825
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                 ->  Materialize  (cost=2141.27..5487.72 rows=6 width=257) (actual time=1.770..1.974 rows=55 loops=16)
                                       ->  Nested Loop  (cost=2141.27..5487.69 rows=6 width=257) (actual time=28.314..31.424 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.99..5485.22 rows=6 width=242) (actual time=28.305..31.238 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.84..5483.53 rows=6 width=211) (actual time=28.297..31.083 rows=55 loops=1)
                                                         Join Filter: (installation_station.installation_id = installation.id)
                                                         Rows Removed by Join Filter: 5995
                                                         ->  Index Scan using installation_project_id_index on installation  (cost=0.14..16.50 rows=110 width=32) (actual time=0.006..0.049 rows=110 loops=1)
                                                         ->  Materialize  (cost=2140.70..5457.14 rows=6 width=195) (actual time=0.243..0.261 rows=55 loops=110)
                                                               ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.703..28.073 rows=55 loops=1)
                                                                     ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.692..27.878 rows=55 loops=1)
                                                                           ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.679..27.680 rows=55 loops=1)
                                                                                 ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.650..27.488 rows=55 loops=1)
                                                                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                                       ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.023..0.627 rows=1065 loops=1)
                                                                                             Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                       ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.448..26.448 rows=27 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                                             ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.115..26.419 rows=27 loops=1)
                                                                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.089..26.290 rows=27 loops=1)
                                                                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.527 rows=3923 loops=1)
                                                                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.051..25.051 rows=27 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.618..25.036 rows=27 loops=1)
                                                                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.555 rows=3920 loops=1)
                                                                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.592..23.592 rows=35 loops=1)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.441..23.568 rows=35 loops=1)
                                                                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.489 rows=4023 loops=1)
                                                                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.390..22.390 rows=1 loops=1)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.505..22.381 rows=1 loops=1)
                                                                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                                             Rows Removed by Filter: 36586
                                                                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=27)
                                                                                                         Index Cond: (tag_id = surgery.tag_id)
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                                                                       Index Cond: (id = sensor.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                                                 Index Cond: (id = valid_detection.receiver_deployment_id)
                                                                     ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.station_id)
                                                   ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.002 rows=1 loops=55)
                                                         Index Cond: (id = installation.project_id)
                                             ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 34.726 ms
(66 rows)

-- Test Case 14 -  5909 ^ 2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.812..33.029 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.810..33.013 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Nested Loop  (cost=2141.26..5476.66 rows=1 width=260) (actual time=26.736..31.770 rows=55 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 9460
               ->  Nested Loop  (cost=2141.26..5465.77 rows=1 width=254) (actual time=26.663..28.931 rows=55 loops=1)
                     ->  Nested Loop  (cost=2140.98..5465.37 rows=1 width=254) (actual time=26.652..28.724 rows=55 loops=1)
                           Join Filter: (receiver.model_id = device_model.id)
                           Rows Removed by Join Filter: 825
                           ->  Nested Loop  (cost=2140.98..5464.01 rows=1 width=257) (actual time=26.636..28.367 rows=55 loops=1)
                                 ->  Nested Loop  (cost=2140.70..5463.60 rows=1 width=242) (actual time=26.625..28.168 rows=55 loops=1)
                                       Join Filter: (installation_station.installation_id = installation.id)
                                       ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.031..0.069 rows=1 loops=1)
                                             Join Filter: (installation.project_id = receiver_project.id)
                                             Rows Removed by Join Filter: 109
                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.014..0.025 rows=1 loops=1)
                                                   Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                   Rows Removed by Filter: 74
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.014 rows=110 loops=1)
                                       ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.585..28.060 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.574..27.865 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.562..27.657 rows=55 loops=1)
                                                         ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.531..27.407 rows=55 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.028..0.642 rows=1065 loops=1)
                                                                     Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.348..26.348 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.033..26.314 rows=27 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.008..26.188 rows=27 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.505 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.962..24.962 rows=27 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.557..24.945 rows=27 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.558 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.531..23.531 rows=35 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.378..23.512 rows=35 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.495 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.337..22.337 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.438..22.315 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=27)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=55)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=55)
                                       Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=55)
                     ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                           Index Cond: (id = valid_detection.receiver_download_id)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=55)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=55)
 Total runtime: 33.477 ms
(66 rows)

-- Mixed selectivity filtering
-- Test Case 15 - 5909 ^ 833188 -> 184 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=41.178..1170.897 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=41.175..1170.858 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=41.105..1169.614 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=41.097..1169.306 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=41.085..1168.750 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=40.904..1168.491 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=40.048..1167.545 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.996..1065.440 rows=702071 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.701..749.900 rows=702071 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.648..27.965 rows=83 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.635..27.448 rows=68 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.606..26.778 rows=68 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.596..24.638 rows=67 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..0.383 rows=2240 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.546..23.546 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.437..23.483 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.482 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.278..22.278 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.037..22.270 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.987..1.987 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.936 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=68)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=68)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.021..5.115 rows=8459 loops=83)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.270..4.270 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.515 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.107..0.107 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.064..0.098 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.051..0.075 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.012 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.023..0.023 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.014 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.833..0.833 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.427 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.148..0.148 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.092 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 1171.375 ms
(69 rows)

-- Test Case 16 - 5909 ^ 17098775 -> 3889 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=387.12..886.77 rows=100 width=279) (actual time=1.515..4.876 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=387.12..375160.94 rows=75008 width=279) (actual time=1.513..4.844 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=386.83..239875.54 rows=75008 width=239) (actual time=1.460..3.786 rows=100 loops=1)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=1.407..1.750 rows=100 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=1.263..1.545 rows=100 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=1.222..1.449 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=0.444..0.589 rows=100 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.050..0.075 rows=3 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.047..0.066 rows=3 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.041..0.046 rows=3 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.033..0.033 rows=1 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.022..0.022 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 27
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.008 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 7
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.006 rows=28 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.009..0.009 rows=1 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.007..0.010 rows=3 loops=1)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.005..0.006 rows=1 loops=3)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=3)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=0.121..0.157 rows=33 loops=3)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 148
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=0.040..0.040 rows=210 loops=3)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.769..0.769 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.416 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.021 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.084 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..1.78 rows=1 width=46) (actual time=0.017..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..1.42 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..0.98 rows=1 width=22) (actual time=0.011..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..0.63 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.30 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 5.169 ms
(62 rows)

-- Test Case 17 - 2716283 ^ 464 -> 448 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
limit 100;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2336.85..6439.39 rows=100 width=279) (actual time=32.085..34.451 rows=100 loops=1)
   ->  Nested Loop  (cost=2336.85..43977.68 rows=1015 width=279) (actual time=32.083..34.418 rows=100 loops=1)
         ->  Nested Loop  (cost=2336.71..43426.03 rows=3051 width=260) (actual time=32.013..33.490 rows=100 loops=1)
               ->  Nested Loop  (cost=2336.57..42917.55 rows=3051 width=263) (actual time=32.006..33.228 rows=100 loops=1)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=31.995..32.779 rows=100 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=31.825..32.544 rows=100 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=30.969..31.625 rows=100 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.789..31.391 rows=104 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.478..26.977 rows=104 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.445..26.544 rows=8 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.420..26.478 rows=8 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.392..26.424 rows=8 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.400..24.424 rows=8 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.367 rows=2541 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.490..23.490 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.479..23.481 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.503 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.303..22.303 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.468..22.296 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.968..1.968 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.892 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=8)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.006..0.007 rows=1 loops=8)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.010..0.045 rows=13 loops=8)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.284..4.284 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.577 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.152..0.152 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.069..0.131 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.055..0.080 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.014 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.032 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.838..0.838 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.418 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.148..0.148 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.084 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 34.930 ms
(69 rows)

-- Test Case 18 - 2716283 ^ 2005 -> 4 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2013-06-08 00:00:00+00' and '2013-06-08 01:00:00+00'
limit 100;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.128..2.706 rows=4 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.127..2.704 rows=4 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3884.18 rows=7 width=239) (actual time=2.070..2.615 rows=4 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3881.69 rows=7 width=239) (actual time=2.064..2.598 rows=4 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3878.61 rows=7 width=215) (actual time=2.058..2.581 rows=4 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3876.17 rows=7 width=215) (actual time=2.051..2.563 rows=4 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3873.84 rows=7 width=215) (actual time=2.026..2.528 rows=4 loops=1)
                                       ->  Nested Loop  (cost=27.78..3870.07 rows=7 width=193) (actual time=2.013..2.500 rows=4 loops=1)
                                             ->  Nested Loop  (cost=27.63..3868.68 rows=7 width=187) (actual time=2.009..2.488 rows=4 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3864.90 rows=22 width=168) (actual time=2.004..2.475 rows=4 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3856.39 rows=22 width=168) (actual time=1.995..2.453 rows=4 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 60
                                                               ->  Nested Loop  (cost=27.21..3849.91 rows=22 width=171) (actual time=1.984..2.417 rows=4 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3840.83 rows=22 width=156) (actual time=1.976..2.396 rows=4 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3808.21 rows=1613 width=52) (actual time=0.048..1.258 rows=1839 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2013-06-08 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-06-08 01:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.771..0.771 rows=282 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.073..0.586 rows=282 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.064..0.131 rows=45 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.053..0.079 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.016 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.025..0.025 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.007..0.033 rows=45 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.007 rows=6 loops=45)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=4)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.38 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=4)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=4)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=4)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.53 rows=1 width=22) (actual time=0.005..0.005 rows=1 loops=4)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=4)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=4)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.003..0.004 rows=1 loops=4)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=4)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=4)
               Index Cond: (animal.species_id = id)
 Total runtime: 3.017 ms
(58 rows)

-- Test Case 19 - 464 ^ 17098775 -> 6 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=354.52..1250.94 rows=100 width=279) (actual time=10.193..56.884 rows=6 loops=1)
   ->  Nested Loop  (cost=354.52..209410.30 rows=23321 width=279) (actual time=10.192..56.881 rows=6 loops=1)
         ->  Nested Loop  (cost=354.38..196739.36 rows=70078 width=260) (actual time=10.140..56.780 rows=6 loops=1)
               ->  Nested Loop  (cost=354.24..185060.13 rows=70078 width=263) (actual time=10.133..56.759 rows=6 loops=1)
                     ->  Nested Loop  (cost=353.96..156140.68 rows=70078 width=248) (actual time=10.124..56.731 rows=6 loops=1)
                           ->  Nested Loop  (cost=353.82..136407.35 rows=70078 width=217) (actual time=10.118..56.711 rows=6 loops=1)
                                 ->  Nested Loop  (cost=353.67..123747.99 rows=70078 width=201) (actual time=10.112..56.691 rows=6 loops=1)
                                       ->  Nested Loop  (cost=353.40..100480.81 rows=70078 width=152) (actual time=10.103..56.661 rows=6 loops=1)
                                             ->  Nested Loop  (cost=353.25..86332.79 rows=71203 width=146) (actual time=10.097..56.639 rows=6 loops=1)
                                                   ->  Nested Loop  (cost=352.97..64437.30 rows=71203 width=146) (actual time=10.087..56.609 rows=6 loops=1)
                                                         ->  Nested Loop  (cost=352.69..42183.63 rows=71203 width=138) (actual time=10.073..56.562 rows=6 loops=1)
                                                               ->  Nested Loop  (cost=0.85..9870.73 rows=22 width=86) (actual time=5.388..55.617 rows=24 loops=1)
                                                                     ->  Nested Loop  (cost=0.57..9863.45 rows=20 width=88) (actual time=5.378..55.501 rows=20 loops=1)
                                                                           ->  Nested Loop  (cost=0.29..9856.58 rows=20 width=80) (actual time=5.363..55.416 rows=20 loops=1)
                                                                                 Join Filter: (animal_release.id = surgery.release_id)
                                                                                 Rows Removed by Join Filter: 78440
                                                                                 ->  Nested Loop  (cost=0.29..8573.65 rows=20 width=72) (actual time=3.636..35.110 rows=20 loops=1)
                                                                                       Join Filter: (animal.id = animal_release.animal_id)
                                                                                       Rows Removed by Join Filter: 78380
                                                                                       ->  Nested Loop  (cost=0.29..7235.65 rows=20 width=56) (actual time=1.540..13.541 rows=20 loops=1)
                                                                                             ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.600 rows=4023 loops=1)
                                                                                             ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=0 loops=4023)
                                                                                                   Index Cond: (id = animal.species_id)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 1
                                                                                       ->  Materialize  (cost=0.00..171.80 rows=3920 width=32) (actual time=0.001..0.457 rows=3920 loops=20)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.475 rows=3920 loops=1)
                                                                                 ->  Materialize  (cost=0.00..115.84 rows=3923 width=16) (actual time=0.000..0.419 rows=3923 loops=20)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.846 rows=3923 loops=1)
                                                                           ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=20)
                                                                                 Index Cond: (id = surgery.tag_id)
                                                                                 Heap Fetches: 0
                                                                     ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=20)
                                                                           Index Cond: (tag_id = tag.id)
                                                               ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.038..0.038 rows=0 loops=24)
                                                                     Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                     Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     Rows Removed by Filter: 19
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.011..0.011 rows=19 loops=24)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                         ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.30 rows=1 width=24) (actual time=0.005..0.006 rows=1 loops=6)
                                                               Index Cond: (id = valid_detection.receiver_deployment_id)
                                                   ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.30 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=6)
                                                         Index Cond: (id = valid_detection.receiver_download_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=6)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.003..0.004 rows=1 loops=6)
                                             Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using installation_pkey on installation  (cost=0.14..0.17 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=6)
                                       Index Cond: (id = installation_station.installation_id)
                           ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.003 rows=1 loops=6)
                                 Index Cond: (id = installation.project_id)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=6)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.003 rows=1 loops=6)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=6)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 57.537 ms
(59 rows)

-- Test Case 20 - 833188 ^ 5489 -> 210 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 100;
                                                                                                                                             QUERY PLAN                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2473.59..12305.40 rows=7 width=279) (actual time=271.546..274.707 rows=100 loops=1)
   ->  Nested Loop  (cost=2473.59..12305.40 rows=7 width=279) (actual time=271.544..274.687 rows=100 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 9533
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.012 rows=46 loops=1)
         ->  Materialize  (cost=2473.59..12288.44 rows=20 width=260) (actual time=5.600..5.872 rows=209 loops=46)
               ->  Nested Loop  (cost=2473.59..12288.34 rows=20 width=260) (actual time=257.603..268.949 rows=210 loops=1)
                     ->  Nested Loop  (cost=2473.44..12284.37 rows=20 width=254) (actual time=257.594..268.361 rows=210 loops=1)
                           ->  Nested Loop  (cost=2473.16..12277.66 rows=20 width=254) (actual time=257.582..267.659 rows=210 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 3150
                                 ->  Nested Loop  (cost=2473.16..12271.66 rows=20 width=257) (actual time=257.560..266.657 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2472.88..12263.40 rows=20 width=242) (actual time=257.550..265.874 rows=210 loops=1)
                                             Join Filter: (installation_station.installation_id = installation.id)
                                             Rows Removed by Join Filter: 22890
                                             ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.076..0.178 rows=110 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                   ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.049..0.049 rows=75 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.012 rows=75 loops=1)
                                             ->  Materialize  (cost=2470.19..12223.15 rows=20 width=195) (actual time=0.802..2.336 rows=210 loops=110)
                                                   ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=88.191..254.555 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=88.180..253.851 rows=210 loops=1)
                                                               ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=88.167..253.022 rows=210 loops=1)
                                                                     ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.397..27.924 rows=147 loops=1)
                                                                           ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.383..27.318 rows=119 loops=1)
                                                                                 ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.354..26.770 rows=119 loops=1)
                                                                                       Hash Cond: (surgery.release_id = animal_release.id)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.506 rows=3923 loops=1)
                                                                                       ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.239..25.239 rows=117 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                             ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.743..25.186 rows=117 loops=1)
                                                                                                   Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                   ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.523 rows=3920 loops=1)
                                                                                                   ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.694..23.694 rows=125 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                                         ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.549..23.616 rows=125 loops=1)
                                                                                                               Hash Cond: (animal.species_id = species.id)
                                                                                                               ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.497 rows=4023 loops=1)
                                                                                                               ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.375..22.375 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.146..22.366 rows=1 loops=1)
                                                                                                                           Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                                           Rows Removed by Filter: 36586
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                       Index Cond: (id = surgery.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                 Index Cond: (tag_id = tag.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.528..1.529 rows=1 loops=147)
                                                                           Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                                           ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.527..1.527 rows=0 loops=147)
                                                                                 ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.633..0.633 rows=5041 loops=147)
                                                                                       Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                                 ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.872..0.872 rows=5668 loops=147)
                                                                                       Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=210)
                                                                     Index Cond: (id = valid_detection.receiver_deployment_id)
                                                         ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=210)
                                                               Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=210)
                                             Index Cond: (id = receiver_deployment.receiver_id)
                                 ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=210)
                                       ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.004..0.005 rows=16 loops=1)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=210)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=210)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 275.196 ms
(70 rows)

-- Test Case 21 - 5909 ^ 2153 ^ 17098775 -> 284 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=34.147..36.186 rows=100 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=34.145..36.158 rows=100 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=34.077..35.255 rows=100 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=34.069..34.989 rows=100 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=34.058..34.542 rows=100 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=32.384..32.805 rows=100 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.539..32.438 rows=1209 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.338..27.675 rows=1209 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.081..25.961 rows=17 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.069..25.881 rows=17 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.039..25.792 rows=17 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.314 rows=2490 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.997..24.997 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.601..24.981 rows=27 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.527 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.576..23.576 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.421..23.553 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.465 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.367..22.367 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.483..22.360 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=17)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=17)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.035..0.079 rows=71 loops=17)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 22
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.023..0.023 rows=99 loops=17)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.176..4.176 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.567 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.117..0.117 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.071..0.106 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.056..0.080 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.017 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.026..0.026 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.015 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.649..1.649 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.171..1.195 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.005..0.222 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.143..0.143 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.088 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=100)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=100)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=100)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 36.656 ms
(73 rows)

-- Test Case 22 - 5909 ^ 833188 ^ 5489 -> 13 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 100;
                                                                                                                                       QUERY PLAN                                                                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470.75..12251.27 rows=1 width=279) (actual time=87.122..254.979 rows=13 loops=1)
   ->  Nested Loop  (cost=2470.75..12251.27 rows=1 width=279) (actual time=87.120..254.972 rows=13 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 650
         ->  Nested Loop  (cost=2470.75..12249.09 rows=1 width=260) (actual time=87.050..254.635 rows=13 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 2236
               ->  Nested Loop  (cost=2470.75..12238.20 rows=1 width=254) (actual time=86.981..253.961 rows=13 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 195
                     ->  Nested Loop  (cost=2470.75..12236.84 rows=1 width=257) (actual time=86.972..253.867 rows=13 loops=1)
                           ->  Nested Loop  (cost=2470.47..12236.43 rows=1 width=242) (actual time=86.961..253.813 rows=13 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 197
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.031..0.070 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.013..0.025 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2470.47..12229.77 rows=20 width=195) (actual time=86.920..253.682 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=86.910..253.004 rows=210 loops=1)
                                             ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=86.898..252.295 rows=210 loops=1)
                                                   ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=86.886..251.485 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.221..27.642 rows=147 loops=1)
                                                               ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.206..27.052 rows=119 loops=1)
                                                                     ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.182..26.516 rows=119 loops=1)
                                                                           Hash Cond: (surgery.release_id = animal_release.id)
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.555 rows=3923 loops=1)
                                                                           ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.078..25.078 rows=117 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                 ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.597..25.031 rows=117 loops=1)
                                                                                       Hash Cond: (animal_release.animal_id = animal.id)
                                                                                       ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.534 rows=3920 loops=1)
                                                                                       ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.560..23.560 rows=125 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                             ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.418..23.520 rows=125 loops=1)
                                                                                                   Hash Cond: (animal.species_id = species.id)
                                                                                                   ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.524 rows=4023 loops=1)
                                                                                                   ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.261..22.261 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.027..22.253 rows=1 loops=1)
                                                                                                               Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                               Rows Removed by Filter: 36586
                                                                     ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=119)
                                                                           Index Cond: (id = surgery.tag_id)
                                                                           Heap Fetches: 0
                                                               ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                     Index Cond: (tag_id = tag.id)
                                                         ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.520..1.520 rows=1 loops=147)
                                                               Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                               ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.518..1.518 rows=0 loops=147)
                                                                     ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.624..0.624 rows=5041 loops=147)
                                                                           Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.876..0.876 rows=5668 loops=147)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=210)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=210)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=210)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=13)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=13)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.022 rows=173 loops=13)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=13)
 Total runtime: 255.295 ms
(69 rows)

-- Test Case 23 - 5909 ^ 833188 ^ 17098775 -> 54 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=33.878..1335.055 rows=54 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.877..1335.026 rows=54 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=33.808..1334.193 rows=54 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=33.800..1334.010 rows=54 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=33.787..1333.670 rows=54 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=32.233..1332.053 rows=54 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=31.192..1233.210 rows=694779 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=27.068..925.159 rows=694779 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.354..28.799 rows=147 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.340..27.852 rows=119 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.312..26.769 rows=119 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.610 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.196..25.196 rows=117 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.701..25.132 rows=117 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.550 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.655..23.655 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.551..23.597 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.496 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.393..22.393 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.134..22.386 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=119)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=119)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.193..4.774 rows=4726 loops=147)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 942
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.880..0.880 rows=5668 loops=147)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.109..4.109 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.512 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.090..0.090 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.047..0.079 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.033..0.057 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.017..0.017 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.016 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.009..0.013 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.538..1.538 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.148..1.190 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.005..0.216 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.133..0.133 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.083 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=54)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=54)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=54)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 1335.367 ms
(73 rows)

-- Test Case 24 - 2716283 ^ 464 ^ 3129 -> 2 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.104..29.521 rows=2 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.102..29.517 rows=2 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 100
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.029..29.409 rows=2 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 344
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=26.961..29.286 rows=2 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 30
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=26.947..29.261 rows=2 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=26.939..29.248 rows=2 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.026..0.066 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.024 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.015 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=26.908..29.176 rows=2 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=26.897..29.160 rows=2 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=26.886..29.145 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=26.873..29.127 rows=2 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=26.860..29.108 rows=2 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.053..1.864 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.417..26.417 rows=24 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.210..26.394 rows=24 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.184..26.267 rows=20 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.509 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.018..25.018 rows=20 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.506..25.008 rows=20 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.543 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.616..23.616 rows=20 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.584..23.605 rows=20 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.495 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.428..22.428 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.520..22.421 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=20)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.006 rows=1 loops=2)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.005..0.007 rows=1 loops=2)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.005..0.005 rows=1 loops=2)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.005..0.006 rows=1 loops=2)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=2)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=2)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.022 rows=173 loops=2)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.008 rows=51 loops=2)
 Total runtime: 29.870 ms
(66 rows)

-- Test Case 25 - 2716283 ^ 464 ^ 17098775 -> 4 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..13826.55 rows=100 width=279) (actual time=31.713..33.479 rows=4 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=31.711..33.476 rows=4 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=31.643..33.379 rows=4 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=31.636..33.363 rows=4 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=31.626..33.338 rows=4 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=29.955..31.663 rows=4 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.631..31.487 rows=6 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.412..27.263 rows=6 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.360..26.567 rows=24 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.346..26.471 rows=20 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.315..26.366 rows=20 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.507 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.142..25.142 rows=20 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.590..25.131 rows=20 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.512 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.689..23.689 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.683..23.671 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.509 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.511..22.511 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.538..22.504 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=20)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=20)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.027..0.027 rows=0 loops=24)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 19
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.009..0.009 rows=19 loops=24)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.197..4.197 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.602 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.151..0.151 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.068..0.138 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.054..0.078 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.011 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.025..0.025 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.039 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.638..1.638 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.171..1.206 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.005..0.201 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.144..0.144 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.086 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=4)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=4)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 33.922 ms
(73 rows)

-- Test Case 26 - 2716283 ^ 3913743 ^ 3129 -> 52 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 100;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.805..43.352 rows=52 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.803..43.334 rows=52 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2600
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.731..42.110 rows=52 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 8944
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=27.661..39.472 rows=52 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 780
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=27.648..39.118 rows=52 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=27.639..38.918 rows=52 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 554
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.025..0.066 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.024 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=27.609..38.696 rows=606 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=27.597..36.782 rows=606 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=27.585..34.773 rows=606 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=27.560..32.578 rows=606 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=27.549..30.654 rows=606 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.036..1.787 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=27.490..27.490 rows=215 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 30kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.357..27.328 rows=215 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.331..26.657 rows=168 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.519 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.306..25.306 rows=167 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.798..25.248 rows=167 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.551 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.714..23.714 rows=174 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.440..23.638 rows=174 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.481 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.412..22.412 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.515..22.404 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=168)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=606)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=606)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=606)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=606)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=52)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.002 rows=16 loops=52)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=52)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=52)
 Total runtime: 43.672 ms
(67 rows)

\q
