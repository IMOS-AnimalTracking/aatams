
set role to aatams;
set role to aatams;
SET
-- Low selectivity filtering (large number of rows returned for each filter)
-- Test Case 1 - 2716283 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1455.68..2671.07 rows=100 width=279) (actual time=1852.606..1854.529 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=1455.68..2977903.27 rows=244897 width=279) (actual time=1852.603..1854.503 rows=100 loops=1)
         ->  Hash Left Join  (cost=1455.39..1569277.70 rows=244897 width=239) (actual time=1846.378..1847.162 rows=100 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=1334.87..1564871.48 rows=244897 width=239) (actual time=1844.084..1844.789 rows=100 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=1133.67..1560384.59 rows=244897 width=215) (actual time=1840.348..1840.987 rows=100 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=988.41..1553705.90 rows=244897 width=215) (actual time=1837.678..1838.238 rows=100 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=712.80..1548226.23 rows=244897 width=215) (actual time=1834.215..1834.712 rows=100 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=532.39..1539554.49 rows=230185 width=193) (actual time=1830.409..1830.797 rows=100 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=521.50..1536364.70 rows=233880 width=187) (actual time=1830.157..1830.480 rows=100 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=519.35..1531388.23 rows=702807 width=168) (actual time=1830.102..1830.366 rows=100 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=460.17..1521665.45 rows=702807 width=168) (actual time=1828.975..1829.182 rows=100 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=458.81..1512000.50 rows=702807 width=171) (actual time=1828.944..1829.093 rows=100 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Seq Scan on valid_detection  (cost=0.00..1306861.40 rows=52710540 width=52) (actual time=0.017..953.914 rows=5386078 loops=1)
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=8.849..8.849 rows=282 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 43kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=4.952..8.634 rows=282 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.383 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=4.927..4.927 rows=282 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.313..4.737 rows=282 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.442 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.267..0.267 rows=45 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.105..0.247 rows=45 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.052..0.077 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.026..0.026 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.015..0.025 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.045..0.145 rows=45 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.022..0.022 rows=45 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.011..0.011 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.009 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=1.109..1.109 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.676 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.036..0.036 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.015 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.208..0.208 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.131 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=3.733..3.733 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.032..1.986 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.435..3.435 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.005..1.557 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=2.651..2.651 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.026..1.536 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=3.718..3.718 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.017..2.491 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.272..2.272 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..1.159 rows=4023 loops=1)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.003..0.004 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 1855.261 ms
(78 rows)

-- Test Case 2 - 3913743 rows limited to first 100
explain analyze select * from detection_extract_test_view
where spcode = '37018030'
limit 100;
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4741.75..11153.44 rows=100 width=279) (actual time=113.282..114.543 rows=100 loops=1)
   ->  Hash Left Join  (cost=4741.75..5892981.17 rows=91836 width=279) (actual time=113.280..114.521 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018030'::text)
         Rows Removed by Filter: 4120
         ->  Hash Left Join  (cost=2253.55..4336436.41 rows=18367253 width=239) (actual time=46.659..59.326 rows=4243 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=1000.03..3698334.06 rows=17263859 width=193) (actual time=23.268..33.104 rows=4020 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=989.14..3459905.83 rows=17541004 width=187) (actual time=23.109..30.901 rows=4020 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=986.99..3086829.12 rows=52710540 width=168) (actual time=23.063..29.102 rows=4020 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=927.81..2362000.01 rows=52710540 width=168) (actual time=22.270..26.510 rows=4020 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Seq Scan on valid_detection  (cost=0.00..1306861.40 rows=52710540 width=52) (actual time=0.002..1.066 rows=4020 loops=1)
                                       ->  Hash  (cost=856.44..856.44 rows=5710 width=132) (actual time=22.248..22.248 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 969kB
                                             ->  Hash Join  (cost=382.84..856.44 rows=5710 width=132) (actual time=6.550..18.257 rows=5710 loops=1)
                                                   Hash Cond: (receiver.model_id = device_model.id)
                                                   ->  Hash Join  (cost=381.48..776.56 rows=5710 width=135) (actual time=6.533..15.811 rows=5710 loops=1)
                                                         Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                         ->  Hash Join  (cost=105.87..379.62 rows=5710 width=120) (actual time=2.524..8.539 rows=5710 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.903 rows=5710 loops=1)
                                                               ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.514..2.514 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 280kB
                                                                     ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.206..1.630 rows=1964 loops=1)
                                                                           Hash Cond: (installation_station.installation_id = installation.id)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.034..0.485 rows=1964 loops=1)
                                                                           ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.164..0.164 rows=110 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                                                 ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.062..0.121 rows=110 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.015 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.044..0.044 rows=75 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.019 rows=75 loops=1)
                                                         ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.995..3.995 rows=7227 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                               ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.004..2.201 rows=7227 loops=1)
                                                   ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.782..0.782 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.443 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.016 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.146..0.146 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.088 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=23.377..23.377 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=13.523..21.109 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.703..9.814 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.750..5.889 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.570 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.716..2.716 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.544 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.935..1.935 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.831 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=8.795..8.795 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.474..7.238 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.005..0.709 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.448..3.448 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.540 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=52.527..52.527 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.038..34.472 rows=36587 loops=1)
 Total runtime: 116.221 ms
(80 rows)

-- Test Case 3 - 17098775 rows limited to first 100
explain analyze select * from detection_extract_test_view
where timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2.82..5771.79 rows=100 width=279) (actual time=1.122..21.363 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=2.82..324538024.05 rows=5625584 width=279) (actual time=1.121..21.331 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=2.53..292180169.69 rows=5625584 width=239) (actual time=1.072..20.240 rows=100 loops=1)
               ->  Nested Loop  (cost=1.12..162298013.33 rows=5287633 width=193) (actual time=0.926..18.114 rows=100 loops=1)
                     Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
                     Rows Removed by Join Filter: 17190
                     ->  Nested Loop  (cost=1.12..148356319.96 rows=5372518 width=187) (actual time=0.781..13.846 rows=100 loops=1)
                           Join Filter: (receiver.organisation_id = organisation.id)
                           Rows Removed by Join Filter: 4971
                           ->  Nested Loop  (cost=1.12..136005881.39 rows=16144362 width=168) (actual time=0.760..12.492 rows=100 loops=1)
                                 ->  Merge Join  (cost=0.85..52810510.08 rows=16144362 width=168) (actual time=0.722..11.997 rows=100 loops=1)
                                       Merge Cond: (receiver_deployment.id = valid_detection.receiver_deployment_id)
                                       ->  Nested Loop  (cost=0.28..810484.09 rows=5710 width=132) (actual time=0.703..6.750 rows=2 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 16
                                             ->  Nested Loop  (cost=0.28..809112.49 rows=5710 width=135) (actual time=0.699..6.724 rows=2 loops=1)
                                                   Join Filter: (receiver_deployment.receiver_id = receiver.id)
                                                   Rows Removed by Join Filter: 7243
                                                   ->  Nested Loop  (cost=0.28..189916.61 rows=5710 width=120) (actual time=0.683..1.766 rows=2 loops=1)
                                                         Join Filter: (installation.project_id = receiver_project.id)
                                                         Rows Removed by Join Filter: 86
                                                         ->  Nested Loop  (cost=0.28..183490.92 rows=5710 width=89) (actual time=0.671..1.709 rows=2 loops=1)
                                                               Join Filter: (installation_station.installation_id = installation.id)
                                                               Rows Removed by Join Filter: 112
                                                               ->  Nested Loop  (cost=0.28..174066.04 rows=5710 width=73) (actual time=0.663..1.633 rows=2 loops=1)
                                                                     Join Filter: (receiver_deployment.station_id = installation_station.id)
                                                                     Rows Removed by Join Filter: 2873
                                                                     ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..5798.89 rows=5710 width=24) (actual time=0.009..0.012 rows=2 loops=1)
                                                                     ->  Materialize  (cost=0.00..55.46 rows=1964 width=57) (actual time=0.005..0.597 rows=1438 loops=2)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.005..0.505 rows=1964 loops=1)
                                                               ->  Materialize  (cost=0.00..3.65 rows=110 width=32) (actual time=0.002..0.028 rows=57 loops=2)
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.025 rows=110 loops=1)
                                                         ->  Materialize  (cost=0.00..2.12 rows=75 width=39) (actual time=0.002..0.021 rows=44 loops=2)
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.017 rows=75 loops=1)
                                                   ->  Materialize  (cost=0.00..221.40 rows=7227 width=31) (actual time=0.002..1.998 rows=3622 loops=2)
                                                         ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.028 rows=7227 loops=1)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.009 rows=9 loops=2)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.007 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..51801897.72 rows=16144362 width=52) (actual time=0.014..5.179 rows=100 loops=1)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 2460
                                 ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..5.14 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=100)
                                       Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Materialize  (cost=0.00..1.77 rows=51 width=35) (actual time=0.000..0.005 rows=51 loops=100)
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.022 rows=51 loops=1)
                     ->  Materialize  (cost=0.00..9.60 rows=173 width=22) (actual time=0.000..0.016 rows=173 loops=100)
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.085 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..24.55 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..19.26 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..13.70 rows=1 width=22) (actual time=0.011..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..8.35 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.50 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=99)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=99)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=99)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=99)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 21.998 ms
(65 rows)

-- Test Case 4 -  2716283 ^ 3913743 -> 1420919 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3943.60..133755.52 rows=100 width=279) (actual time=62.021..63.925 rows=100 loops=1)
   ->  Hash Left Join  (cost=3943.60..1592841.51 rows=1224 width=279) (actual time=62.020..63.897 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018030'::text)
         Rows Removed by Filter: 320
         ->  Hash Left Join  (cost=1455.39..1569277.70 rows=244897 width=239) (actual time=18.924..21.614 rows=420 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=1334.87..1564871.48 rows=244897 width=239) (actual time=17.051..19.492 rows=420 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=1133.67..1560384.59 rows=244897 width=215) (actual time=14.585..16.749 rows=420 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=988.41..1553705.90 rows=244897 width=215) (actual time=12.673..14.582 rows=420 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=712.80..1548226.23 rows=244897 width=215) (actual time=9.546..11.197 rows=420 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=532.39..1539554.49 rows=230185 width=193) (actual time=6.776..8.090 rows=420 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=521.50..1536364.70 rows=233880 width=187) (actual time=6.630..7.726 rows=420 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=519.35..1531388.23 rows=702807 width=168) (actual time=6.588..7.465 rows=420 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=460.17..1521665.45 rows=702807 width=168) (actual time=5.814..6.485 rows=420 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=458.81..1512000.50 rows=702807 width=171) (actual time=5.796..6.240 rows=420 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Seq Scan on valid_detection  (cost=0.00..1306861.40 rows=52710540 width=52) (actual time=0.003..0.091 rows=420 loops=1)
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.782..5.782 rows=282 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 43kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.371..5.626 rows=282 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.907 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.361..3.361 rows=282 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.168..3.219 rows=282 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.001..0.792 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.138..0.138 rows=45 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.064..0.125 rows=45 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.035..0.060 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.018..0.018 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.017 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.026..0.048 rows=45 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.017..0.017 rows=45 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.006 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.766..0.766 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.466 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.019 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.084 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.752..2.752 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.005..1.432 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.115..3.115 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.002..1.498 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.900..1.900 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.898 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.455..2.455 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.466 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.859..1.859 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.840 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.398..41.398 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..24.499 rows=36587 loops=1)
 Total runtime: 65.388 ms
(82 rows)

-- Test Case 5 - 2716283 ^ 17098775 -> 902906 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                               QUERY PLAN                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=463.19..7470.65 rows=100 width=279) (actual time=6.420..15.469 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=463.19..5256616.62 rows=75008 width=279) (actual time=6.419..15.448 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=462.90..4825177.33 rows=75008 width=239) (actual time=6.357..14.366 rows=100 loops=1)
               ->  Nested Loop  (cost=461.50..3093409.68 rows=70502 width=193) (actual time=6.206..12.294 rows=100 loops=1)
                     Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
                     Rows Removed by Join Filter: 17190
                     ->  Nested Loop  (cost=461.50..2907510.29 rows=71634 width=187) (actual time=6.064..8.010 rows=100 loops=1)
                           Join Filter: (receiver.organisation_id = organisation.id)
                           Rows Removed by Join Filter: 4971
                           ->  Nested Loop  (cost=461.50..2742836.28 rows=215258 width=168) (actual time=6.037..6.668 rows=100 loops=1)
                                 ->  Hash Join  (cost=461.22..1633565.49 rows=215258 width=168) (actual time=6.022..6.204 rows=100 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Seq Scan on valid_detection  (cost=0.00..1570414.10 rows=16144362 width=52) (actual time=0.019..0.099 rows=100 loops=1)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 46
                                       ->  Hash  (cost=460.27..460.27 rows=76 width=132) (actual time=5.988..5.988 rows=282 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 42kB
                                             ->  Hash Join  (cost=246.09..460.27 rows=76 width=132) (actual time=3.369..5.828 rows=282 loops=1)
                                                   Hash Cond: (receiver.model_id = device_model.id)
                                                   ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.349..5.696 rows=282 loops=1)
                                                         Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                         ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.961 rows=7227 loops=1)
                                                         ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.338..3.338 rows=282 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                               ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.165..3.213 rows=282 loops=1)
                                                                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                     ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.736 rows=5710 loops=1)
                                                                     ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.135..0.135 rows=45 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                           ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.060..0.116 rows=45 loops=1)
                                                                                 ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.033..0.058 rows=1 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.016..0.016 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.016 rows=1 loops=1)
                                                                                                   Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                   Rows Removed by Filter: 74
                                                                                 ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.024..0.044 rows=45 loops=1)
                                                                                       Recheck Cond: (installation_id = installation.id)
                                                                                       ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.014..0.014 rows=45 loops=1)
                                                                                             Index Cond: (installation_id = installation.id)
                                                   ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.013..0.013 rows=16 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                 ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..5.14 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=100)
                                       Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Materialize  (cost=0.00..1.77 rows=51 width=35) (actual time=0.000..0.005 rows=51 loops=100)
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.003..0.021 rows=51 loops=1)
                     ->  Materialize  (cost=0.00..9.60 rows=173 width=22) (actual time=0.000..0.017 rows=173 loops=100)
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.085 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..24.55 rows=1 width=46) (actual time=0.017..0.020 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..19.26 rows=1 width=46) (actual time=0.014..0.016 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..13.70 rows=1 width=22) (actual time=0.011..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..8.35 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.50 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=100)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=100)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=100)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 15.778 ms
(69 rows)

-- Test Case 6 - 3913743 ^ 17098775 -> 2233756 rows limited to first 100
explain analyze select * from detection_extract_test_view
where spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=348654.03..357276.65 rows=100 width=279) (actual time=3681.442..3682.613 rows=100 loops=1)
   ->  Hash Left Join  (cost=348654.03..2774024.89 rows=28128 width=279) (actual time=3681.440..3682.585 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018030'::text)
         Rows Removed by Filter: 1039
         ->  Hash Left Join  (cost=346165.82..2295305.48 rows=5625584 width=239) (actual time=3635.772..3640.266 rows=1139 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=344912.31..2098995.76 rows=5287633 width=193) (actual time=3612.301..3616.065 rows=1139 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=344901.41..2025961.60 rows=5372518 width=187) (actual time=3612.156..3615.335 rows=1139 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=344899.27..1911692.91 rows=16144362 width=168) (actual time=3612.110..3614.769 rows=1139 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=344840.09..1689648.76 rows=16144362 width=168) (actual time=3611.333..3613.475 rows=1139 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=343912.28..1365833.71 rows=16144362 width=52) (actual time=3589.393..3590.737 rows=1139 loops=1)
                                             Recheck Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Index Recheck: 1277
                                             ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..339876.18 rows=16144362 width=0) (actual time=3587.857..3587.857 rows=16316319 loops=1)
                                                   Index Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                       ->  Hash  (cost=856.44..856.44 rows=5710 width=132) (actual time=21.911..21.911 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 969kB
                                             ->  Hash Join  (cost=382.84..856.44 rows=5710 width=132) (actual time=6.299..17.935 rows=5710 loops=1)
                                                   Hash Cond: (receiver.model_id = device_model.id)
                                                   ->  Hash Join  (cost=381.48..776.56 rows=5710 width=135) (actual time=6.281..15.542 rows=5710 loops=1)
                                                         Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                         ->  Hash Join  (cost=105.87..379.62 rows=5710 width=120) (actual time=2.287..8.283 rows=5710 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.900 rows=5710 loops=1)
                                                               ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.277..2.277 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 280kB
                                                                     ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.155..1.424 rows=1964 loops=1)
                                                                           Hash Cond: (installation_station.installation_id = installation.id)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.254 rows=1964 loops=1)
                                                                           ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.146..0.146 rows=110 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                                                 ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.050..0.114 rows=110 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.012 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.039..0.039 rows=75 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.015 rows=75 loops=1)
                                                         ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.982..3.982 rows=7227 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                               ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.003..2.144 rows=7227 loops=1)
                                                   ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.006 rows=16 loops=1)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.762..0.762 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.427 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.023 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.130..0.130 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.085 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=23.432..23.432 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=13.491..21.118 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.677..9.834 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.761..5.963 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.545 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.727..2.727 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.005..1.579 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.891..1.891 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.819 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=8.795..8.795 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.502..7.272 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.006..0.744 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.474..3.474 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.003..1.547 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.151..41.151 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..24.074 rows=36587 loops=1)
 Total runtime: 3683.988 ms
(84 rows)

-- Test Case 7 - 2716283 ^ 3913743 ^ 17098775 -> 690003 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=347855.87..643470.25 rows=100 width=279) (actual time=3091.467..3092.964 rows=100 loops=1)
   ->  Hash Left Join  (cost=347855.87..1456409.78 rows=375 width=279) (actual time=3091.465..3092.927 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018030'::text)
         Rows Removed by Filter: 225
         ->  Hash Left Join  (cost=345367.67..1447217.10 rows=75008 width=239) (actual time=3048.165..3050.537 rows=325 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=345247.15..1445783.94 rows=75008 width=239) (actual time=3046.127..3048.286 rows=325 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=345045.95..1444270.10 rows=75008 width=215) (actual time=3043.455..3045.399 rows=325 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=344900.68..1442123.76 rows=75008 width=215) (actual time=3041.443..3043.179 rows=325 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=344625.07..1440254.23 rows=75008 width=215) (actual time=3038.031..3039.545 rows=325 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=344444.67..1437473.06 rows=70502 width=193) (actual time=3035.059..3036.303 rows=325 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=344433.77..1436488.52 rows=71634 width=187) (actual time=3034.912..3035.979 rows=325 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=344431.63..1434962.82 rows=215258 width=168) (actual time=3034.870..3035.774 rows=325 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=344372.45..1431943.84 rows=215258 width=168) (actual time=3034.096..3034.831 rows=325 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=344371.09..1428982.69 rows=215258 width=171) (actual time=3034.076..3034.631 rows=325 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=343912.28..1365833.71 rows=16144362 width=52) (actual time=3027.463..3028.460 rows=1139 loops=1)
                                                                           Recheck Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                           Rows Removed by Index Recheck: 1277
                                                                           ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..339876.18 rows=16144362 width=0) (actual time=3026.066..3026.066 rows=16316319 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.824..5.824 rows=282 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 43kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.406..5.672 rows=282 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.942 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.396..3.396 rows=282 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.170..3.261 rows=282 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.792 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.140..0.140 rows=45 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.066..0.124 rows=45 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.038..0.063 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.020..0.020 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.009..0.020 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.025..0.043 rows=45 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.016..0.016 rows=45 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.764..0.764 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.410 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.023 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.084 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.946..2.946 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.007..1.344 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.387..3.387 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.005..1.527 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.992..1.992 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.931 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.647..2.647 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.473 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.018..2.018 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.863 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.590..41.590 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.005..24.348 rows=36587 loops=1)
 Total runtime: 3094.376 ms
(86 rows)

 
-- High selectivity filtering (small number of rows returned for each filter)
-- Test Case 8 - 5909 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1455.68..2671.07 rows=100 width=279) (actual time=3901.741..4131.325 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=1455.68..2977903.27 rows=244897 width=279) (actual time=3901.739..4131.290 rows=100 loops=1)
         ->  Hash Left Join  (cost=1455.39..1569277.70 rows=244897 width=239) (actual time=3901.615..4130.078 rows=100 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=1334.87..1564871.48 rows=244897 width=239) (actual time=3899.679..4128.048 rows=100 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=1133.67..1560384.59 rows=244897 width=215) (actual time=3896.981..4125.275 rows=100 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=988.41..1553705.90 rows=244897 width=215) (actual time=3895.045..4123.269 rows=100 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=712.80..1548226.23 rows=244897 width=215) (actual time=3892.010..4120.151 rows=100 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=532.39..1539554.49 rows=230185 width=193) (actual time=3889.227..4117.265 rows=100 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=521.50..1536364.70 rows=233880 width=187) (actual time=3889.051..4117.023 rows=100 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=519.35..1531388.23 rows=702807 width=168) (actual time=3889.007..4116.925 rows=100 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=460.17..1521665.45 rows=702807 width=168) (actual time=3888.249..4116.087 rows=100 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=458.81..1512000.50 rows=702807 width=171) (actual time=3888.229..4116.015 rows=100 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Seq Scan on valid_detection  (cost=0.00..1306861.40 rows=52710540 width=52) (actual time=0.003..2175.038 rows=12271667 loops=1)
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.308..5.308 rows=64 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.198..5.267 rows=64 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.908 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.160..3.160 rows=64 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.206..3.119 rows=64 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.001..0.783 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.107..0.107 rows=15 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.063..0.100 rows=15 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.036..0.060 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.018..0.018 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.017 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.023..0.030 rows=15 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.015..0.015 rows=15 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.010..0.010 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.748..0.748 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.429 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.018 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.154..0.154 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.103 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.759..2.759 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.007..1.457 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.020..3.020 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.003..1.479 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.923..1.923 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.923 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.684..2.684 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.535 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.912..1.912 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.821 rows=4023 loops=1)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.004..0.004 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 4131.699 ms
(78 rows)

-- Test Case 9 - 2153 rows
set geqo_threshold to 12;
SET
explain analyze select * from detection_extract_test_view
where spcode = '37018003'
limit 100;
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4741.75..11153.44 rows=100 width=279) (actual time=40615.318..40657.269 rows=100 loops=1)
   ->  Hash Left Join  (cost=4741.75..5892981.17 rows=91836 width=279) (actual time=40615.316..40657.242 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018003'::text)
         Rows Removed by Filter: 10379640
         ->  Hash Left Join  (cost=2253.55..4336436.41 rows=18367253 width=239) (actual time=46.254..34855.184 rows=11687728 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=1000.03..3698334.06 rows=17263859 width=193) (actual time=22.795..27312.605 rows=11172081 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=989.14..3459905.83 rows=17541004 width=187) (actual time=22.649..21988.798 rows=11172081 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=986.99..3086829.12 rows=52710540 width=168) (actual time=22.607..17013.483 rows=11172081 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=927.81..2362000.01 rows=52710540 width=168) (actual time=21.853..11915.509 rows=11172081 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Seq Scan on valid_detection  (cost=0.00..1306861.40 rows=52710540 width=52) (actual time=0.003..2471.130 rows=11172081 loops=1)
                                       ->  Hash  (cost=856.44..856.44 rows=5710 width=132) (actual time=21.834..21.834 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 969kB
                                             ->  Hash Join  (cost=382.84..856.44 rows=5710 width=132) (actual time=6.275..17.906 rows=5710 loops=1)
                                                   Hash Cond: (receiver.model_id = device_model.id)
                                                   ->  Hash Join  (cost=381.48..776.56 rows=5710 width=135) (actual time=6.258..15.464 rows=5710 loops=1)
                                                         Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                         ->  Hash Join  (cost=105.87..379.62 rows=5710 width=120) (actual time=2.284..8.302 rows=5710 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.001..0.889 rows=5710 loops=1)
                                                               ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.274..2.274 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 280kB
                                                                     ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.156..1.477 rows=1964 loops=1)
                                                                           Hash Cond: (installation_station.installation_id = installation.id)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.303 rows=1964 loops=1)
                                                                           ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.146..0.146 rows=110 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                                                 ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.050..0.113 rows=110 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.012 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.038..0.038 rows=75 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.020 rows=75 loops=1)
                                                         ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.960..3.960 rows=7227 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                               ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.003..2.036 rows=7227 loops=1)
                                                   ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=1)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.744..0.744 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.404 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.019 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.092 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=23.421..23.421 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=13.547..21.206 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.711..9.844 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.767..5.941 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.607 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.732..2.732 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.572 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.922..1.922 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.824 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=8.814..8.814 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.472..7.282 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.004..0.748 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.448..3.448 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.604 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.143..41.143 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.007..23.819 rows=36587 loops=1)
 Total runtime: 46758.505 ms
(80 rows)

-- Test Case 10 - 1065 rows
explain analyze select * from detection_extract_test_view
  where timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=1609.87..2935.20 rows=100 width=279) (actual time=24.152..26.551 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=1609.87..8077.48 rows=488 width=279) (actual time=24.150..26.524 rows=100 loops=1)
         ->  Hash Join  (cost=1609.58..5270.55 rows=488 width=239) (actual time=24.025..25.282 rows=100 loops=1)
               Hash Cond: (receiver.organisation_id = organisation.id)
               ->  Hash Left Join  (cost=1607.43..5258.03 rows=1466 width=220) (actual time=23.965..25.152 rows=100 loops=1)
                     Hash Cond: (animal_release.animal_id = animal.id)
                     ->  Hash Left Join  (cost=1486.91..5111.85 rows=1466 width=220) (actual time=21.945..23.067 rows=100 loops=1)
                           Hash Cond: (surgery.release_id = animal_release.id)
                           ->  Hash Left Join  (cost=1285.71..4885.00 rows=1466 width=196) (actual time=19.236..20.286 rows=100 loops=1)
                                 Hash Cond: (tag.id = surgery.tag_id)
                                 ->  Hash Left Join  (cost=1140.45..4700.62 rows=1466 width=196) (actual time=17.249..18.227 rows=100 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Hash Left Join  (cost=864.84..4393.86 rows=1466 width=196) (actual time=13.742..14.636 rows=100 loops=1)
                                             Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash Join  (cost=684.43..4162.62 rows=1378 width=174) (actual time=10.743..11.536 rows=100 loops=1)
                                                   Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                                   ->  Hash Join  (cost=673.54..4132.70 rows=1400 width=168) (actual time=10.601..11.338 rows=100 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=614.36..4054.27 rows=1400 width=168) (actual time=9.832..10.498 rows=100 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=613.00..4033.66 rows=1400 width=171) (actual time=9.811..10.428 rows=100 loops=1)
                                                                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                                     ->  Hash Join  (cost=337.39..3728.30 rows=1400 width=156) (actual time=5.676..6.209 rows=100 loops=1)
                                                                           Hash Cond: (installation.project_id = receiver_project.id)
                                                                           ->  Hash Join  (cost=334.70..3706.36 rows=1400 width=125) (actual time=5.620..6.099 rows=100 loops=1)
                                                                                 Hash Cond: (installation_station.installation_id = installation.id)
                                                                                 ->  Hash Join  (cost=330.23..3682.64 rows=1400 width=109) (actual time=5.551..5.971 rows=100 loops=1)
                                                                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                       ->  Hash Join  (cost=260.04..3591.45 rows=1400 width=60) (actual time=4.401..4.750 rows=100 loops=1)
                                                                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                                             ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.091..0.321 rows=100 loops=1)
                                                                                                   Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.284..4.284 rows=5710 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.539 rows=5710 loops=1)
                                                                                       ->  Hash  (cost=45.64..45.64 rows=1964 width=57) (actual time=1.137..1.137 rows=1964 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 179kB
                                                                                             ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.004..0.502 rows=1964 loops=1)
                                                                                 ->  Hash  (cost=3.10..3.10 rows=110 width=32) (actual time=0.057..0.057 rows=110 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 8kB
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.030 rows=110 loops=1)
                                                                           ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.039..0.039 rows=75 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                 ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.018 rows=75 loops=1)
                                                                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=4.123..4.123 rows=7227 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.096 rows=7227 loops=1)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.757..0.757 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.421 rows=1519 loops=1)
                                                   ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.130..0.130 rows=173 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                         ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.085 rows=173 loops=1)
                                             ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.973..2.973 rows=5307 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                                   ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.005..1.355 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.485..3.485 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.566 rows=7227 loops=1)
                                 ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.965..1.965 rows=3923 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.892 rows=3923 loops=1)
                           ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.685..2.685 rows=3920 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                 ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.506 rows=3920 loops=1)
                     ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.000..2.000 rows=4023 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 189kB
                           ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.892 rows=4023 loops=1)
               ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.042..0.042 rows=51 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 4kB
                     ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.023 rows=51 loops=1)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.004..0.004 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 26.890 ms
(77 rows)

-- Test Case 11 - 5909 ^ 2153 -> 609 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3943.60..133755.52 rows=100 width=279) (actual time=1852.950..1859.093 rows=100 loops=1)
   ->  Hash Left Join  (cost=3943.60..1592841.51 rows=1224 width=279) (actual time=1852.948..1859.067 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018003'::text)
         Rows Removed by Filter: 878
         ->  Hash Left Join  (cost=1455.39..1569277.70 rows=244897 width=239) (actual time=1810.770..1816.889 rows=978 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=1334.87..1564871.48 rows=244897 width=239) (actual time=1808.725..1814.278 rows=978 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=1133.67..1560384.59 rows=244897 width=215) (actual time=1806.047..1810.990 rows=978 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=988.41..1553705.90 rows=244897 width=215) (actual time=1804.118..1808.532 rows=978 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=712.80..1548226.23 rows=244897 width=215) (actual time=1801.047..1804.868 rows=978 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=532.39..1539554.49 rows=230185 width=193) (actual time=1798.342..1801.438 rows=978 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=521.50..1536364.70 rows=233880 width=187) (actual time=1798.196..1800.791 rows=978 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=519.35..1531388.23 rows=702807 width=168) (actual time=1798.152..1800.269 rows=978 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=460.17..1521665.45 rows=702807 width=168) (actual time=1797.374..1798.974 rows=978 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=458.81..1512000.50 rows=702807 width=171) (actual time=1797.354..1798.451 rows=978 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Seq Scan on valid_detection  (cost=0.00..1306861.40 rows=52710540 width=52) (actual time=0.003..946.681 rows=5293923 loops=1)
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.281..5.281 rows=64 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.129..5.238 rows=64 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.964 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.092..3.092 rows=64 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.203..3.057 rows=64 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.749 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.103..0.103 rows=15 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.060..0.099 rows=15 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.035..0.059 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.014 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.018..0.018 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.018 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.022..0.029 rows=15 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.014..0.014 rows=15 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.010..0.010 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.768..0.768 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.427 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.018 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.087 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.681..2.681 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.007..1.332 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.054..3.054 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.535 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.916..1.916 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.900 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.665..2.665 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.515 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.022..2.022 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.006..0.857 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.003..41.003 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.005..24.350 rows=36587 loops=1)
 Total runtime: 1860.487 ms
(82 rows)

-- Test Case 12 - 5909 ^ 1065 -> 55 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=247.55..3985.15 rows=6 width=279) (actual time=10.801..11.636 rows=55 loops=1)
   ->  Nested Loop Left Join  (cost=247.55..3985.15 rows=6 width=279) (actual time=10.799..11.619 rows=55 loops=1)
         ->  Nested Loop  (cost=247.26..3950.64 rows=6 width=239) (actual time=10.740..11.030 rows=55 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 9460
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.036 rows=173 loops=1)
               ->  Materialize  (cost=247.26..3926.35 rows=6 width=233) (actual time=0.020..0.045 rows=55 loops=173)
                     ->  Nested Loop Left Join  (cost=247.26..3926.32 rows=6 width=233) (actual time=3.478..6.836 rows=55 loops=1)
                           ->  Nested Loop Left Join  (cost=246.98..3894.57 rows=6 width=233) (actual time=3.457..6.636 rows=55 loops=1)
                                 ->  Nested Loop Left Join  (cost=246.70..3861.21 rows=6 width=209) (actual time=3.434..6.424 rows=55 loops=1)
                                       ->  Nested Loop Left Join  (cost=246.42..3829.10 rows=6 width=209) (actual time=3.414..6.235 rows=55 loops=1)
                                             ->  Nested Loop Left Join  (cost=246.14..3812.02 rows=6 width=209) (actual time=3.391..6.046 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=245.86..3778.81 rows=6 width=187) (actual time=3.366..5.779 rows=55 loops=1)
                                                         Join Filter: (receiver.organisation_id = organisation.id)
                                                         Rows Removed by Join Filter: 2750
                                                         ->  Nested Loop  (cost=245.86..3762.64 rows=19 width=168) (actual time=3.344..5.033 rows=55 loops=1)
                                                               ->  Nested Loop  (cost=245.58..3664.56 rows=19 width=168) (actual time=3.338..4.843 rows=55 loops=1)
                                                                     Join Filter: (receiver.model_id = device_model.id)
                                                                     Rows Removed by Join Filter: 825
                                                                     ->  Nested Loop  (cost=245.58..3658.80 rows=19 width=171) (actual time=3.329..4.572 rows=55 loops=1)
                                                                           ->  Hash Join  (cost=245.30..3554.14 rows=19 width=156) (actual time=3.304..4.326 rows=55 loops=1)
                                                                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                                 ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.025..1.007 rows=1065 loops=1)
                                                                                       Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.085..3.085 rows=64 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.204..3.056 rows=64 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.001..0.763 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.106..0.106 rows=15 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.059..0.095 rows=15 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.038..0.064 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.001..0.014 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.020..0.020 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.017 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.018..0.023 rows=15 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.011..0.011 rows=15 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..5.50 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=55)
                                                                                 Index Cond: (id = receiver_deployment.receiver_id)
                                                                     ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=55)
                                                                           ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.005 rows=16 loops=1)
                                                               ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..5.15 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                                                     Index Cond: (id = valid_detection.receiver_download_id)
                                                         ->  Materialize  (cost=0.00..1.77 rows=51 width=35) (actual time=0.000..0.005 rows=51 loops=55)
                                                               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.020 rows=51 loops=1)
                                                   ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.53 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=55)
                                                         Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                             ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=55)
                                                   Index Cond: (id = sensor.tag_id)
                                                   Heap Fetches: 0
                                       ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                             Index Cond: (tag.id = tag_id)
                                 ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.002..0.003 rows=1 loops=55)
                                       Index Cond: (surgery.release_id = id)
                           ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                 Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=55)
               Index Cond: (animal.species_id = id)
 Total runtime: 11.959 ms
(66 rows)

-- Test Case 13 -  2153 ^ 1065 -> 55 rows
explain analyze select * from detection_extract_test_view
where spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                            QUERY PLAN                                                                                                                             
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4832.69..7874.54 rows=2 width=279) (actual time=29.702..37.423 rows=55 loops=1)
   ->  Nested Loop Left Join  (cost=4832.69..7874.54 rows=2 width=279) (actual time=29.701..37.403 rows=55 loops=1)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018003'::text)
         Rows Removed by Filter: 1010
         ->  Hash Left Join  (cost=4832.40..5079.76 rows=488 width=239) (actual time=29.605..33.300 rows=1065 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=4711.89..4950.70 rows=488 width=239) (actual time=27.631..30.718 rows=1065 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=4510.69..4740.96 rows=488 width=215) (actual time=24.957..27.464 rows=1065 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Right Join  (cost=4365.42..4582.67 rows=488 width=215) (actual time=22.973..24.889 rows=1065 loops=1)
                                 Hash Cond: (tag.id = sensor.tag_id)
                                 ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.003..0.894 rows=7227 loops=1)
                                 ->  Hash  (cost=4359.32..4359.32 rows=488 width=215) (actual time=21.953..21.953 rows=1065 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 327kB
                                       ->  Hash Left Join  (cost=866.99..4359.32 rows=488 width=215) (actual time=13.230..20.630 rows=1065 loops=1)
                                             Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash Join  (cost=686.58..4161.98 rows=459 width=193) (actual time=10.227..16.713 rows=1065 loops=1)
                                                   Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                                   ->  Hash Join  (cost=675.68..4144.75 rows=466 width=187) (actual time=10.083..16.023 rows=1065 loops=1)
                                                         Hash Cond: (receiver.organisation_id = organisation.id)
                                                         ->  Hash Join  (cost=673.54..4132.70 rows=1400 width=168) (actual time=10.039..15.491 rows=1065 loops=1)
                                                               Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                               ->  Hash Join  (cost=614.36..4054.27 rows=1400 width=168) (actual time=9.237..14.074 rows=1065 loops=1)
                                                                     Hash Cond: (receiver.model_id = device_model.id)
                                                                     ->  Hash Join  (cost=613.00..4033.66 rows=1400 width=171) (actual time=9.220..13.532 rows=1065 loops=1)
                                                                           Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                                           ->  Hash Join  (cost=337.39..3728.30 rows=1400 width=156) (actual time=5.321..8.864 rows=1065 loops=1)
                                                                                 Hash Cond: (installation.project_id = receiver_project.id)
                                                                                 ->  Hash Join  (cost=334.70..3706.36 rows=1400 width=125) (actual time=5.270..8.267 rows=1065 loops=1)
                                                                                       Hash Cond: (installation_station.installation_id = installation.id)
                                                                                       ->  Hash Join  (cost=330.23..3682.64 rows=1400 width=109) (actual time=5.205..7.653 rows=1065 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Hash Join  (cost=260.04..3591.45 rows=1400 width=60) (actual time=4.121..5.938 rows=1065 loops=1)
                                                                                                   Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                                                   ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.030..0.855 rows=1065 loops=1)
                                                                                                         Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                                   ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.073..4.073 rows=5710 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                                                                         ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.504 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=45.64..45.64 rows=1964 width=57) (actual time=1.075..1.075 rows=1964 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 179kB
                                                                                                   ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.004..0.504 rows=1964 loops=1)
                                                                                       ->  Hash  (cost=3.10..3.10 rows=110 width=32) (actual time=0.056..0.056 rows=110 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 8kB
                                                                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.020 rows=110 loops=1)
                                                                                 ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.039..0.039 rows=75 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.016 rows=75 loops=1)
                                                                           ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.889..3.889 rows=7227 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.077 rows=7227 loops=1)
                                                                     ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.008..0.008 rows=16 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                           ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=1)
                                                               ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.791..0.791 rows=1519 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                     ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.457 rows=1519 loops=1)
                                                         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.020 rows=51 loops=1)
                                                   ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.132..0.132 rows=173 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                         ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.086 rows=173 loops=1)
                                             ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.977..2.977 rows=5307 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                                   ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.004..1.378 rows=5307 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.961..1.961 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.893 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.654..2.654 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.500 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.951..1.951 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.842 rows=4023 loops=1)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=1065)
               Index Cond: (animal.species_id = id)
 Total runtime: 37.754 ms
(79 rows)

-- Test Case 14 -  5909 ^ 2153 ^ 1065 -> 55 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=247.55..3985.03 rows=1 width=279) (actual time=10.236..11.077 rows=55 loops=1)
   ->  Nested Loop Left Join  (cost=247.55..3985.03 rows=1 width=279) (actual time=10.234..11.062 rows=55 loops=1)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018003'::text)
         ->  Nested Loop  (cost=247.26..3950.64 rows=6 width=239) (actual time=10.175..10.457 rows=55 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 9460
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.033 rows=173 loops=1)
               ->  Materialize  (cost=247.26..3926.35 rows=6 width=233) (actual time=0.019..0.042 rows=55 loops=173)
                     ->  Nested Loop Left Join  (cost=247.26..3926.32 rows=6 width=233) (actual time=3.345..6.384 rows=55 loops=1)
                           ->  Nested Loop Left Join  (cost=246.98..3894.57 rows=6 width=233) (actual time=3.337..6.207 rows=55 loops=1)
                                 ->  Nested Loop Left Join  (cost=246.70..3861.21 rows=6 width=209) (actual time=3.330..6.016 rows=55 loops=1)
                                       ->  Nested Loop Left Join  (cost=246.42..3829.10 rows=6 width=209) (actual time=3.323..5.835 rows=55 loops=1)
                                             ->  Nested Loop Left Join  (cost=246.14..3812.02 rows=6 width=209) (actual time=3.316..5.667 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=245.86..3778.81 rows=6 width=187) (actual time=3.306..5.420 rows=55 loops=1)
                                                         Join Filter: (receiver.organisation_id = organisation.id)
                                                         Rows Removed by Join Filter: 2750
                                                         ->  Nested Loop  (cost=245.86..3762.64 rows=19 width=168) (actual time=3.284..4.667 rows=55 loops=1)
                                                               ->  Nested Loop  (cost=245.58..3664.56 rows=19 width=168) (actual time=3.277..4.476 rows=55 loops=1)
                                                                     Join Filter: (receiver.model_id = device_model.id)
                                                                     Rows Removed by Join Filter: 825
                                                                     ->  Nested Loop  (cost=245.58..3658.80 rows=19 width=171) (actual time=3.270..4.212 rows=55 loops=1)
                                                                           ->  Hash Join  (cost=245.30..3554.14 rows=19 width=156) (actual time=3.260..4.008 rows=55 loops=1)
                                                                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                                 ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.024..0.641 rows=1065 loops=1)
                                                                                       Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.118..3.118 rows=64 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.204..3.082 rows=64 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.775 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.106..0.106 rows=15 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.061..0.101 rows=15 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.040..0.067 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.015 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.019 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.018..0.026 rows=15 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.012..0.012 rows=15 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..5.50 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=55)
                                                                                 Index Cond: (id = receiver_deployment.receiver_id)
                                                                     ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=55)
                                                                           ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.007 rows=16 loops=1)
                                                               ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..5.15 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=55)
                                                                     Index Cond: (id = valid_detection.receiver_download_id)
                                                         ->  Materialize  (cost=0.00..1.77 rows=51 width=35) (actual time=0.000..0.005 rows=51 loops=55)
                                                               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.017 rows=51 loops=1)
                                                   ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.53 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=55)
                                                         Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                             ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                                   Index Cond: (id = sensor.tag_id)
                                                   Heap Fetches: 0
                                       ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=55)
                                             Index Cond: (tag.id = tag_id)
                                 ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=55)
                                       Index Cond: (surgery.release_id = id)
                           ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=55)
                                 Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=55)
               Index Cond: (animal.species_id = id)
 Total runtime: 11.405 ms
(67 rows)

-- Mixed selectivity filtering
-- Test Case 15 - 5909 ^ 833188 -> 184 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3943.60..133755.52 rows=100 width=279) (actual time=73.699..12902.653 rows=100 loops=1)
   ->  Hash Left Join  (cost=3943.60..1592841.51 rows=1224 width=279) (actual time=73.697..12902.620 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018021'::text)
         Rows Removed by Filter: 3779
         ->  Hash Left Join  (cost=1455.39..1569277.70 rows=244897 width=239) (actual time=18.603..12858.570 rows=3891 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=1334.87..1564871.48 rows=244897 width=239) (actual time=16.509..12854.138 rows=3891 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=1133.67..1560384.59 rows=244897 width=215) (actual time=13.820..12849.037 rows=3891 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=988.41..1553705.90 rows=244897 width=215) (actual time=11.957..12844.981 rows=3891 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=712.80..1548226.23 rows=244897 width=215) (actual time=9.019..12839.611 rows=3891 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=532.39..1539554.49 rows=230185 width=193) (actual time=6.283..12833.997 rows=3891 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=521.50..1536364.70 rows=233880 width=187) (actual time=6.141..12831.905 rows=3891 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=519.35..1531388.23 rows=702807 width=168) (actual time=6.100..12829.889 rows=3891 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=460.17..1521665.45 rows=702807 width=168) (actual time=5.324..12827.083 rows=3891 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=458.81..1512000.50 rows=702807 width=171) (actual time=5.306..12825.045 rows=3891 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Seq Scan on valid_detection  (cost=0.00..1306861.40 rows=52710540 width=52) (actual time=0.003..6775.770 rows=37879359 loops=1)
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.293..5.293 rows=64 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.139..5.256 rows=64 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.946 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.103..3.103 rows=64 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.202..3.070 rows=64 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.754 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.102..0.102 rows=15 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.059..0.096 rows=15 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.035..0.059 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.016 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.018..0.018 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.018 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.021..0.028 rows=15 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.013..0.013 rows=15 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.768..0.768 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.444 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.032..0.032 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.016 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.131..0.131 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.083 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.721..2.721 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.004..1.376 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=2.924..2.924 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.003..1.410 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.852..1.852 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.897 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.677..2.677 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.514 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.072..2.072 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.875 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.049..41.049 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.005..24.210 rows=36587 loops=1)
 Total runtime: 12904.153 ms
(82 rows)

-- Test Case 16 - 5909 ^ 17098775 -> 3889 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                               QUERY PLAN                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=463.19..7470.65 rows=100 width=279) (actual time=3077.745..3086.795 rows=100 loops=1)
   ->  Nested Loop Left Join  (cost=463.19..5256616.62 rows=75008 width=279) (actual time=3077.744..3086.770 rows=100 loops=1)
         ->  Nested Loop Left Join  (cost=462.90..4825177.33 rows=75008 width=239) (actual time=3077.675..3085.666 rows=100 loops=1)
               ->  Nested Loop  (cost=461.50..3093409.68 rows=70502 width=193) (actual time=3077.596..3083.690 rows=100 loops=1)
                     Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
                     Rows Removed by Join Filter: 17190
                     ->  Nested Loop  (cost=461.50..2907510.29 rows=71634 width=187) (actual time=3077.450..3079.402 rows=100 loops=1)
                           Join Filter: (receiver.organisation_id = organisation.id)
                           Rows Removed by Join Filter: 4971
                           ->  Nested Loop  (cost=461.50..2742836.28 rows=215258 width=168) (actual time=3077.417..3078.066 rows=100 loops=1)
                                 ->  Hash Join  (cost=461.22..1633565.49 rows=215258 width=168) (actual time=3077.348..3077.545 rows=100 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Seq Scan on valid_detection  (cost=0.00..1570414.10 rows=16144362 width=52) (actual time=2.516..2655.699 rows=3301165 loops=1)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 4938457
                                       ->  Hash  (cost=460.27..460.27 rows=76 width=132) (actual time=5.450..5.450 rows=64 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                             ->  Hash Join  (cost=246.09..460.27 rows=76 width=132) (actual time=3.138..5.407 rows=64 loops=1)
                                                   Hash Cond: (receiver.model_id = device_model.id)
                                                   ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.114..5.353 rows=64 loops=1)
                                                         Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                         ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.946 rows=7227 loops=1)
                                                         ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.075..3.075 rows=64 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                               ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.214..3.050 rows=64 loops=1)
                                                                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                     ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.692 rows=5710 loops=1)
                                                                     ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.113..0.113 rows=15 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                           ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.069..0.103 rows=15 loops=1)
                                                                                 ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.037..0.061 rows=1 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.001..0.015 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.017..0.017 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.016 rows=1 loops=1)
                                                                                                   Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                   Rows Removed by Filter: 74
                                                                                 ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.028..0.035 rows=15 loops=1)
                                                                                       Recheck Cond: (installation_id = installation.id)
                                                                                       ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.018..0.018 rows=15 loops=1)
                                                                                             Index Cond: (installation_id = installation.id)
                                                   ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.014..0.014 rows=16 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.006 rows=16 loops=1)
                                 ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..5.14 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=100)
                                       Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Materialize  (cost=0.00..1.77 rows=51 width=35) (actual time=0.000..0.005 rows=51 loops=100)
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.024 rows=51 loops=1)
                     ->  Materialize  (cost=0.00..9.60 rows=173 width=22) (actual time=0.000..0.016 rows=173 loops=100)
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.092 rows=173 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..24.55 rows=1 width=46) (actual time=0.016..0.019 rows=1 loops=100)
                     ->  Nested Loop Left Join  (cost=1.12..19.26 rows=1 width=46) (actual time=0.013..0.015 rows=1 loops=100)
                           ->  Nested Loop Left Join  (cost=0.84..13.70 rows=1 width=22) (actual time=0.010..0.012 rows=1 loops=100)
                                 ->  Nested Loop Left Join  (cost=0.56..8.35 rows=1 width=22) (actual time=0.007..0.008 rows=1 loops=100)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.50 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=100)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=98)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=98)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=98)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=98)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=100)
               Index Cond: (animal.species_id = id)
 Total runtime: 3087.111 ms
(69 rows)

-- Test Case 17 - 2716283 ^ 464 -> 448 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3943.60..133755.52 rows=100 width=279) (actual time=35500.893..35502.923 rows=100 loops=1)
   ->  Hash Left Join  (cost=3943.60..1592841.51 rows=1224 width=279) (actual time=35500.891..35502.898 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37346004'::text)
         Rows Removed by Filter: 2714033
         ->  Hash Left Join  (cost=1455.39..1569277.70 rows=244897 width=239) (actual time=4092.527..34002.206 rows=2716283 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=1334.87..1564871.48 rows=244897 width=239) (actual time=4090.502..32487.658 rows=2716283 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=1133.67..1560384.59 rows=244897 width=215) (actual time=4087.831..30877.338 rows=2716283 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=988.41..1553705.90 rows=244897 width=215) (actual time=4085.910..29357.105 rows=2711481 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=712.80..1548226.23 rows=244897 width=215) (actual time=4082.816..27690.575 rows=2711481 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=532.39..1539554.49 rows=230185 width=193) (actual time=4080.078..25798.771 rows=2710212 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=521.50..1536364.70 rows=233880 width=187) (actual time=4079.920..24440.038 rows=2710212 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=519.35..1531388.23 rows=702807 width=168) (actual time=4079.873..23100.435 rows=2710212 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=460.17..1521665.45 rows=702807 width=168) (actual time=4079.085..21662.256 rows=2710212 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=458.81..1512000.50 rows=702807 width=171) (actual time=4079.063..20304.518 rows=2710212 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Seq Scan on valid_detection  (cost=0.00..1306861.40 rows=52710540 width=52) (actual time=0.003..9684.120 rows=53115950 loops=1)
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.875..5.875 rows=282 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 43kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.401..5.715 rows=282 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.968 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.388..3.388 rows=282 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.198..3.236 rows=282 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.783 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.148..0.148 rows=45 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.069..0.126 rows=45 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.037..0.062 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.014 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.018..0.018 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.018 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.028..0.045 rows=45 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.019..0.019 rows=45 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.010..0.010 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.008 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.778..0.778 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.462 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.037..0.037 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.016 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.142..0.142 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.088 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.719..2.719 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.006..1.401 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.083..3.083 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.532 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.909..1.909 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.905 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.662..2.662 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.514 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.014..2.014 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.852 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.430..41.430 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.004..24.613 rows=36587 loops=1)
 Total runtime: 35505.186 ms
(82 rows)

-- Test Case 18 - 2716283 ^ 2005 -> 4 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2013-06-08 00:00:00+00' and '2013-06-08 01:00:00+00'
limit 100;
                                                                                                                              QUERY PLAN                                                                                                                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=306.45..4504.01 rows=7 width=279) (actual time=7.218..7.392 rows=4 loops=1)
   ->  Nested Loop Left Join  (cost=306.45..4504.01 rows=7 width=279) (actual time=7.217..7.391 rows=4 loops=1)
         ->  Nested Loop Left Join  (cost=306.16..4463.74 rows=7 width=239) (actual time=7.156..7.298 rows=4 loops=1)
               ->  Nested Loop Left Join  (cost=305.88..4426.70 rows=7 width=239) (actual time=7.146..7.276 rows=4 loops=1)
                     ->  Nested Loop Left Join  (cost=305.60..4387.78 rows=7 width=215) (actual time=7.137..7.257 rows=4 loops=1)
                           ->  Nested Loop Left Join  (cost=305.32..4350.31 rows=7 width=215) (actual time=7.127..7.236 rows=4 loops=1)
                                 ->  Nested Loop Left Join  (cost=305.04..4330.39 rows=7 width=215) (actual time=7.118..7.218 rows=4 loops=1)
                                       ->  Nested Loop  (cost=304.76..4291.65 rows=7 width=193) (actual time=7.104..7.184 rows=4 loops=1)
                                             Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
                                             Rows Removed by Join Filter: 688
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.026 rows=173 loops=1)
                                             ->  Materialize  (cost=304.76..4264.77 rows=7 width=187) (actual time=0.039..0.040 rows=4 loops=173)
                                                   ->  Nested Loop  (cost=304.76..4264.74 rows=7 width=187) (actual time=6.730..6.794 rows=4 loops=1)
                                                         Join Filter: (receiver.organisation_id = organisation.id)
                                                         Rows Removed by Join Filter: 200
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.006 rows=51 loops=1)
                                                         ->  Materialize  (cost=304.76..4246.45 rows=22 width=168) (actual time=0.120..0.131 rows=4 loops=51)
                                                               ->  Hash Join  (cost=304.76..4246.34 rows=22 width=168) (actual time=6.116..6.674 rows=4 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                                     ->  Nested Loop  (cost=245.58..4186.86 rows=22 width=168) (actual time=5.291..5.848 rows=4 loops=1)
                                                                           Join Filter: (receiver.model_id = device_model.id)
                                                                           Rows Removed by Join Filter: 60
                                                                           ->  Nested Loop  (cost=245.58..4180.38 rows=22 width=171) (actual time=5.280..5.812 rows=4 loops=1)
                                                                                 ->  Hash Join  (cost=245.30..4059.20 rows=22 width=156) (actual time=5.264..5.782 rows=4 loops=1)
                                                                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                                       ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3808.21 rows=1613 width=52) (actual time=0.104..2.065 rows=1839 loops=1)
                                                                                             Index Cond: (("timestamp" >= '2013-06-08 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-06-08 01:00:00+00'::timestamp with time zone))
                                                                                       ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.341..3.341 rows=282 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                             ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.189..3.212 rows=282 loops=1)
                                                                                                   Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.715 rows=5710 loops=1)
                                                                                                   ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.158..0.158 rows=45 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                                         ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.084..0.141 rows=45 loops=1)
                                                                                                               ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.057..0.082 rows=1 loops=1)
                                                                                                                     Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                                                                                                     ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.039..0.039 rows=1 loops=1)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                           ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.018..0.037 rows=1 loops=1)
                                                                                                                                 Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                                                 Rows Removed by Filter: 74
                                                                                                               ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.024..0.039 rows=45 loops=1)
                                                                                                                     Recheck Cond: (installation_id = installation.id)
                                                                                                                     ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.015..0.015 rows=45 loops=1)
                                                                                                                           Index Cond: (installation_id = installation.id)
                                                                                 ->  Index Scan using device_pkey on device receiver  (cost=0.28..5.50 rows=1 width=31) (actual time=0.005..0.005 rows=1 loops=4)
                                                                                       Index Cond: (id = receiver_deployment.receiver_id)
                                                                           ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=4)
                                                                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.008 rows=16 loops=1)
                                                                     ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.811..0.811 rows=1519 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.489 rows=1519 loops=1)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.53 rows=1 width=22) (actual time=0.006..0.006 rows=1 loops=4)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=4)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=4)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.003..0.003 rows=1 loops=4)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=4)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=4)
               Index Cond: (animal.species_id = id)
 Total runtime: 7.711 ms
(68 rows)

-- Test Case 19 - 464 ^ 17098775 -> 6 rows
explain analyze select * from detection_extract_test_view
where spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=348654.03..357276.65 rows=100 width=279) (actual time=68670.726..68849.801 rows=6 loops=1)
   ->  Hash Left Join  (cost=348654.03..2774024.89 rows=28128 width=279) (actual time=68670.723..68849.797 rows=6 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37346004'::text)
         Rows Removed by Filter: 17098769
         ->  Hash Left Join  (cost=346165.82..2295305.48 rows=5625584 width=239) (actual time=3105.977..59349.133 rows=17098775 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=344912.31..2098995.76 rows=5287633 width=193) (actual time=3082.540..47909.908 rows=16316319 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=344901.41..2025961.60 rows=5372518 width=187) (actual time=3082.392..40411.897 rows=16316319 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=344899.27..1911692.91 rows=16144362 width=168) (actual time=3082.347..32816.808 rows=16316319 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=344840.09..1689648.76 rows=16144362 width=168) (actual time=3081.576..25399.927 rows=16316319 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=343912.28..1365833.71 rows=16144362 width=52) (actual time=3059.694..13244.284 rows=16316319 loops=1)
                                             Recheck Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Index Recheck: 501034
                                             ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..339876.18 rows=16144362 width=0) (actual time=3058.257..3058.257 rows=16316319 loops=1)
                                                   Index Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                       ->  Hash  (cost=856.44..856.44 rows=5710 width=132) (actual time=21.859..21.859 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 969kB
                                             ->  Hash Join  (cost=382.84..856.44 rows=5710 width=132) (actual time=6.248..17.899 rows=5710 loops=1)
                                                   Hash Cond: (receiver.model_id = device_model.id)
                                                   ->  Hash Join  (cost=381.48..776.56 rows=5710 width=135) (actual time=6.231..15.436 rows=5710 loops=1)
                                                         Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                         ->  Hash Join  (cost=105.87..379.62 rows=5710 width=120) (actual time=2.245..8.218 rows=5710 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.001..0.858 rows=5710 loops=1)
                                                               ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.235..2.235 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 280kB
                                                                     ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.156..1.391 rows=1964 loops=1)
                                                                           Hash Cond: (installation_station.installation_id = installation.id)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.305 rows=1964 loops=1)
                                                                           ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.146..0.146 rows=110 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                                                 ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.050..0.108 rows=110 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.038..0.038 rows=75 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.016 rows=75 loops=1)
                                                         ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.973..3.973 rows=7227 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                               ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.003..2.095 rows=7227 loops=1)
                                                   ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.008..0.008 rows=16 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=1)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.756..0.756 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.397 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.020 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.131..0.131 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.085 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=23.399..23.399 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=13.506..21.091 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.701..9.863 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.754..5.928 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.585 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.715..2.715 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.005..1.529 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.925..1.925 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.818 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=8.785..8.785 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.461..7.283 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.007..0.648 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.428..3.428 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.484 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.307..41.307 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..24.208 rows=36587 loops=1)
 Total runtime: 68850.138 ms
(84 rows)

-- Test Case 20 - 833188 ^ 5489 -> 210 rows
explain analyze select * from detection_extract_test_view
where spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 100;
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4097.78..16057.70 rows=8 width=279) (actual time=65.669..102.697 rows=100 loops=1)
   ->  Hash Left Join  (cost=4097.78..16057.70 rows=8 width=279) (actual time=65.668..102.663 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018021'::text)
         Rows Removed by Filter: 2432
         ->  Hash Left Join  (cost=1609.58..13075.53 rows=1587 width=239) (actual time=23.905..57.571 rows=3468 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=1489.06..12927.24 rows=1587 width=239) (actual time=21.869..53.115 rows=3468 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=1287.86..12698.27 rows=1587 width=215) (actual time=19.148..48.041 rows=3468 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=1142.59..12510.67 rows=1587 width=215) (actual time=17.142..43.811 rows=3357 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=866.99..12201.34 rows=1587 width=215) (actual time=13.667..37.776 rows=3357 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=686.58..11965.89 rows=1492 width=193) (actual time=10.667..31.957 rows=3143 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=675.68..11934.41 rows=1515 width=187) (actual time=10.515..30.096 rows=3143 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=673.54..11900.04 rows=4554 width=168) (actual time=10.471..28.374 rows=3143 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=614.36..11778.24 rows=4554 width=168) (actual time=9.714..25.767 rows=3143 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=613.00..11714.26 rows=4554 width=171) (actual time=9.692..24.100 rows=3143 loops=1)
                                                                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                                     ->  Hash Join  (cost=337.39..11341.88 rows=4554 width=156) (actual time=5.706..17.741 rows=3143 loops=1)
                                                                           Hash Cond: (installation.project_id = receiver_project.id)
                                                                           ->  Hash Join  (cost=334.70..11276.58 rows=4554 width=125) (actual time=5.652..15.824 rows=3143 loops=1)
                                                                                 Hash Cond: (installation_station.installation_id = installation.id)
                                                                                 ->  Hash Join  (cost=330.23..11209.49 rows=4554 width=109) (actual time=5.568..14.016 rows=3143 loops=1)
                                                                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                       ->  Hash Join  (cost=260.04..11070.99 rows=4554 width=60) (actual time=4.395..10.830 rows=3143 loops=1)
                                                                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                                             ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..10720.43 rows=4554 width=52) (actual time=0.075..3.564 rows=3143 loops=1)
                                                                                                   Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.292..4.292 rows=5710 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.551 rows=5710 loops=1)
                                                                                       ->  Hash  (cost=45.64..45.64 rows=1964 width=57) (actual time=1.159..1.159 rows=1964 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 179kB
                                                                                             ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.004..0.542 rows=1964 loops=1)
                                                                                 ->  Hash  (cost=3.10..3.10 rows=110 width=32) (actual time=0.072..0.072 rows=110 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 8kB
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.015..0.037 rows=110 loops=1)
                                                                           ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.040..0.040 rows=75 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                 ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.004..0.022 rows=75 loops=1)
                                                                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.974..3.974 rows=7227 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.129 rows=7227 loops=1)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.007 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.746..0.746 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.421 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.019 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.137..0.137 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.090 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.981..2.981 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.004..1.390 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.458..3.458 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.474 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.988..1.988 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.909 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.706..2.706 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.537 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.020..2.020 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.861 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.201..41.201 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.005..24.164 rows=36587 loops=1)
 Total runtime: 104.400 ms
(81 rows)

-- Test Case 21 - 5909 ^ 2153 ^ 17098775 -> 284 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=347855.87..643470.25 rows=100 width=279) (actual time=9092.127..9095.446 rows=100 loops=1)
   ->  Hash Left Join  (cost=347855.87..1456409.78 rows=375 width=279) (actual time=9092.125..9095.417 rows=100 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018003'::text)
         Rows Removed by Filter: 1601
         ->  Hash Left Join  (cost=345367.67..1447217.10 rows=75008 width=239) (actual time=6288.907..9052.464 rows=1723 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=345247.15..1445783.94 rows=75008 width=239) (actual time=6286.862..9049.400 rows=1723 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=345045.95..1444270.10 rows=75008 width=215) (actual time=6284.155..9045.624 rows=1723 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=344900.68..1442123.76 rows=75008 width=215) (actual time=6282.113..9042.535 rows=1723 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=344625.07..1440254.23 rows=75008 width=215) (actual time=6278.670..9037.930 rows=1723 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=344444.67..1437473.06 rows=70502 width=193) (actual time=6275.765..9033.687 rows=1688 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=344433.77..1436488.52 rows=71634 width=187) (actual time=6275.616..9032.617 rows=1688 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=344431.63..1434962.82 rows=215258 width=168) (actual time=6275.573..9031.719 rows=1688 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=344372.45..1431943.84 rows=215258 width=168) (actual time=6274.796..9030.073 rows=1688 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=344371.09..1428982.69 rows=215258 width=171) (actual time=6274.777..9029.096 rows=1688 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=343912.28..1365833.71 rows=16144362 width=52) (actual time=3361.623..7852.763 rows=8995312 loops=1)
                                                                           Recheck Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                           Rows Removed by Index Recheck: 483609
                                                                           ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..339876.18 rows=16144362 width=0) (actual time=3360.103..3360.103 rows=16316319 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.298..5.298 rows=64 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.185..5.257 rows=64 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.929 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.148..3.148 rows=64 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.204..3.118 rows=64 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.001..0.743 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.105..0.105 rows=15 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.063..0.097 rows=15 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.037..0.061 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.014 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.019..0.019 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.018 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.021..0.028 rows=15 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.014..0.014 rows=15 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.768..0.768 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.391 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.018 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.135..0.135 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.090 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.878..2.878 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.008..1.331 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.424..3.424 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.507 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=2.018..2.018 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.917 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.686..2.686 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.512 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.025..2.025 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.865 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.259..41.259 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.005..24.070 rows=36587 loops=1)
 Total runtime: 9097.008 ms
(86 rows)

-- Test Case 22 - 5909 ^ 833188 ^ 5489 -> 13 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 100;
                                                                                                                  QUERY PLAN                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=520.25..11993.47 rows=1 width=279) (actual time=12.791..13.233 rows=13 loops=1)
   ->  Nested Loop Left Join  (cost=520.25..11993.47 rows=1 width=279) (actual time=12.789..13.226 rows=13 loops=1)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018021'::text)
         ->  Nested Loop Left Join  (cost=519.96..11873.17 rows=21 width=239) (actual time=12.703..13.014 rows=13 loops=1)
               ->  Nested Loop  (cost=518.56..11381.77 rows=20 width=193) (actual time=12.557..12.630 rows=13 loops=1)
                     Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
                     Rows Removed by Join Filter: 2236
                     ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.081 rows=173 loops=1)
                     ->  Materialize  (cost=518.56..11321.19 rows=20 width=187) (actual time=0.043..0.068 rows=13 loops=173)
                           ->  Nested Loop  (cost=518.56..11321.09 rows=20 width=187) (actual time=7.407..11.543 rows=13 loops=1)
                                 Join Filter: (receiver.organisation_id = organisation.id)
                                 Rows Removed by Join Filter: 650
                                 ->  Hash Join  (cost=518.56..11272.79 rows=61 width=168) (actual time=7.383..11.343 rows=13 loops=1)
                                       Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                       ->  Nested Loop  (cost=459.38..11212.77 rows=61 width=168) (actual time=6.506..10.459 rows=13 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 195
                                             ->  Hash Join  (cost=459.38..11196.93 rows=61 width=171) (actual time=6.495..10.382 rows=13 loops=1)
                                                   Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                   ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..10720.43 rows=4554 width=52) (actual time=0.064..3.447 rows=5041 loops=1)
                                                         Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                   ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=6.012..6.012 rows=64 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                         ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.828..5.974 rows=64 loops=1)
                                                               Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                               ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.923 rows=7227 loops=1)
                                                               ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.785..3.785 rows=64 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                     ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.232..3.749 rows=64 loops=1)
                                                                           Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                           ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..1.715 rows=5710 loops=1)
                                                                           ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.116..0.116 rows=15 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.061..0.109 rows=15 loops=1)
                                                                                       ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.038..0.063 rows=1 loops=1)
                                                                                             Hash Cond: (installation.project_id = receiver_project.id)
                                                                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.013 rows=110 loops=1)
                                                                                             ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.019..0.019 rows=1 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.018 rows=1 loops=1)
                                                                                                         Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                         Rows Removed by Filter: 74
                                                                                       ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.020..0.038 rows=15 loops=1)
                                                                                             Recheck Cond: (installation_id = installation.id)
                                                                                             ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.012..0.012 rows=15 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=13)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.006 rows=16 loops=1)
                                       ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.863..0.863 rows=1519 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                             ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.514 rows=1519 loops=1)
                                 ->  Materialize  (cost=0.00..1.77 rows=51 width=35) (actual time=0.000..0.007 rows=51 loops=13)
                                       ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.003..0.022 rows=51 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..24.56 rows=1 width=46) (actual time=0.026..0.028 rows=1 loops=13)
                     ->  Nested Loop Left Join  (cost=1.12..19.27 rows=1 width=46) (actual time=0.021..0.023 rows=1 loops=13)
                           ->  Nested Loop Left Join  (cost=0.84..13.71 rows=1 width=22) (actual time=0.016..0.018 rows=1 loops=13)
                                 ->  Nested Loop Left Join  (cost=0.56..8.36 rows=1 width=22) (actual time=0.012..0.013 rows=1 loops=13)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.51 rows=1 width=22) (actual time=0.006..0.006 rows=1 loops=13)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=13)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=13)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.003..0.004 rows=1 loops=13)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=13)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.004..0.004 rows=1 loops=13)
               Index Cond: (animal.species_id = id)
 Total runtime: 13.543 ms
(71 rows)

-- Test Case 23 - 5909 ^ 833188 ^ 17098775 -> 54 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=347855.87..643470.25 rows=100 width=279) (actual time=6329.261..13621.759 rows=54 loops=1)
   ->  Hash Left Join  (cost=347855.87..1456409.78 rows=375 width=279) (actual time=6329.260..13621.745 rows=54 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018021'::text)
         Rows Removed by Filter: 3835
         ->  Hash Left Join  (cost=345367.67..1447217.10 rows=75008 width=239) (actual time=6280.928..13569.745 rows=3889 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=345247.15..1445783.94 rows=75008 width=239) (actual time=6278.664..13565.088 rows=3889 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=345045.95..1444270.10 rows=75008 width=215) (actual time=6275.423..13559.370 rows=3889 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=344900.68..1442123.76 rows=75008 width=215) (actual time=6273.013..13554.615 rows=3889 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=344625.07..1440254.23 rows=75008 width=215) (actual time=6269.841..13548.867 rows=3889 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=344444.67..1437473.06 rows=70502 width=193) (actual time=6266.680..13542.722 rows=3854 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=344433.77..1436488.52 rows=71634 width=187) (actual time=6266.531..13540.509 rows=3854 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=344431.63..1434962.82 rows=215258 width=168) (actual time=6266.488..13538.436 rows=3854 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=344372.45..1431943.84 rows=215258 width=168) (actual time=6265.672..13535.531 rows=3854 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=344371.09..1428982.69 rows=215258 width=171) (actual time=6265.652..13533.398 rows=3854 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=343912.28..1365833.71 rows=16144362 width=52) (actual time=3359.803..11403.867 rows=16316319 loops=1)
                                                                           Recheck Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                           Rows Removed by Index Recheck: 501034
                                                                           ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..339876.18 rows=16144362 width=0) (actual time=3358.289..3358.289 rows=16316319 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.307..5.307 rows=64 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.161..5.273 rows=64 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.941 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.124..3.124 rows=64 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.205..3.091 rows=64 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.001..0.798 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.105..0.105 rows=15 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.062..0.099 rows=15 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.036..0.061 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.013 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.019..0.019 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.017 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.022..0.030 rows=15 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.013..0.013 rows=15 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.010..0.010 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.806..0.806 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.457 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.017 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.136..0.136 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.094 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=3.133..3.133 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.020..1.750 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.151..3.151 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.461 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=2.387..2.387 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.019..1.304 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=3.213..3.213 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.014..1.900 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.237..2.237 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..1.049 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=46.239..46.239 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.016..28.218 rows=36587 loops=1)
 Total runtime: 13622.092 ms
(86 rows)

-- Test Case 24 - 2716283 ^ 464 ^ 3129 -> 2 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 100;
                                                                                                                  QUERY PLAN                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=306.45..6075.51 rows=1 width=279) (actual time=15.233..16.727 rows=2 loops=1)
   ->  Nested Loop Left Join  (cost=306.45..6075.51 rows=1 width=279) (actual time=15.231..16.722 rows=2 loops=1)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37346004'::text)
         Rows Removed by Filter: 68
         ->  Nested Loop Left Join  (cost=306.16..6012.49 rows=11 width=239) (actual time=13.808..16.335 rows=70 loops=1)
               ->  Nested Loop  (cost=304.76..5766.71 rows=10 width=193) (actual time=13.663..14.740 rows=69 loops=1)
                     Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
                     Rows Removed by Join Filter: 11868
                     ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.079 rows=173 loops=1)
                     ->  Materialize  (cost=304.76..5732.05 rows=10 width=187) (actual time=0.052..0.063 rows=69 loops=173)
                           ->  Nested Loop  (cost=304.76..5732.00 rows=10 width=187) (actual time=8.979..9.783 rows=69 loops=1)
                                 Join Filter: (receiver.organisation_id = organisation.id)
                                 Rows Removed by Join Filter: 3450
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.008 rows=51 loops=1)
                                 ->  Materialize  (cost=304.76..5707.62 rows=30 width=168) (actual time=0.100..0.171 rows=69 loops=51)
                                       ->  Hash Join  (cost=304.76..5707.47 rows=30 width=168) (actual time=5.076..8.365 rows=69 loops=1)
                                             Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                             ->  Nested Loop  (cost=245.58..5647.88 rows=30 width=168) (actual time=4.205..7.451 rows=69 loops=1)
                                                   Join Filter: (receiver.model_id = device_model.id)
                                                   Rows Removed by Join Filter: 1035
                                                   ->  Nested Loop  (cost=245.58..5639.48 rows=30 width=171) (actual time=4.195..7.120 rows=69 loops=1)
                                                         ->  Hash Join  (cost=245.30..5474.23 rows=30 width=156) (actual time=4.178..6.828 rows=69 loops=1)
                                                               Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.073..2.191 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=4.062..4.062 rows=282 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                     ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.224..3.930 rows=282 loops=1)
                                                                           Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                           ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..1.720 rows=5710 loops=1)
                                                                           ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.192..0.192 rows=45 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                 ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.072..0.173 rows=45 loops=1)
                                                                                       ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.038..0.063 rows=1 loops=1)
                                                                                             Hash Cond: (installation.project_id = receiver_project.id)
                                                                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                                                             ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.020..0.020 rows=1 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.009..0.019 rows=1 loops=1)
                                                                                                         Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                         Rows Removed by Filter: 74
                                                                                       ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.031..0.092 rows=45 loops=1)
                                                                                             Recheck Cond: (installation_id = installation.id)
                                                                                             ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.016..0.016 rows=45 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using device_pkey on device receiver  (cost=0.28..5.50 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=69)
                                                               Index Cond: (id = receiver_deployment.receiver_id)
                                                   ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=69)
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=1)
                                             ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.859..0.859 rows=1519 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.522 rows=1519 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..24.57 rows=1 width=46) (actual time=0.019..0.022 rows=1 loops=69)
                     ->  Nested Loop Left Join  (cost=1.12..19.28 rows=1 width=46) (actual time=0.015..0.018 rows=1 loops=69)
                           ->  Nested Loop Left Join  (cost=0.84..13.72 rows=1 width=22) (actual time=0.011..0.013 rows=1 loops=69)
                                 ->  Nested Loop Left Join  (cost=0.56..8.36 rows=1 width=22) (actual time=0.008..0.009 rows=1 loops=69)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.52 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=69)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=70)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=70)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.003..0.003 rows=1 loops=70)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=70)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=70)
               Index Cond: (animal.species_id = id)
 Total runtime: 17.041 ms
(70 rows)

-- Test Case 25 - 2716283 ^ 464 ^ 17098775 -> 4 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 100;
                                                                                                                           QUERY PLAN                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=347855.87..643470.25 rows=100 width=279) (actual time=19923.164..19923.882 rows=4 loops=1)
   ->  Hash Left Join  (cost=347855.87..1456409.78 rows=375 width=279) (actual time=19923.161..19923.876 rows=4 loops=1)
         Hash Cond: (animal.species_id = species.id)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37346004'::text)
         Rows Removed by Filter: 902902
         ->  Hash Left Join  (cost=345367.67..1447217.10 rows=75008 width=239) (actual time=3382.135..19330.005 rows=902906 loops=1)
               Hash Cond: (animal_release.animal_id = animal.id)
               ->  Hash Left Join  (cost=345247.15..1445783.94 rows=75008 width=239) (actual time=3379.879..18762.753 rows=902906 loops=1)
                     Hash Cond: (surgery.release_id = animal_release.id)
                     ->  Hash Left Join  (cost=345045.95..1444270.10 rows=75008 width=215) (actual time=3376.639..18149.870 rows=902906 loops=1)
                           Hash Cond: (tag.id = surgery.tag_id)
                           ->  Hash Left Join  (cost=344900.68..1442123.76 rows=75008 width=215) (actual time=3374.274..17585.187 rows=902838 loops=1)
                                 Hash Cond: (sensor.tag_id = tag.id)
                                 ->  Hash Left Join  (cost=344625.07..1440254.23 rows=75008 width=215) (actual time=3370.995..16957.788 rows=902838 loops=1)
                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash Join  (cost=344444.67..1437473.06 rows=70502 width=193) (actual time=3367.907..16242.898 rows=902521 loops=1)
                                             Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                             ->  Hash Join  (cost=344433.77..1436488.52 rows=71634 width=187) (actual time=3367.758..15760.039 rows=902521 loops=1)
                                                   Hash Cond: (receiver.organisation_id = organisation.id)
                                                   ->  Hash Join  (cost=344431.63..1434962.82 rows=215258 width=168) (actual time=3367.717..15299.254 rows=902521 loops=1)
                                                         Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                         ->  Hash Join  (cost=344372.45..1431943.84 rows=215258 width=168) (actual time=3366.944..14789.307 rows=902521 loops=1)
                                                               Hash Cond: (receiver.model_id = device_model.id)
                                                               ->  Hash Join  (cost=344371.09..1428982.69 rows=215258 width=171) (actual time=3366.925..14324.967 rows=902521 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=343912.28..1365833.71 rows=16144362 width=52) (actual time=3360.233..11558.747 rows=16316319 loops=1)
                                                                           Recheck Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                           Rows Removed by Index Recheck: 501034
                                                                           ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..339876.18 rows=16144362 width=0) (actual time=3358.686..3358.686 rows=16316319 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                                     ->  Hash  (cost=457.86..457.86 rows=76 width=135) (actual time=5.825..5.825 rows=282 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 43kB
                                                                           ->  Hash Join  (cost=244.73..457.86 rows=76 width=135) (actual time=3.413..5.679 rows=282 loops=1)
                                                                                 Hash Cond: (receiver.id = receiver_deployment.receiver_id)
                                                                                 ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.862 rows=7227 loops=1)
                                                                                 ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=3.402..3.402 rows=282 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                       ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.173..3.264 rows=282 loops=1)
                                                                                             Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.798 rows=5710 loops=1)
                                                                                             ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.142..0.142 rows=45 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                                   ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.067..0.123 rows=45 loops=1)
                                                                                                         ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.036..0.061 rows=1 loops=1)
                                                                                                               Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                               ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                                                                                               ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.019..0.019 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.019 rows=1 loops=1)
                                                                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                                           Rows Removed by Filter: 74
                                                                                                         ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.027..0.045 rows=45 loops=1)
                                                                                                               Recheck Cond: (installation_id = installation.id)
                                                                                                               ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.018..0.018 rows=45 loops=1)
                                                                                                                     Index Cond: (installation_id = installation.id)
                                                               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
                                                         ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.762..0.762 rows=1519 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                               ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.430 rows=1519 loops=1)
                                                   ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.020 rows=51 loops=1)
                                             ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.136..0.136 rows=173 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                   ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.093 rows=173 loops=1)
                                       ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=3.063..3.063 rows=5307 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                             ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.017..1.733 rows=5307 loops=1)
                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.257..3.257 rows=7227 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                       ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.536 rows=7227 loops=1)
                           ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=2.340..2.340 rows=3923 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.020..1.228 rows=3923 loops=1)
                     ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=3.210..3.210 rows=3920 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 241kB
                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.015..2.009 rows=3920 loops=1)
               ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.226..2.226 rows=4023 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 189kB
                     ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..1.051 rows=4023 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=46.123..46.123 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.015..28.048 rows=36587 loops=1)
 Total runtime: 19924.203 ms
(86 rows)

-- Test Case 26 - 2716283 ^ 3913743 ^ 3129 -> 52 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 100;
                                                                                                                  QUERY PLAN                                                                                                                   
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=306.45..6075.51 rows=1 width=279) (actual time=13.454..16.508 rows=52 loops=1)
   ->  Nested Loop Left Join  (cost=306.45..6075.51 rows=1 width=279) (actual time=13.453..16.496 rows=52 loops=1)
         Filter: ((COALESCE(species.spcode, ''::character varying))::text = '37018030'::text)
         Rows Removed by Filter: 18
         ->  Nested Loop Left Join  (cost=306.16..6012.49 rows=11 width=239) (actual time=13.258..15.793 rows=70 loops=1)
               ->  Nested Loop  (cost=304.76..5766.71 rows=10 width=193) (actual time=13.195..14.250 rows=69 loops=1)
                     Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
                     Rows Removed by Join Filter: 11868
                     ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.004..0.085 rows=173 loops=1)
                     ->  Materialize  (cost=304.76..5732.05 rows=10 width=187) (actual time=0.050..0.061 rows=69 loops=173)
                           ->  Nested Loop  (cost=304.76..5732.00 rows=10 width=187) (actual time=8.586..9.392 rows=69 loops=1)
                                 Join Filter: (receiver.organisation_id = organisation.id)
                                 Rows Removed by Join Filter: 3450
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.005 rows=51 loops=1)
                                 ->  Materialize  (cost=304.76..5707.62 rows=30 width=168) (actual time=0.099..0.164 rows=69 loops=51)
                                       ->  Hash Join  (cost=304.76..5707.47 rows=30 width=168) (actual time=5.052..7.977 rows=69 loops=1)
                                             Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                             ->  Nested Loop  (cost=245.58..5647.88 rows=30 width=168) (actual time=4.178..7.051 rows=69 loops=1)
                                                   Join Filter: (receiver.model_id = device_model.id)
                                                   Rows Removed by Join Filter: 1035
                                                   ->  Nested Loop  (cost=245.58..5639.48 rows=30 width=171) (actual time=4.167..6.720 rows=69 loops=1)
                                                         ->  Hash Join  (cost=245.30..5474.23 rows=30 width=156) (actual time=4.151..6.447 rows=69 loops=1)
                                                               Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.073..1.818 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=243.78..243.78 rows=76 width=120) (actual time=4.053..4.053 rows=282 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                     ->  Hash Join  (cost=33.51..243.78 rows=76 width=120) (actual time=0.224..3.921 rows=282 loops=1)
                                                                           Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                           ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..1.724 rows=5710 loops=1)
                                                                           ->  Hash  (cost=33.18..33.18 rows=26 width=104) (actual time=0.191..0.191 rows=45 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                 ->  Nested Loop  (cost=4.81..33.18 rows=26 width=104) (actual time=0.072..0.168 rows=45 loops=1)
                                                                                       ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.038..0.063 rows=1 loops=1)
                                                                                             Hash Cond: (installation.project_id = receiver_project.id)
                                                                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.019 rows=110 loops=1)
                                                                                             ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.020..0.020 rows=1 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.009..0.019 rows=1 loops=1)
                                                                                                         Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                         Rows Removed by Filter: 74
                                                                                       ->  Bitmap Heap Scan on installation_station  (cost=2.86..27.52 rows=19 width=57) (actual time=0.031..0.092 rows=45 loops=1)
                                                                                             Recheck Cond: (installation_id = installation.id)
                                                                                             ->  Bitmap Index Scan on installation_station_installation_id_index  (cost=0.00..2.86 rows=19 width=0) (actual time=0.015..0.015 rows=45 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using device_pkey on device receiver  (cost=0.28..5.50 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=69)
                                                               Index Cond: (id = receiver_deployment.receiver_id)
                                                   ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=69)
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.008 rows=16 loops=1)
                                             ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.858..0.858 rows=1519 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                   ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.517 rows=1519 loops=1)
               ->  Nested Loop Left Join  (cost=1.41..24.57 rows=1 width=46) (actual time=0.018..0.021 rows=1 loops=69)
                     ->  Nested Loop Left Join  (cost=1.12..19.28 rows=1 width=46) (actual time=0.015..0.017 rows=1 loops=69)
                           ->  Nested Loop Left Join  (cost=0.84..13.72 rows=1 width=22) (actual time=0.011..0.013 rows=1 loops=69)
                                 ->  Nested Loop Left Join  (cost=0.56..8.36 rows=1 width=22) (actual time=0.008..0.009 rows=1 loops=69)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..5.52 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=69)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                       ->  Index Only Scan using device_pkey on device tag  (cost=0.28..2.84 rows=1 width=8) (actual time=0.002..0.003 rows=1 loops=70)
                                             Index Cond: (id = sensor.tag_id)
                                             Heap Fetches: 0
                                 ->  Index Scan using tag_id_index on surgery  (cost=0.28..5.34 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=70)
                                       Index Cond: (tag.id = tag_id)
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..5.55 rows=1 width=32) (actual time=0.003..0.003 rows=1 loops=70)
                                 Index Cond: (surgery.release_id = id)
                     ->  Index Scan using animal_pkey on animal  (cost=0.28..5.28 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=70)
                           Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..5.71 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=70)
               Index Cond: (animal.species_id = id)
 Total runtime: 16.835 ms
(70 rows)

\q
