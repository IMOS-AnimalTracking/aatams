
set role to aatams;
set role to aatams;
SET
-- Low selectivity filtering (large number of rows returned for each filter)
-- Test Case 1 - 2716283 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
limit 300000;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3815.07..169830.31 rows=244897 width=279) (actual time=79.063..3226.986 rows=300000 loops=1)
   ->  Hash Left Join  (cost=3815.07..169830.31 rows=244897 width=279) (actual time=79.061..3152.436 rows=300000 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=1326.86..140177.74 rows=244897 width=239) (actual time=26.370..1360.204 rows=304923 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.479..1066.422 rows=304016 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.264..918.581 rows=304016 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.204..758.642 rows=304016 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.185..554.807 rows=304016 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.156..1.575 rows=54 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 796
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.134..1.222 rows=54 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.121..0.678 rows=54 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.105..0.387 rows=8 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 941
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.034..0.034 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.014..0.014 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.006 rows=27 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.007..0.149 rows=949 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.010..0.027 rows=7 loops=8)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.006..0.008 rows=1 loops=54)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.003 rows=16 loops=54)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.009 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.017..6.682 rows=5630 loops=54)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.988..0.988 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.568 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.037..0.037 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.020 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.172..0.172 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.109 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=24.841..24.841 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=14.888..22.685 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=5.337..10.605 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=3.223..6.700 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.753 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=3.190..3.190 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.006..1.986 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.091..2.091 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.006..0.969 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=9.530..9.530 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.832..8.003 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.005..0.919 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.803..3.803 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.003..1.870 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=46.311..46.311 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.010..28.225 rows=36587 loops=1)
 Total runtime: 3268.350 ms
(72 rows)

-- Test Case 2 - 3913743 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
limit 300000;
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2833.04..56335.12 rows=76141 width=279) (actual time=40.765..3069.617 rows=300000 loops=1)
   ->  Hash Join  (cost=2833.04..56335.12 rows=76141 width=279) (actual time=40.763..2999.035 rows=300000 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2830.89..52619.67 rows=228803 width=260) (actual time=40.655..1334.256 rows=300000 loops=1)
               Hash Cond: (receiver_deployment.receiver_id = receiver.id)
               ->  Hash Join  (cost=2454.55..47381.27 rows=228803 width=248) (actual time=33.906..1135.468 rows=300000 loops=1)
                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                     ->  Hash Join  (cost=2348.68..43843.36 rows=228803 width=152) (actual time=31.605..932.859 rows=300000 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.102..763.982 rows=361328 loops=1)
                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                 ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.792..539.981 rows=361328 loops=1)
                                       ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.747..26.638 rows=47 loops=1)
                                             ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.724..26.362 rows=30 loops=1)
                                                   ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.640..25.998 rows=30 loops=1)
                                                         Hash Cond: (animal_release.id = surgery.release_id)
                                                         ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.718..24.017 rows=30 loops=1)
                                                               Hash Cond: (animal_release.animal_id = animal.id)
                                                               ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.125 rows=725 loops=1)
                                                               ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.622..23.622 rows=174 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                     ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.337..23.547 rows=174 loops=1)
                                                                           Hash Cond: (animal.species_id = species.id)
                                                                           ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.506 rows=4023 loops=1)
                                                                           ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.291..22.291 rows=1 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                 ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.415..22.282 rows=1 loops=1)
                                                                                       Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                       Rows Removed by Filter: 36586
                                                         ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.903..1.903 rows=3923 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.922 rows=3923 loops=1)
                                                   ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.008..0.009 rows=1 loops=30)
                                                         Index Cond: (id = surgery.tag_id)
                                                         Heap Fetches: 0
                                             ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.007 rows=2 loops=30)
                                                   Index Cond: (tag_id = tag.id)
                                       ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.020..6.731 rows=7688 loops=47)
                                             Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                 ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.294..4.294 rows=5710 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                       ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.942 rows=5710 loops=1)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.489..1.489 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.137..1.138 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.192 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.128..0.128 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.082 rows=173 loops=1)
                     ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.284..2.284 rows=1964 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 280kB
                           ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.154..1.378 rows=1964 loops=1)
                                 Hash Cond: (installation_station.installation_id = installation.id)
                                 ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.286 rows=1964 loops=1)
                                 ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.144..0.144 rows=110 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                       ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.049..0.107 rows=110 loops=1)
                                             Hash Cond: (installation.project_id = receiver_project.id)
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.017 rows=110 loops=1)
                                             ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.039..0.039 rows=75 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.015 rows=75 loops=1)
               ->  Hash  (cost=286.00..286.00 rows=7227 width=28) (actual time=6.736..6.736 rows=7227 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 389kB
                     ->  Hash Join  (cost=1.36..286.00 rows=7227 width=28) (actual time=0.020..4.734 rows=7227 loops=1)
                           Hash Cond: (receiver.model_id = device_model.id)
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.992 rows=7227 loops=1)
                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.008..0.008 rows=16 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.023 rows=51 loops=1)
 Total runtime: 3108.048 ms
(75 rows)

-- Test Case 3 - 17098775 rows limited to first 100
explain analyze select * from detection_extract_test_view
where timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=348654.03..485452.46 rows=300000 width=279) (actual time=3367.559..6299.842 rows=300000 loops=1)
   ->  Hash Left Join  (cost=348654.03..2913890.97 rows=5625584 width=279) (actual time=3367.557..6227.209 rows=300000 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=346165.82..2295305.48 rows=5625584 width=239) (actual time=3325.725..4552.171 rows=303559 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=344912.31..2098995.76 rows=5287633 width=193) (actual time=3301.927..4268.760 rows=303555 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=344901.41..2025961.60 rows=5372518 width=187) (actual time=3301.781..4117.615 rows=303555 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=344899.27..1911692.91 rows=16144362 width=168) (actual time=3301.737..3959.437 rows=303555 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=344840.09..1689648.76 rows=16144362 width=168) (actual time=3300.935..3792.215 rows=303555 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=343912.28..1365833.71 rows=16144362 width=52) (actual time=3279.965..3499.823 rows=303555 loops=1)
                                             Recheck Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Index Recheck: 75042
                                             ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..339876.18 rows=16144362 width=0) (actual time=3278.564..3278.564 rows=16316319 loops=1)
                                                   Index Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                       ->  Hash  (cost=856.44..856.44 rows=5710 width=132) (actual time=20.953..20.953 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 969kB
                                             ->  Hash Join  (cost=382.84..856.44 rows=5710 width=132) (actual time=6.219..17.803 rows=5710 loops=1)
                                                   Hash Cond: (receiver.model_id = device_model.id)
                                                   ->  Hash Join  (cost=381.48..776.56 rows=5710 width=135) (actual time=6.201..15.395 rows=5710 loops=1)
                                                         Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                         ->  Hash Join  (cost=105.87..379.62 rows=5710 width=120) (actual time=2.229..8.223 rows=5710 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.953 rows=5710 loops=1)
                                                               ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.218..2.218 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 280kB
                                                                     ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.157..1.391 rows=1964 loops=1)
                                                                           Hash Cond: (installation_station.installation_id = installation.id)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.258 rows=1964 loops=1)
                                                                           ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.148..0.148 rows=110 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                                                 ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.050..0.116 rows=110 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.014 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.038..0.038 rows=75 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.016 rows=75 loops=1)
                                                         ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.960..3.960 rows=7227 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                               ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.003..2.025 rows=7227 loops=1)
                                                   ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.010..0.010 rows=16 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=1)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.791..0.791 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.416 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.017 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.089 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=23.768..23.768 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=14.066..21.451 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.661..9.609 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.723..5.976 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.546 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.691..2.691 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.516 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.916..1.916 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.790 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=9.390..9.390 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.282..7.061 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.007..0.722 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.261..3.261 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.468 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.704..41.704 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..23.981 rows=36587 loops=1)
 Total runtime: 6334.982 ms
(82 rows)

-- Test Case 4 -  2716283 ^ 3913743 -> 1420919 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
limit 300000;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=3780.638..7098.055 rows=300000 loops=1)
   ->  Hash Join  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=3780.637..7027.213 rows=300000 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2613.26..42042.23 rows=3051 width=260) (actual time=3780.523..5343.235 rows=300000 loops=1)
               Hash Cond: (receiver.model_id = device_model.id)
               ->  Hash Join  (cost=2611.90..41998.91 rows=3051 width=263) (actual time=3780.505..5179.487 rows=300000 loops=1)
                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=3776.542..4973.797 rows=300000 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=3776.398..4809.140 rows=300000 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=3775.638..4634.789 rows=300000 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.637..4111.039 rows=2607933 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.615..2880.279 rows=2607933 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.581..29.157 rows=167 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.567..28.186 rows=122 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.542..27.044 rows=122 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.775..25.056 rows=121 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.458 rows=2525 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.688..23.688 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.431..23.619 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.496 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.405..22.405 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.498..22.397 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.752..1.752 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.872 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=122)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=122)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.018..9.701 rows=15616 loops=167)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.007..4.007 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.621 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.144..0.144 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.064..0.124 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.043..0.068 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.019 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.023..0.023 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.013..0.022 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.015..0.035 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.750..0.750 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.376 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.129..0.129 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.082 rows=173 loops=1)
                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.953..3.953 rows=7227 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.064 rows=7227 loops=1)
               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.010..0.010 rows=16 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.040..0.040 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.021 rows=51 loops=1)
 Total runtime: 7137.580 ms
(75 rows)

-- Test Case 5 - 2716283 ^ 17098775 -> 902906 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4127.15..128717.35 rows=75008 width=279) (actual time=64.104..3975.597 rows=300000 loops=1)
   ->  Hash Left Join  (cost=4127.15..128717.35 rows=75008 width=279) (actual time=64.102..3904.744 rows=300000 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=1638.94..117659.78 rows=75008 width=239) (actual time=23.335..2184.933 rows=305219 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=2.043..1903.668 rows=305204 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=1.898..1755.888 rows=305204 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=1.855..1604.804 rows=305204 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=1.083..1414.353 rows=305204 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.053..2.806 rows=124 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.050..2.102 rows=124 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.043..0.841 rows=124 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.035..0.127 rows=25 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.021..0.021 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.008 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.004 rows=27 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.012..0.065 rows=25 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.010..0.020 rows=5 loops=25)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.006..0.007 rows=1 loops=124)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.004 rows=1 loops=124)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=7.815..10.406 rows=2461 loops=124)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 9575
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=1.636..1.636 rows=12635 loops=124)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.764..0.764 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.001..0.431 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.021 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.085 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=21.274..21.274 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=12.139..19.519 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.220..9.158 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.493..5.591 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.563 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.471..2.471 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.505 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.713..1.713 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.813 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=7.911..7.911 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=2.974..6.649 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.003..0.732 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=2.960..2.960 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.001..1.437 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=40.662..40.662 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..23.879 rows=36587 loops=1)
 Total runtime: 4010.800 ms
(73 rows)

-- Test Case 6 - 3913743 ^ 17098775 -> 2233756 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3206.38..41361.67 rows=23321 width=279) (actual time=44.970..3610.962 rows=300000 loops=1)
   ->  Hash Join  (cost=3206.38..41361.67 rows=23321 width=279) (actual time=44.968..3537.140 rows=300000 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=3204.23..40222.20 rows=70078 width=260) (actual time=44.857..1884.036 rows=300000 loops=1)
               Hash Cond: (receiver_deployment.receiver_id = receiver.id)
               ->  Hash Join  (cost=2827.89..38356.70 rows=70078 width=248) (actual time=38.185..1687.124 rows=300000 loops=1)
                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                     ->  Hash Join  (cost=2722.02..37199.66 rows=70078 width=152) (actual time=35.953..1491.277 rows=300000 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=34.455..1327.057 rows=300000 loops=1)
                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                 ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=30.601..1131.323 rows=300000 loops=1)
                                       ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.225..26.420 rows=78 loops=1)
                                             ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.211..25.953 rows=62 loops=1)
                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.184..25.480 rows=62 loops=1)
                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.086 rows=447 loops=1)
                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.158..25.158 rows=167 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.672..25.095 rows=167 loops=1)
                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.569 rows=3920 loops=1)
                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.587..23.587 rows=174 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.333..23.523 rows=174 loops=1)
                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.515 rows=4023 loops=1)
                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.305..22.305 rows=1 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.426..22.296 rows=1 loops=1)
                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                             Rows Removed by Filter: 36586
                                                   ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.005..0.006 rows=1 loops=62)
                                                         Index Cond: (id = surgery.tag_id)
                                                         Heap Fetches: 0
                                             ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=62)
                                                   Index Cond: (tag_id = tag.id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.678..12.641 rows=3846 loops=78)
                                             Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             Rows Removed by Index Recheck: 13962
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 3092
                                             ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=1.378..1.378 rows=8170 loops=78)
                                                   Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                 ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.841..3.841 rows=5710 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                       ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.541 rows=5710 loops=1)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.485..1.485 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.139..1.127 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.211 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.128..0.128 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.088 rows=173 loops=1)
                     ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.219..2.219 rows=1964 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 280kB
                           ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.160..1.366 rows=1964 loops=1)
                                 Hash Cond: (installation_station.installation_id = installation.id)
                                 ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.265 rows=1964 loops=1)
                                 ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.149..0.149 rows=110 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                       ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.051..0.110 rows=110 loops=1)
                                             Hash Cond: (installation.project_id = receiver_project.id)
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                             ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.039..0.039 rows=75 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.020 rows=75 loops=1)
               ->  Hash  (cost=286.00..286.00 rows=7227 width=28) (actual time=6.663..6.663 rows=7227 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 389kB
                     ->  Hash Join  (cost=1.36..286.00 rows=7227 width=28) (actual time=0.020..4.672 rows=7227 loops=1)
                           Hash Cond: (receiver.model_id = device_model.id)
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.930 rows=7227 loops=1)
                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.008..0.008 rows=16 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.022 rows=51 loops=1)
 Total runtime: 3645.567 ms
(80 rows)

-- Test Case 7 - 2716283 ^ 3913743 ^ 17098775 -> 690003 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..37239.14 rows=311 width=279) (actual time=482.906..9259.583 rows=300000 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=482.904..9179.766 rows=300000 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=482.837..6608.393 rows=300000 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=482.830..5856.530 rows=300000 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=482.810..4556.216 rows=300000 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=481.286..4359.894 rows=300000 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=34.814..4006.288 rows=1394509 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=30.876..3276.955 rows=1394509 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.519..29.912 rows=190 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.488..28.491 rows=143 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.463..26.943 rows=143 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.523 rows=2839 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.436..25.436 rows=167 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.952..25.360 rows=167 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.510 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.866..23.866 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.598..23.807 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.540 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.573..22.573 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.656..22.565 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.007..0.008 rows=1 loops=143)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.008 rows=1 loops=143)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=2.885..14.643 rows=7340 loops=190)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Rows Removed by Index Recheck: 6386
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 5920
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=2.134..2.134 rows=13264 loops=190)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.925..3.925 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.590 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.126..0.126 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.047..0.109 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.033..0.058 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.017..0.017 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.016 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.029 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.510..1.510 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.148..1.139 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.179 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.132..0.132 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.088 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=300000)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=300000)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=300000)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 9302.202 ms
(74 rows)

 
-- High selectivity filtering (small number of rows returned for each filter)
-- Test Case 8 - 5909 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
limit 300000;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3815.07..169830.31 rows=244897 width=279) (actual time=63.896..127.217 rows=5909 loops=1)
   ->  Hash Left Join  (cost=3815.07..169830.31 rows=244897 width=279) (actual time=63.893..125.769 rows=5909 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=1326.86..140177.74 rows=244897 width=239) (actual time=22.719..46.594 rows=5909 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.353..20.153 rows=5874 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.193..17.120 rows=5874 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.150..14.107 rows=5874 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.375..9.593 rows=5874 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.314..1.525 rows=64 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 960
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.306..1.187 rows=64 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.299..0.853 rows=64 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.285..0.662 rows=15 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 1949
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.022..0.064 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 109
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.021 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 74
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.015 rows=110 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.261 rows=1964 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.005..0.009 rows=4 loops=15)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=64)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=64)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.008..0.078 rows=92 loops=64)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.766..0.766 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.452 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.035..0.035 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.022 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.150..0.150 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.108 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=21.349..21.349 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=12.268..19.640 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.149..8.987 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.446..5.641 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.598 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.424..2.424 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..1.494 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.692..1.692 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.812 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=8.109..8.109 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.079..6.831 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.002..0.687 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.067..3.067 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.002..1.502 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.072..41.072 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..23.884 rows=36587 loops=1)
 Total runtime: 128.290 ms
(72 rows)

-- Test Case 9 - 2153 rows
set geqo_threshold to 12;
SET
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
limit 300000;
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2833.04..56335.12 rows=76141 width=279) (actual time=40.009..63.015 rows=2153 loops=1)
   ->  Hash Join  (cost=2833.04..56335.12 rows=76141 width=279) (actual time=40.008..62.524 rows=2153 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2830.89..52619.67 rows=228803 width=260) (actual time=39.896..50.463 rows=2153 loops=1)
               Hash Cond: (receiver_deployment.receiver_id = receiver.id)
               ->  Hash Join  (cost=2454.55..47381.27 rows=228803 width=248) (actual time=33.144..42.328 rows=2153 loops=1)
                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                     ->  Hash Join  (cost=2348.68..43843.36 rows=228803 width=152) (actual time=30.872..38.655 rows=2153 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.374..36.004 rows=2153 loops=1)
                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                 ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.382..30.525 rows=2153 loops=1)
                                       ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.309..26.992 rows=27 loops=1)
                                             ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.296..26.866 rows=27 loops=1)
                                                   ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.268..26.740 rows=27 loops=1)
                                                         Hash Cond: (animal_release.id = surgery.release_id)
                                                         ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.494..24.926 rows=27 loops=1)
                                                               Hash Cond: (animal_release.animal_id = animal.id)
                                                               ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.579 rows=3920 loops=1)
                                                               ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.480..23.480 rows=35 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.314..23.464 rows=35 loops=1)
                                                                           Hash Cond: (animal.species_id = species.id)
                                                                           ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.495 rows=4023 loops=1)
                                                                           ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.281..22.281 rows=1 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                 ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.410..22.273 rows=1 loops=1)
                                                                                       Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                       Rows Removed by Filter: 36586
                                                         ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.758..1.758 rows=3923 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.005..0.923 rows=3923 loops=1)
                                                   ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=27)
                                                         Index Cond: (id = surgery.tag_id)
                                                         Heap Fetches: 0
                                             ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=27)
                                                   Index Cond: (tag_id = tag.id)
                                       ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.011..0.088 rows=80 loops=27)
                                             Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                 ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.979..3.979 rows=5710 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                       ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.649 rows=5710 loops=1)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.485..1.485 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.140..1.099 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.206 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.129..0.129 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.090 rows=173 loops=1)
                     ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.259..2.259 rows=1964 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 280kB
                           ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.156..1.392 rows=1964 loops=1)
                                 Hash Cond: (installation_station.installation_id = installation.id)
                                 ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.267 rows=1964 loops=1)
                                 ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.145..0.145 rows=110 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                       ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.048..0.112 rows=110 loops=1)
                                             Hash Cond: (installation.project_id = receiver_project.id)
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.020 rows=110 loops=1)
                                             ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.038..0.038 rows=75 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.015 rows=75 loops=1)
               ->  Hash  (cost=286.00..286.00 rows=7227 width=28) (actual time=6.741..6.741 rows=7227 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 389kB
                     ->  Hash Join  (cost=1.36..286.00 rows=7227 width=28) (actual time=0.021..4.751 rows=7227 loops=1)
                           Hash Cond: (receiver.model_id = device_model.id)
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..0.947 rows=7227 loops=1)
                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.019 rows=51 loops=1)
 Total runtime: 63.575 ms
(75 rows)

-- Test Case 10 - 1065 rows
explain analyze select * from detection_extract_test_view
  where timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 300000;
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4862.46..5832.53 rows=488 width=279) (actual time=32.189..44.799 rows=1065 loops=1)
   ->  Nested Loop Left Join  (cost=4862.46..5832.53 rows=488 width=279) (actual time=32.187..44.529 rows=1065 loops=1)
         ->  Hash Right Join  (cost=4862.17..4952.37 rows=488 width=239) (actual time=32.113..33.854 rows=1065 loops=1)
               Hash Cond: (animal.id = animal_release.animal_id)
               ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.491 rows=4023 loops=1)
               ->  Hash  (cost=4856.07..4856.07 rows=488 width=239) (actual time=31.857..31.857 rows=1065 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 352kB
                     ->  Nested Loop Left Join  (cost=4528.01..4856.07 rows=488 width=239) (actual time=25.450..30.779 rows=1065 loops=1)
                           ->  Hash Right Join  (cost=4527.73..4641.32 rows=488 width=215) (actual time=25.435..27.254 rows=1065 loops=1)
                                 Hash Cond: (surgery.tag_id = tag.id)
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.518 rows=3923 loops=1)
                                 ->  Hash  (cost=4521.63..4521.63 rows=488 width=215) (actual time=25.282..25.282 rows=1065 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 327kB
                                       ->  Nested Loop Left Join  (cost=867.27..4521.63 rows=488 width=215) (actual time=12.910..24.072 rows=1065 loops=1)
                                             ->  Hash Left Join  (cost=866.99..4359.32 rows=488 width=215) (actual time=12.881..20.719 rows=1065 loops=1)
                                                   Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   ->  Hash Join  (cost=686.58..4161.98 rows=459 width=193) (actual time=10.188..17.062 rows=1065 loops=1)
                                                         Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                                         ->  Hash Join  (cost=675.68..4144.75 rows=466 width=187) (actual time=10.044..16.395 rows=1065 loops=1)
                                                               Hash Cond: (receiver.organisation_id = organisation.id)
                                                               ->  Hash Join  (cost=673.54..4132.70 rows=1400 width=168) (actual time=10.002..15.758 rows=1065 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                                     ->  Hash Join  (cost=614.36..4054.27 rows=1400 width=168) (actual time=9.247..14.398 rows=1065 loops=1)
                                                                           Hash Cond: (receiver.model_id = device_model.id)
                                                                           ->  Hash Join  (cost=613.00..4033.66 rows=1400 width=171) (actual time=9.229..13.788 rows=1065 loops=1)
                                                                                 Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                                                 ->  Hash Join  (cost=337.39..3728.30 rows=1400 width=156) (actual time=5.221..9.016 rows=1065 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Hash Join  (cost=334.70..3706.36 rows=1400 width=125) (actual time=5.168..8.387 rows=1065 loops=1)
                                                                                             Hash Cond: (installation_station.installation_id = installation.id)
                                                                                             ->  Hash Join  (cost=330.23..3682.64 rows=1400 width=109) (actual time=5.101..7.765 rows=1065 loops=1)
                                                                                                   Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                                   ->  Hash Join  (cost=260.04..3591.45 rows=1400 width=60) (actual time=4.018..6.014 rows=1065 loops=1)
                                                                                                         Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                                                         ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.047..1.050 rows=1065 loops=1)
                                                                                                               Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                                         ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.951..3.951 rows=5710 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                                                                               ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.550 rows=5710 loops=1)
                                                                                                   ->  Hash  (cost=45.64..45.64 rows=1964 width=57) (actual time=1.073..1.073 rows=1964 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 179kB
                                                                                                         ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.004..0.531 rows=1964 loops=1)
                                                                                             ->  Hash  (cost=3.10..3.10 rows=110 width=32) (actual time=0.058..0.058 rows=110 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 8kB
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.023 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.040..0.040 rows=75 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.019 rows=75 loops=1)
                                                                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.999..3.999 rows=7227 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                                                       ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.158 rows=7227 loops=1)
                                                                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.010..0.010 rows=16 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.004 rows=16 loops=1)
                                                                     ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.747..0.747 rows=1519 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.435 rows=1519 loops=1)
                                                               ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                     ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.018 rows=51 loops=1)
                                                         ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.136..0.136 rows=173 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.081 rows=173 loops=1)
                                                   ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.676..2.676 rows=5307 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                                         ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.005..1.382 rows=5307 loops=1)
                                             ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=1065)
                                                   Index Cond: (id = sensor.tag_id)
                                                   Heap Fetches: 0
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=1065)
                                 Index Cond: (surgery.release_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=1065)
               Index Cond: (animal.species_id = id)
 Total runtime: 45.267 ms
(74 rows)

-- Test Case 11 - 5909 ^ 2153 -> 609 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
limit 300000;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=37.887..45.176 rows=609 loops=1)
   ->  Hash Join  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=37.885..45.033 rows=609 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2613.26..42042.23 rows=3051 width=260) (actual time=37.774..41.562 rows=609 loops=1)
               Hash Cond: (receiver.model_id = device_model.id)
               ->  Hash Join  (cost=2611.90..41998.91 rows=3051 width=263) (actual time=37.755..41.195 rows=609 loops=1)
                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=33.803..36.820 rows=609 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=33.659..36.320 rows=609 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=32.903..35.224 rows=609 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.462..34.520 rows=2153 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.437..29.366 rows=2153 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.389..27.056 rows=27 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.375..26.934 rows=27 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.350..26.816 rows=27 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.570..25.002 rows=27 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.566 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.553..23.553 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.371..23.535 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.518 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.338..22.338 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.462..22.330 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.765..1.765 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.939 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=27)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=27)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.008..0.050 rows=80 loops=27)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.011..4.011 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.609 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.106..0.106 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.061..0.099 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.041..0.066 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.016 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.014..0.022 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.747..0.747 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.420 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.131..0.131 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.080 rows=173 loops=1)
                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.941..3.941 rows=7227 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.108 rows=7227 loops=1)
               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.023 rows=51 loops=1)
 Total runtime: 45.541 ms
(75 rows)

-- Test Case 12 - 5909 ^ 1065 -> 55 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 300000;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.531..3.825 rows=55 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.530..3.809 rows=55 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3373.72 rows=6 width=239) (actual time=0.482..3.195 rows=55 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3371.58 rows=6 width=239) (actual time=0.472..3.001 rows=55 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3368.94 rows=6 width=215) (actual time=0.466..2.816 rows=55 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3366.85 rows=6 width=215) (actual time=0.451..2.623 rows=55 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3364.85 rows=6 width=215) (actual time=0.443..2.442 rows=55 loops=1)
                                       ->  Nested Loop  (cost=27.78..3361.41 rows=6 width=193) (actual time=0.421..2.174 rows=55 loops=1)
                                             ->  Nested Loop  (cost=27.63..3360.22 rows=6 width=187) (actual time=0.416..2.021 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3356.96 rows=19 width=168) (actual time=0.414..1.881 rows=55 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3349.38 rows=19 width=168) (actual time=0.409..1.690 rows=55 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 825
                                                               ->  Nested Loop  (cost=27.21..3343.62 rows=19 width=171) (actual time=0.401..1.399 rows=55 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3335.78 rows=19 width=156) (actual time=0.393..1.155 rows=55 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.028..0.646 rows=1065 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.247..0.247 rows=64 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.058..0.214 rows=64 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.050..0.087 rows=15 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.040..0.065 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.019 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.018 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.007..0.014 rows=15 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.006 rows=4 loops=15)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=55)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.007 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=55)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.56 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=55)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=55)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=55)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.002..0.003 rows=1 loops=55)
               Index Cond: (animal.species_id = id)
 Total runtime: 4.140 ms
(58 rows)

-- Test Case 13 -  2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 300000;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.69..5500.06 rows=2 width=279) (actual time=32.880..33.976 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.69..5500.06 rows=2 width=279) (actual time=32.878..33.958 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.004..0.016 rows=51 loops=1)
         ->  Materialize  (cost=2141.69..5493.92 rows=6 width=260) (actual time=0.616..0.637 rows=55 loops=51)
               ->  Nested Loop  (cost=2141.69..5493.89 rows=6 width=260) (actual time=31.388..32.166 rows=55 loops=1)
                     ->  Nested Loop  (cost=2141.55..5492.70 rows=6 width=254) (actual time=31.379..32.017 rows=55 loops=1)
                           ->  Nested Loop  (cost=2141.27..5490.31 rows=6 width=254) (actual time=31.368..31.834 rows=55 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 825
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.006 rows=16 loops=1)
                                 ->  Materialize  (cost=2141.27..5487.72 rows=6 width=257) (actual time=1.760..1.965 rows=55 loops=16)
                                       ->  Nested Loop  (cost=2141.27..5487.69 rows=6 width=257) (actual time=28.157..31.290 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.99..5485.22 rows=6 width=242) (actual time=28.148..31.109 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.84..5483.53 rows=6 width=211) (actual time=28.140..30.956 rows=55 loops=1)
                                                         Join Filter: (installation_station.installation_id = installation.id)
                                                         Rows Removed by Join Filter: 5995
                                                         ->  Index Scan using installation_project_id_index on installation  (cost=0.14..16.50 rows=110 width=32) (actual time=0.005..0.044 rows=110 loops=1)
                                                         ->  Materialize  (cost=2140.70..5457.14 rows=6 width=195) (actual time=0.242..0.259 rows=55 loops=110)
                                                               ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.559..27.925 rows=55 loops=1)
                                                                     ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.547..27.731 rows=55 loops=1)
                                                                           ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.522..27.519 rows=55 loops=1)
                                                                                 ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.508..27.338 rows=55 loops=1)
                                                                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                                       ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.025..0.617 rows=1065 loops=1)
                                                                                             Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                       ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.341..26.341 rows=27 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                                             ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=24.992..26.318 rows=27 loops=1)
                                                                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=24.968..26.196 rows=27 loops=1)
                                                                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.519 rows=3923 loops=1)
                                                                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.940..24.940 rows=27 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.476..24.922 rows=27 loops=1)
                                                                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.599 rows=3920 loops=1)
                                                                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.462..23.462 rows=35 loops=1)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.248..23.443 rows=35 loops=1)
                                                                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.533 rows=4023 loops=1)
                                                                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.217..22.217 rows=1 loops=1)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.368..22.209 rows=1 loops=1)
                                                                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                                             Rows Removed by Filter: 36586
                                                                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=27)
                                                                                                         Index Cond: (tag_id = surgery.tag_id)
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                                                                       Index Cond: (id = sensor.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                                                 Index Cond: (id = valid_detection.receiver_deployment_id)
                                                                     ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.station_id)
                                                   ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.001..0.002 rows=1 loops=55)
                                                         Index Cond: (id = installation.project_id)
                                             ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=55)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 34.312 ms
(66 rows)

-- Test Case 14 -  5909 ^ 2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 300000;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.774..32.960 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.772..32.938 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Nested Loop  (cost=2141.26..5476.66 rows=1 width=260) (actual time=26.702..31.668 rows=55 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 9460
               ->  Nested Loop  (cost=2141.26..5465.77 rows=1 width=254) (actual time=26.633..28.908 rows=55 loops=1)
                     ->  Nested Loop  (cost=2140.98..5465.37 rows=1 width=254) (actual time=26.624..28.698 rows=55 loops=1)
                           Join Filter: (receiver.model_id = device_model.id)
                           Rows Removed by Join Filter: 825
                           ->  Nested Loop  (cost=2140.98..5464.01 rows=1 width=257) (actual time=26.611..28.338 rows=55 loops=1)
                                 ->  Nested Loop  (cost=2140.70..5463.60 rows=1 width=242) (actual time=26.601..28.142 rows=55 loops=1)
                                       Join Filter: (installation_station.installation_id = installation.id)
                                       ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.025..0.064 rows=1 loops=1)
                                             Join Filter: (installation.project_id = receiver_project.id)
                                             Rows Removed by Join Filter: 109
                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.023 rows=1 loops=1)
                                                   Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                   Rows Removed by Filter: 74
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                       ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.570..28.048 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.559..27.846 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.548..27.636 rows=55 loops=1)
                                                         ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.534..27.411 rows=55 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.026..0.631 rows=1065 loops=1)
                                                                     Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.367..26.367 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.053..26.347 rows=27 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.029..26.213 rows=27 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.499 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.999..24.999 rows=27 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.562..24.986 rows=27 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.562 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.548..23.548 rows=35 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.383..23.530 rows=35 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.478 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.351..22.351 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.469..22.342 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=27)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=55)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.002 rows=1 loops=55)
                                       Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=55)
                     ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                           Index Cond: (id = valid_detection.receiver_download_id)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.023 rows=173 loops=55)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=55)
 Total runtime: 33.268 ms
(66 rows)

-- Mixed selectivity filtering
-- Test Case 15 - 5909 ^ 833188 -> 184 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
limit 300000;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=44.461..1390.171 rows=184 loops=1)
   ->  Hash Join  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=44.460..1390.118 rows=184 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2613.26..42042.23 rows=3051 width=260) (actual time=44.349..1388.559 rows=184 loops=1)
               Hash Cond: (receiver.model_id = device_model.id)
               ->  Hash Join  (cost=2611.90..41998.91 rows=3051 width=263) (actual time=44.331..1388.418 rows=184 loops=1)
                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=40.401..1384.286 rows=184 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=40.259..1384.002 rows=184 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=39.501..1383.101 rows=184 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.534..1261.171 rows=833188 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.489..883.781 rows=833188 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.410..29.366 rows=147 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.397..28.484 rows=119 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.371..27.392 rows=119 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.606..25.396 rows=117 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.651 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.566..23.566 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.460..23.527 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.498 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.321..22.321 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.089..22.313 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.751..1.751 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.891 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=119)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=119)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.019..3.372 rows=5668 loops=147)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.031..4.031 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.575 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.104..0.104 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.060..0.094 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.042..0.066 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.013..0.021 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.748..0.748 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.440 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.129..0.129 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.081 rows=173 loops=1)
                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.920..3.920 rows=7227 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.073 rows=7227 loops=1)
               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.039..0.039 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.004..0.020 rows=51 loops=1)
 Total runtime: 1390.492 ms
(75 rows)

-- Test Case 16 - 5909 ^ 17098775 -> 3889 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4127.15..128717.35 rows=75008 width=279) (actual time=63.643..104.855 rows=3889 loops=1)
   ->  Hash Left Join  (cost=4127.15..128717.35 rows=75008 width=279) (actual time=63.641..103.874 rows=3889 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=1638.94..117659.78 rows=75008 width=239) (actual time=22.614..38.412 rows=3889 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=1.340..13.895 rows=3854 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=1.185..11.959 rows=3854 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=1.143..9.973 rows=3854 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=0.380..6.867 rows=3854 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.051..0.789 rows=64 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.048..0.592 rows=64 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.043..0.275 rows=64 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.035..0.098 rows=15 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.021..0.063 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 109
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.020 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 74
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.020 rows=15 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.004..0.008 rows=4 loops=15)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=64)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=64)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=0.030..0.073 rows=60 loops=64)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 32
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=0.015..0.015 rows=92 loops=64)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.755..0.755 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.436 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.018 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.144..0.144 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.100 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=21.258..21.258 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=12.112..19.561 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.184..9.119 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.483..5.628 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.607 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.463..2.463 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..1.494 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.690..1.690 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.820 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=7.917..7.917 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=2.977..6.688 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.002..0.682 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=2.962..2.962 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.001..1.480 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=40.927..40.927 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.005..24.031 rows=36587 loops=1)
 Total runtime: 105.640 ms
(73 rows)

-- Test Case 17 - 2716283 ^ 464 -> 448 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
limit 300000;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=35.480..41.497 rows=448 loops=1)
   ->  Hash Join  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=35.479..41.368 rows=448 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2613.26..42042.23 rows=3051 width=260) (actual time=35.367..38.736 rows=448 loops=1)
               Hash Cond: (receiver.model_id = device_model.id)
               ->  Hash Join  (cost=2611.90..41998.91 rows=3051 width=263) (actual time=35.349..38.468 rows=448 loops=1)
                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=31.400..34.215 rows=448 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=31.257..33.837 rows=448 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=30.499..32.826 rows=448 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.340..32.406 rows=464 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.295..28.022 rows=464 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.252..26.965 rows=24 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.237..26.857 rows=20 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.212..26.755 rows=20 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.455..24.976 rows=20 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.524 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.539..23.539 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.518..23.527 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.494 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.362..22.362 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.489..22.356 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.741..1.741 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.890 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=20)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=20)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.008..0.031 rows=19 loops=24)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=4.030..4.030 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.588 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.142..0.142 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.063..0.121 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.042..0.067 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.013 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.016..0.034 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.747..0.747 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.385 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.130..0.130 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.084 rows=173 loops=1)
                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.939..3.939 rows=7227 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.165 rows=7227 loops=1)
               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.019 rows=51 loops=1)
 Total runtime: 41.880 ms
(75 rows)

-- Test Case 18 - 2716283 ^ 2005 -> 4 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2013-06-08 00:00:00+00' and '2013-06-08 01:00:00+00'
limit 300000;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.008..2.593 rows=4 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.007..2.590 rows=4 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3884.18 rows=7 width=239) (actual time=1.960..2.511 rows=4 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3881.69 rows=7 width=239) (actual time=1.951..2.491 rows=4 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3878.61 rows=7 width=215) (actual time=1.944..2.473 rows=4 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3876.17 rows=7 width=215) (actual time=1.934..2.453 rows=4 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3873.84 rows=7 width=215) (actual time=1.926..2.435 rows=4 loops=1)
                                       ->  Nested Loop  (cost=27.78..3870.07 rows=7 width=193) (actual time=1.914..2.408 rows=4 loops=1)
                                             ->  Nested Loop  (cost=27.63..3868.68 rows=7 width=187) (actual time=1.910..2.395 rows=4 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3864.90 rows=22 width=168) (actual time=1.906..2.382 rows=4 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3856.39 rows=22 width=168) (actual time=1.895..2.359 rows=4 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 60
                                                               ->  Nested Loop  (cost=27.21..3849.91 rows=22 width=171) (actual time=1.887..2.324 rows=4 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3840.83 rows=22 width=156) (actual time=1.881..2.303 rows=4 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3808.21 rows=1613 width=52) (actual time=0.048..1.261 rows=1839 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2013-06-08 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-06-08 01:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.699..0.699 rows=282 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.060..0.567 rows=282 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.051..0.115 rows=45 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.040..0.065 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.013 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.009..0.019 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.008..0.031 rows=45 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.007 rows=6 loops=45)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=4)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.006 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.38 rows=1 width=16) (actual time=0.004..0.004 rows=1 loops=4)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.002 rows=1 loops=4)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=4)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.53 rows=1 width=22) (actual time=0.005..0.005 rows=1 loops=4)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=4)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.003..0.004 rows=1 loops=4)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.003..0.003 rows=1 loops=4)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.003..0.003 rows=1 loops=4)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.004 rows=1 loops=4)
               Index Cond: (animal.species_id = id)
 Total runtime: 2.903 ms
(58 rows)

-- Test Case 19 - 464 ^ 17098775 -> 6 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3206.38..41361.67 rows=23321 width=279) (actual time=39.525..41.455 rows=6 loops=1)
   ->  Hash Join  (cost=3206.38..41361.67 rows=23321 width=279) (actual time=39.524..41.452 rows=6 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=3204.23..40222.20 rows=70078 width=260) (actual time=39.412..41.307 rows=6 loops=1)
               Hash Cond: (receiver_deployment.receiver_id = receiver.id)
               ->  Hash Join  (cost=2827.89..38356.70 rows=70078 width=248) (actual time=32.710..34.599 rows=6 loops=1)
                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                     ->  Hash Join  (cost=2722.02..37199.66 rows=70078 width=152) (actual time=30.484..32.367 rows=6 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=28.988..30.867 rows=6 loops=1)
                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                 ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.136..27.010 rows=6 loops=1)
                                       ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.094..26.290 rows=24 loops=1)
                                             ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.079..26.184 rows=20 loops=1)
                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.052..26.088 rows=20 loops=1)
                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.482 rows=3923 loops=1)
                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.892..24.892 rows=20 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.379..24.880 rows=20 loops=1)
                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.541 rows=3920 loops=1)
                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.481..23.481 rows=20 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.452..23.476 rows=20 loops=1)
                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.510 rows=4023 loops=1)
                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.295..22.295 rows=1 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.482..22.289 rows=1 loops=1)
                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                             Rows Removed by Filter: 36586
                                                   ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=20)
                                                         Index Cond: (id = surgery.tag_id)
                                                         Heap Fetches: 0
                                             ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=20)
                                                   Index Cond: (tag_id = tag.id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.028..0.028 rows=0 loops=24)
                                             Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 19
                                             ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.009..0.009 rows=19 loops=24)
                                                   Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                 ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.839..3.839 rows=5710 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                       ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.513 rows=5710 loops=1)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.484..1.484 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.138..1.149 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.192 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.128..0.128 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.086 rows=173 loops=1)
                     ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.214..2.214 rows=1964 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 280kB
                           ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.159..1.364 rows=1964 loops=1)
                                 Hash Cond: (installation_station.installation_id = installation.id)
                                 ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.270 rows=1964 loops=1)
                                 ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.148..0.148 rows=110 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                       ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.050..0.113 rows=110 loops=1)
                                             Hash Cond: (installation.project_id = receiver_project.id)
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.022 rows=110 loops=1)
                                             ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.038..0.038 rows=75 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.018 rows=75 loops=1)
               ->  Hash  (cost=286.00..286.00 rows=7227 width=28) (actual time=6.692..6.692 rows=7227 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 389kB
                     ->  Hash Join  (cost=1.36..286.00 rows=7227 width=28) (actual time=0.020..4.730 rows=7227 loops=1)
                           Hash Cond: (receiver.model_id = device_model.id)
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.959 rows=7227 loops=1)
                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.022 rows=51 loops=1)
 Total runtime: 41.748 ms
(79 rows)

-- Test Case 20 - 833188 ^ 5489 -> 210 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 300000;
                                                                                                                                             QUERY PLAN                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2473.59..12305.40 rows=7 width=279) (actual time=267.645..271.870 rows=210 loops=1)
   ->  Nested Loop  (cost=2473.59..12305.40 rows=7 width=279) (actual time=267.644..271.821 rows=210 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 10500
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.003..0.009 rows=51 loops=1)
         ->  Materialize  (cost=2473.59..12288.44 rows=20 width=260) (actual time=4.979..5.222 rows=210 loops=51)
               ->  Nested Loop  (cost=2473.59..12288.34 rows=20 width=260) (actual time=253.897..265.129 rows=210 loops=1)
                     ->  Nested Loop  (cost=2473.44..12284.37 rows=20 width=254) (actual time=253.888..264.565 rows=210 loops=1)
                           ->  Nested Loop  (cost=2473.16..12277.66 rows=20 width=254) (actual time=253.877..263.860 rows=210 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 3150
                                 ->  Nested Loop  (cost=2473.16..12271.66 rows=20 width=257) (actual time=253.860..262.885 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2472.88..12263.40 rows=20 width=242) (actual time=253.847..262.097 rows=210 loops=1)
                                             Join Filter: (installation_station.installation_id = installation.id)
                                             Rows Removed by Join Filter: 22890
                                             ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.060..0.157 rows=110 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.023 rows=110 loops=1)
                                                   ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.044..0.044 rows=75 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.018 rows=75 loops=1)
                                             ->  Materialize  (cost=2470.19..12223.15 rows=20 width=195) (actual time=0.792..2.301 rows=210 loops=110)
                                                   ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=87.112..250.956 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=87.101..250.245 rows=210 loops=1)
                                                               ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=87.088..249.413 rows=210 loops=1)
                                                                     ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.590..28.049 rows=147 loops=1)
                                                                           ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.576..27.444 rows=119 loops=1)
                                                                                 ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.549..26.882 rows=119 loops=1)
                                                                                       Hash Cond: (surgery.release_id = animal_release.id)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.524 rows=3923 loops=1)
                                                                                       ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.448..25.448 rows=117 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                             ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.970..25.403 rows=117 loops=1)
                                                                                                   Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                   ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.540 rows=3920 loops=1)
                                                                                                   ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.932..23.932 rows=125 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                                         ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.834..23.888 rows=125 loops=1)
                                                                                                               Hash Cond: (animal.species_id = species.id)
                                                                                                               ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.483 rows=4023 loops=1)
                                                                                                               ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.695..22.695 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.457..22.687 rows=1 loops=1)
                                                                                                                           Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                                           Rows Removed by Filter: 36586
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=119)
                                                                                       Index Cond: (id = surgery.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                 Index Cond: (tag_id = tag.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.503..1.503 rows=1 loops=147)
                                                                           Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                                           ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.501..1.501 rows=0 loops=147)
                                                                                 ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.623..0.623 rows=5041 loops=147)
                                                                                       Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                                 ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.860..0.860 rows=5668 loops=147)
                                                                                       Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=210)
                                                                     Index Cond: (id = valid_detection.receiver_deployment_id)
                                                         ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=210)
                                                               Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=210)
                                             Index Cond: (id = receiver_deployment.receiver_id)
                                 ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=210)
                                       ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.005 rows=16 loops=1)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=210)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=210)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 272.215 ms
(70 rows)

-- Test Case 21 - 5909 ^ 2153 ^ 17098775 -> 284 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.829..40.251 rows=284 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.828..40.161 rows=284 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=33.763..37.704 rows=284 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=33.756..36.988 rows=284 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=33.746..35.722 rows=284 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=32.219..34.004 rows=284 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.413..33.532 rows=1435 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.482..28.847 rows=1435 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.258..26.672 rows=27 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.246..26.551 rows=27 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.219..26.430 rows=27 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.481 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.187..25.187 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.778..25.168 rows=27 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.552 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.765..23.765 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.590..23.746 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.499 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.556..22.556 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.644..22.548 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=27)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=27)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.025..0.063 rows=53 loops=27)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 27
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.017..0.017 rows=80 loops=27)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.919..3.919 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.572 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.091..0.091 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.047..0.084 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.034..0.058 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.015 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.016..0.016 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.015 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.020 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.512..1.512 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.149..1.151 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.005..0.215 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.092 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=284)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=284)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=284)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 40.585 ms
(73 rows)

-- Test Case 22 - 5909 ^ 833188 ^ 5489 -> 13 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 300000;
                                                                                                                                       QUERY PLAN                                                                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470.75..12251.27 rows=1 width=279) (actual time=87.752..254.433 rows=13 loops=1)
   ->  Nested Loop  (cost=2470.75..12251.27 rows=1 width=279) (actual time=87.751..254.428 rows=13 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 650
         ->  Nested Loop  (cost=2470.75..12249.09 rows=1 width=260) (actual time=87.680..254.085 rows=13 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 2236
               ->  Nested Loop  (cost=2470.75..12238.20 rows=1 width=254) (actual time=87.610..253.392 rows=13 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 195
                     ->  Nested Loop  (cost=2470.75..12236.84 rows=1 width=257) (actual time=87.600..253.304 rows=13 loops=1)
                           ->  Nested Loop  (cost=2470.47..12236.43 rows=1 width=242) (actual time=87.590..253.245 rows=13 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 197
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.024..0.064 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.022 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2470.47..12229.77 rows=20 width=195) (actual time=87.554..253.117 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=87.542..252.443 rows=210 loops=1)
                                             ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=87.531..251.732 rows=210 loops=1)
                                                   ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=87.518..250.916 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.251..27.719 rows=147 loops=1)
                                                               ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.236..27.102 rows=119 loops=1)
                                                                     ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.210..26.542 rows=119 loops=1)
                                                                           Hash Cond: (surgery.release_id = animal_release.id)
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.555 rows=3923 loops=1)
                                                                           ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.104..25.104 rows=117 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                 ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.622..25.050 rows=117 loops=1)
                                                                                       Hash Cond: (animal_release.animal_id = animal.id)
                                                                                       ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.524 rows=3920 loops=1)
                                                                                       ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.585..23.585 rows=125 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                             ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.461..23.540 rows=125 loops=1)
                                                                                                   Hash Cond: (animal.species_id = species.id)
                                                                                                   ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.521 rows=4023 loops=1)
                                                                                                   ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.320..22.320 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.083..22.312 rows=1 loops=1)
                                                                                                               Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                               Rows Removed by Filter: 36586
                                                                     ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=119)
                                                                           Index Cond: (id = surgery.tag_id)
                                                                           Heap Fetches: 0
                                                               ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                     Index Cond: (tag_id = tag.id)
                                                         ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.515..1.516 rows=1 loops=147)
                                                               Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                               ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.514..1.514 rows=0 loops=147)
                                                                     ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.638..0.638 rows=5041 loops=147)
                                                                           Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.857..0.857 rows=5668 loops=147)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=210)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=210)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=210)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=13)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=13)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.025 rows=173 loops=13)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=13)
 Total runtime: 254.740 ms
(69 rows)

-- Test Case 23 - 5909 ^ 833188 ^ 17098775 -> 54 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.611..1336.760 rows=54 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.610..1336.742 rows=54 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=33.544..1335.892 rows=54 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=33.537..1335.697 rows=54 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=33.526..1335.367 rows=54 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=31.991..1333.779 rows=54 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=31.027..1235.053 rows=694779 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=27.106..921.975 rows=694779 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.518..29.002 rows=147 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.505..28.057 rows=119 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.479..26.952 rows=119 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.564 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.370..25.370 rows=117 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.864..25.301 rows=117 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.550 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.826..23.826 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.701..23.775 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.539 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.560..22.560 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.294..22.552 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=119)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=119)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.168..4.738 rows=4726 loops=147)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 942
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.869..0.869 rows=5668 loops=147)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.909..3.909 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.598 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.090..0.090 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.047..0.080 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.034..0.058 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.016..0.016 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.015 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.013 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.521..1.521 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.147..1.125 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.201 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.132..0.132 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.088 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=54)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=54)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=54)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 1337.079 ms
(73 rows)

-- Test Case 24 - 2716283 ^ 464 ^ 3129 -> 2 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 300000;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=26.905..29.313 rows=2 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=26.903..29.310 rows=2 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 100
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=26.832..29.205 rows=2 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 344
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=26.764..29.083 rows=2 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 30
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=26.750..29.058 rows=2 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=26.742..29.044 rows=2 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.024..0.065 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.023 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=26.712..28.973 rows=2 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=26.700..28.957 rows=2 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=26.690..28.942 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=26.674..28.922 rows=2 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=26.661..28.904 rows=2 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.049..1.803 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.238..26.238 rows=24 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.094..26.218 rows=24 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.068..26.112 rows=20 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.501 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.910..24.910 rows=20 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.403..24.900 rows=20 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.555 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.511..23.511 rows=20 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.481..23.503 rows=20 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.519 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.326..22.326 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.490..22.318 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=20)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=2)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.008..0.008 rows=1 loops=2)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.005..0.005 rows=1 loops=2)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.005..0.005 rows=1 loops=2)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=2)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.003 rows=16 loops=2)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.022 rows=173 loops=2)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.009 rows=51 loops=2)
 Total runtime: 29.618 ms
(66 rows)

-- Test Case 25 - 2716283 ^ 464 ^ 17098775 -> 4 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..37239.14 rows=311 width=279) (actual time=31.306..33.112 rows=4 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=31.305..33.109 rows=4 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=31.241..33.015 rows=4 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=31.233..32.998 rows=4 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=31.225..32.977 rows=4 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=29.658..31.405 rows=4 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.370..31.263 rows=6 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.456..27.345 rows=6 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.415..26.646 rows=24 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.401..26.542 rows=20 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.375..26.447 rows=20 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.491 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.210..25.210 rows=20 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.699..25.201 rows=20 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.544 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.799..23.799 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.733..23.781 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.522 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.578..22.578 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.573..22.573 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=20)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=20)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.027..0.027 rows=0 loops=24)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 19
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.009..0.009 rows=19 loops=24)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.902..3.902 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.587 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.127..0.127 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.049..0.107 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.034..0.059 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.017 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.017..0.017 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.017 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.031 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.552..1.552 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.145..1.185 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.245 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.131..0.131 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.089 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.003..0.003 rows=1 loops=4)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=4)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 33.413 ms
(73 rows)

-- Test Case 26 - 2716283 ^ 3913743 ^ 3129 -> 52 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 300000;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.674..43.149 rows=52 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.672..43.125 rows=52 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2600
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.602..41.937 rows=52 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 8944
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=27.532..39.326 rows=52 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 780
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=27.520..38.982 rows=52 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=27.511..38.784 rows=52 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 554
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.024..0.063 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.021 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.015 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=27.481..38.579 rows=606 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=27.469..36.661 rows=606 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=27.458..34.678 rows=606 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=27.432..32.468 rows=606 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=27.419..30.571 rows=606 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.036..1.872 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=27.356..27.356 rows=215 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 30kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.214..27.195 rows=215 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.188..26.485 rows=168 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.504 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.166..25.166 rows=167 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.690..25.108 rows=167 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.555 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.608..23.608 rows=174 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.368..23.544 rows=174 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.488 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.342..22.342 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.463..22.334 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=168)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=606)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=606)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=606)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=606)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=52)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.002 rows=16 loops=52)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.023 rows=173 loops=52)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=52)
 Total runtime: 43.454 ms
(67 rows)

\q
