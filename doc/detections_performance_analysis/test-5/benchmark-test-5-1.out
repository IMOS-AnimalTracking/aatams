
set role to aatams;
set role to aatams;
SET
-- Low selectivity filtering (large number of rows returned for each filter)
-- Test Case 1 - 2716283 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
limit 300000;
                                                                                                             QUERY PLAN                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3815.07..169830.31 rows=244897 width=279) (actual time=90.534..3543.561 rows=300000 loops=1)
   ->  Hash Left Join  (cost=3815.07..169830.31 rows=244897 width=279) (actual time=90.531..3469.004 rows=300000 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=1326.86..140177.74 rows=244897 width=239) (actual time=29.871..1638.826 rows=304923 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.749..1339.430 rows=304016 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.496..1189.228 rows=304016 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.442..1035.062 rows=304016 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.294..835.955 rows=304016 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.233..2.285 rows=54 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 796
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.211..1.881 rows=54 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.175..1.106 rows=54 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.138..0.530 rows=8 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 941
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.035..0.035 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.015..0.015 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.004 rows=27 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.019..0.307 rows=949 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.018..0.060 rows=7 loops=8)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.010..0.011 rows=1 loops=54)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=54)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.008 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.036..11.965 rows=5630 loops=54)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=1.128..1.128 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.672 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.014 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.207..0.207 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.151 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=28.076..28.076 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=17.544..25.787 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=6.385..12.030 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=4.050..7.772 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.016..1.399 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=3.992..3.992 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.017..2.704 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=2.305..2.305 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..1.201 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=11.141..11.141 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=4.970..9.498 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.017..1.496 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=4.925..4.925 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.003..2.933 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=54.275..54.275 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.024..36.052 rows=36587 loops=1)
 Total runtime: 3585.468 ms
(72 rows)

-- Test Case 2 - 3913743 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
limit 300000;
                                                                                           QUERY PLAN                                                                                            
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2833.04..56335.12 rows=76141 width=279) (actual time=42.282..3233.892 rows=300000 loops=1)
   ->  Hash Join  (cost=2833.04..56335.12 rows=76141 width=279) (actual time=42.280..3161.777 rows=300000 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2830.89..52619.67 rows=228803 width=260) (actual time=42.167..1466.810 rows=300000 loops=1)
               Hash Cond: (receiver_deployment.receiver_id = receiver.id)
               ->  Hash Join  (cost=2454.55..47381.27 rows=228803 width=248) (actual time=35.350..1267.340 rows=300000 loops=1)
                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                     ->  Hash Join  (cost=2348.68..43843.36 rows=228803 width=152) (actual time=32.890..1056.806 rows=300000 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=31.361..886.832 rows=361328 loops=1)
                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                 ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.256..660.405 rows=361328 loops=1)
                                       ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.180..27.227 rows=47 loops=1)
                                             ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.142..26.893 rows=30 loops=1)
                                                   ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.031..26.424 rows=30 loops=1)
                                                         Hash Cond: (animal_release.id = surgery.release_id)
                                                         ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.066..24.388 rows=30 loops=1)
                                                               Hash Cond: (animal_release.animal_id = animal.id)
                                                               ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.144 rows=725 loops=1)
                                                               ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.967..23.967 rows=174 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                     ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.675..23.871 rows=174 loops=1)
                                                                           Hash Cond: (animal.species_id = species.id)
                                                                           ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.515 rows=4023 loops=1)
                                                                           ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.625..22.625 rows=1 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                 ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.707..22.617 rows=1 loops=1)
                                                                                       Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                       Rows Removed by Filter: 36586
                                                         ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.940..1.940 rows=3923 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.926 rows=3923 loops=1)
                                                   ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.011..0.012 rows=1 loops=30)
                                                         Index Cond: (id = surgery.tag_id)
                                                         Heap Fetches: 0
                                             ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.007..0.009 rows=2 loops=30)
                                                   Index Cond: (tag_id = tag.id)
                                       ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.034..9.269 rows=7688 loops=47)
                                             Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                 ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=5.089..5.089 rows=5710 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                       ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.005..3.715 rows=5710 loops=1)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.515..1.515 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.139..1.155 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.203 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.128..0.128 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.086 rows=173 loops=1)
                     ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.442..2.442 rows=1964 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 280kB
                           ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.161..1.649 rows=1964 loops=1)
                                 Hash Cond: (installation_station.installation_id = installation.id)
                                 ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.428 rows=1964 loops=1)
                                 ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.151..0.151 rows=110 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                       ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.051..0.113 rows=110 loops=1)
                                             Hash Cond: (installation.project_id = receiver_project.id)
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.014 rows=110 loops=1)
                                             ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.040..0.040 rows=75 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.015 rows=75 loops=1)
               ->  Hash  (cost=286.00..286.00 rows=7227 width=28) (actual time=6.803..6.803 rows=7227 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 389kB
                     ->  Hash Join  (cost=1.36..286.00 rows=7227 width=28) (actual time=0.021..4.828 rows=7227 loops=1)
                           Hash Cond: (receiver.model_id = device_model.id)
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.975 rows=7227 loops=1)
                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.042..0.042 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.024 rows=51 loops=1)
 Total runtime: 3272.750 ms
(75 rows)

-- Test Case 3 - 17098775 rows limited to first 100
explain analyze select * from detection_extract_test_view
where timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=348654.03..485452.46 rows=300000 width=279) (actual time=3654.513..6566.609 rows=300000 loops=1)
   ->  Hash Left Join  (cost=348654.03..2913890.97 rows=5625584 width=279) (actual time=3654.511..6496.235 rows=300000 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=346165.82..2295305.48 rows=5625584 width=239) (actual time=3613.001..4870.389 rows=303559 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=344912.31..2098995.76 rows=5287633 width=193) (actual time=3589.307..4585.167 rows=303555 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=344901.41..2025961.60 rows=5372518 width=187) (actual time=3589.137..4433.145 rows=303555 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=344899.27..1911692.91 rows=16144362 width=168) (actual time=3589.084..4274.226 rows=303555 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=344840.09..1689648.76 rows=16144362 width=168) (actual time=3588.320..4105.319 rows=303555 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=343912.28..1365833.71 rows=16144362 width=52) (actual time=3567.047..3809.150 rows=303555 loops=1)
                                             Recheck Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Index Recheck: 75042
                                             ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..339876.18 rows=16144362 width=0) (actual time=3565.498..3565.498 rows=16316319 loops=1)
                                                   Index Cond: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                       ->  Hash  (cost=856.44..856.44 rows=5710 width=132) (actual time=21.256..21.256 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 969kB
                                             ->  Hash Join  (cost=382.84..856.44 rows=5710 width=132) (actual time=6.253..18.115 rows=5710 loops=1)
                                                   Hash Cond: (receiver.model_id = device_model.id)
                                                   ->  Hash Join  (cost=381.48..776.56 rows=5710 width=135) (actual time=6.236..15.593 rows=5710 loops=1)
                                                         Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                         ->  Hash Join  (cost=105.87..379.62 rows=5710 width=120) (actual time=2.257..8.291 rows=5710 loops=1)
                                                               Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                               ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..0.924 rows=5710 loops=1)
                                                               ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.246..2.246 rows=1964 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 280kB
                                                                     ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.158..1.440 rows=1964 loops=1)
                                                                           Hash Cond: (installation_station.installation_id = installation.id)
                                                                           ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.265 rows=1964 loops=1)
                                                                           ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.148..0.148 rows=110 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                                                                 ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.052..0.111 rows=110 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.012 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.040..0.040 rows=75 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.010 rows=75 loops=1)
                                                         ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.966..3.966 rows=7227 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                               ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.003..2.121 rows=7227 loops=1)
                                                   ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.003 rows=16 loops=1)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.753..0.753 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.436 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.044..0.044 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.029 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.157..0.157 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.109 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=23.662..23.662 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=13.279..20.874 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.671..9.724 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.761..5.931 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.603 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.726..2.726 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.540 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.891..1.891 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.005..0.789 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=8.594..8.594 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.307..7.054 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.007..0.717 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.285..3.285 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.004..1.492 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.385..41.385 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.005..24.302 rows=36587 loops=1)
 Total runtime: 6601.746 ms
(82 rows)

-- Test Case 4 -  2716283 ^ 3913743 -> 1420919 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
limit 300000;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=4394.739..7781.741 rows=300000 loops=1)
   ->  Hash Join  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=4394.737..7709.813 rows=300000 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2613.26..42042.23 rows=3051 width=260) (actual time=4394.624..6016.377 rows=300000 loops=1)
               Hash Cond: (receiver.model_id = device_model.id)
               ->  Hash Join  (cost=2611.90..41998.91 rows=3051 width=263) (actual time=4394.606..5852.869 rows=300000 loops=1)
                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=4390.640..5644.865 rows=300000 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=4390.496..5475.894 rows=300000 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=4389.697..5304.688 rows=300000 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.323..4784.891 rows=2607933 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.368..3522.477 rows=2607933 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.332..30.129 rows=167 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.319..29.059 rows=122 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.295..27.787 rows=122 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.521..25.781 rows=121 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.440 rows=2525 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=24.435..24.435 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=23.179..24.385 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.511 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=23.153..23.153 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.155..23.145 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.760..1.760 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.908 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.007..0.007 rows=1 loops=122)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.006 rows=1 loops=122)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.027..13.572 rows=15616 loops=167)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.942..3.942 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.521 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.144..0.144 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.063..0.118 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.042..0.067 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.017 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.021 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.015..0.033 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.789..0.789 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.430 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.130..0.130 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.085 rows=173 loops=1)
                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.954..3.954 rows=7227 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.001..2.198 rows=7227 loops=1)
               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.042..0.042 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.023 rows=51 loops=1)
 Total runtime: 7820.899 ms
(75 rows)

-- Test Case 5 - 2716283 ^ 17098775 -> 902906 rows limited to first 100
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4127.15..128717.35 rows=75008 width=279) (actual time=65.119..4162.421 rows=300000 loops=1)
   ->  Hash Left Join  (cost=4127.15..128717.35 rows=75008 width=279) (actual time=65.118..4089.671 rows=300000 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=1638.94..117659.78 rows=75008 width=239) (actual time=23.754..2353.419 rows=305219 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=2.363..2071.062 rows=305204 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=2.217..1918.821 rows=305204 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=2.176..1768.774 rows=305204 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=1.396..1579.013 rows=305204 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.055..3.119 rows=124 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.051..2.373 rows=124 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.044..0.897 rows=124 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.035..0.123 rows=25 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.023..0.023 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 26
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.008 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                           Rows Removed by Filter: 8
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.005 rows=27 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.063 rows=25 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.010..0.021 rows=5 loops=25)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.008..0.009 rows=1 loops=124)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.004 rows=1 loops=124)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=9.136..11.722 rows=2461 loops=124)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 9575
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=1.972..1.972 rows=12635 loops=124)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.770..0.770 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.454 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.014 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.135..0.135 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.092 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=21.372..21.372 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=12.179..19.671 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.209..9.217 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.480..5.602 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.570 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.459..2.459 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.004..1.493 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.716..1.716 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.843 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=7.960..7.960 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=2.968..6.697 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.003..0.697 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=2.954..2.954 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.002..1.448 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.260..41.260 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..24.330 rows=36587 loops=1)
 Total runtime: 4197.616 ms
(73 rows)

-- Test Case 6 - 3913743 ^ 17098775 -> 2233756 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3206.38..41361.67 rows=23321 width=279) (actual time=45.314..3639.483 rows=300000 loops=1)
   ->  Hash Join  (cost=3206.38..41361.67 rows=23321 width=279) (actual time=45.312..3567.540 rows=300000 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=3204.23..40222.20 rows=70078 width=260) (actual time=45.183..1905.905 rows=300000 loops=1)
               Hash Cond: (receiver_deployment.receiver_id = receiver.id)
               ->  Hash Join  (cost=2827.89..38356.70 rows=70078 width=248) (actual time=38.446..1707.086 rows=300000 loops=1)
                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                     ->  Hash Join  (cost=2722.02..37199.66 rows=70078 width=152) (actual time=36.201..1509.514 rows=300000 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=34.620..1338.222 rows=300000 loops=1)
                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                 ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=30.773..1139.629 rows=300000 loops=1)
                                       ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.315..26.519 rows=78 loops=1)
                                             ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.301..26.046 rows=62 loops=1)
                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.274..25.560 rows=62 loops=1)
                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.091 rows=447 loops=1)
                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.247..25.247 rows=167 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.757..25.184 rows=167 loops=1)
                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.530 rows=3920 loops=1)
                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.672..23.672 rows=174 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.391..23.617 rows=174 loops=1)
                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.510 rows=4023 loops=1)
                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.365..22.365 rows=1 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.504..22.356 rows=1 loops=1)
                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                             Rows Removed by Filter: 36586
                                                   ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.005..0.006 rows=1 loops=62)
                                                         Index Cond: (id = surgery.tag_id)
                                                         Heap Fetches: 0
                                             ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=62)
                                                   Index Cond: (tag_id = tag.id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.857..12.768 rows=3846 loops=78)
                                             Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             Rows Removed by Index Recheck: 13962
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 3092
                                             ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=1.555..1.555 rows=8170 loops=78)
                                                   Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                 ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.833..3.833 rows=5710 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                       ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.486 rows=5710 loops=1)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.570..1.570 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.141..1.199 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.224 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.129..0.129 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.084 rows=173 loops=1)
                     ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.232..2.232 rows=1964 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 280kB
                           ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.156..1.361 rows=1964 loops=1)
                                 Hash Cond: (installation_station.installation_id = installation.id)
                                 ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.271 rows=1964 loops=1)
                                 ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.145..0.145 rows=110 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                       ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.050..0.111 rows=110 loops=1)
                                             Hash Cond: (installation.project_id = receiver_project.id)
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.015 rows=110 loops=1)
                                             ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.039..0.039 rows=75 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.015 rows=75 loops=1)
               ->  Hash  (cost=286.00..286.00 rows=7227 width=28) (actual time=6.727..6.727 rows=7227 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 389kB
                     ->  Hash Join  (cost=1.36..286.00 rows=7227 width=28) (actual time=0.020..4.737 rows=7227 loops=1)
                           Hash Cond: (receiver.model_id = device_model.id)
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.957 rows=7227 loops=1)
                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.006 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.051..0.051 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.020 rows=51 loops=1)
 Total runtime: 3673.956 ms
(80 rows)

-- Test Case 7 - 2716283 ^ 3913743 ^ 17098775 -> 690003 rows limited to first 100
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..37239.14 rows=311 width=279) (actual time=487.318..9361.719 rows=300000 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=487.316..9279.031 rows=300000 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=487.248..6693.898 rows=300000 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=487.240..5918.461 rows=300000 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=487.219..4613.209 rows=300000 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=485.590..4415.681 rows=300000 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=34.659..4059.078 rows=1394509 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=30.776..3343.373 rows=1394509 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.328..29.872 rows=190 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.315..28.415 rows=143 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.290..26.828 rows=143 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.489 rows=2839 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.265..25.265 rows=167 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.781..25.204 rows=167 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.535 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.696..23.696 rows=174 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.406..23.641 rows=174 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.516 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.380..22.380 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.513..22.370 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.007..0.008 rows=1 loops=143)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.008 rows=1 loops=143)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=2.989..14.935 rows=7340 loops=190)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Rows Removed by Index Recheck: 6386
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 5920
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=2.229..2.229 rows=13264 loops=190)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.871..3.871 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.573 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.129..0.129 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.049..0.111 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.034..0.058 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.018 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.017..0.017 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.017 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.012..0.026 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.614..1.614 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.149..1.194 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.225 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.135..0.135 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.084 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=300000)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=300000)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=300000)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 9404.507 ms
(74 rows)

 
-- High selectivity filtering (small number of rows returned for each filter)
-- Test Case 8 - 5909 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
limit 300000;
                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3815.07..169830.31 rows=244897 width=279) (actual time=68.695..133.952 rows=5909 loops=1)
   ->  Hash Left Join  (cost=3815.07..169830.31 rows=244897 width=279) (actual time=68.694..132.522 rows=5909 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=1326.86..140177.74 rows=244897 width=239) (actual time=23.056..48.282 rows=5909 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=73.35..130432.90 rows=230185 width=193) (actual time=1.401..21.479 rows=5874 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=62.46..127243.10 rows=233880 width=187) (actual time=1.254..18.457 rows=5874 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=60.31..122266.63 rows=702807 width=168) (actual time=1.212..15.378 rows=5874 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=1.13..112543.86 rows=702807 width=168) (actual time=0.447..10.903 rows=5874 loops=1)
                                       ->  Nested Loop  (cost=0.56..145.19 rows=76 width=132) (actual time=0.317..1.570 rows=64 loops=1)
                                             Join Filter: (receiver.model_id = device_model.id)
                                             Rows Removed by Join Filter: 960
                                             ->  Nested Loop  (cost=0.56..125.75 rows=76 width=135) (actual time=0.308..1.227 rows=64 loops=1)
                                                   ->  Nested Loop  (cost=0.28..94.39 rows=76 width=120) (actual time=0.301..0.868 rows=64 loops=1)
                                                         ->  Nested Loop  (cost=0.00..76.60 rows=26 width=104) (actual time=0.289..0.674 rows=15 loops=1)
                                                               Join Filter: (installation.id = installation_station.installation_id)
                                                               Rows Removed by Join Filter: 1949
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.021..0.061 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 109
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.007..0.019 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 74
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                               ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.002..0.271 rows=1964 loops=1)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.004..0.009 rows=4 loops=15)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=64)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=64)
                                                   ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.004 rows=16 loops=1)
                                       ->  Index Scan using valid_detection_receiver_deployment_index on valid_detection  (cost=0.56..1202.23 rows=27670 width=52) (actual time=0.014..0.098 rows=92 loops=64)
                                             Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.755..0.755 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.406 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.019 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.137..0.137 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.086 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=21.637..21.637 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=12.294..19.878 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.289..9.472 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.579..5.854 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.630 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.557..2.557 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.633 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.697..1.697 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.851 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=7.997..7.997 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.000..6.692 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.003..0.673 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=2.987..2.987 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.002..1.454 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=45.535..45.535 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..24.146 rows=36587 loops=1)
 Total runtime: 135.021 ms
(72 rows)

-- Test Case 9 - 2153 rows
set geqo_threshold to 12;
SET
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
limit 300000;
                                                                                           QUERY PLAN                                                                                           
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2833.04..56335.12 rows=76141 width=279) (actual time=40.296..65.220 rows=2153 loops=1)
   ->  Hash Join  (cost=2833.04..56335.12 rows=76141 width=279) (actual time=40.294..64.688 rows=2153 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2830.89..52619.67 rows=228803 width=260) (actual time=40.182..52.510 rows=2153 loops=1)
               Hash Cond: (receiver_deployment.receiver_id = receiver.id)
               ->  Hash Join  (cost=2454.55..47381.27 rows=228803 width=248) (actual time=33.341..44.305 rows=2153 loops=1)
                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                     ->  Hash Join  (cost=2348.68..43843.36 rows=228803 width=152) (actual time=31.092..40.626 rows=2153 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=29.574..37.901 rows=2153 loops=1)
                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                 ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=25.674..32.533 rows=2153 loops=1)
                                       ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=25.539..27.336 rows=27 loops=1)
                                             ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=25.525..27.196 rows=27 loops=1)
                                                   ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=25.498..27.053 rows=27 loops=1)
                                                         Hash Cond: (animal_release.id = surgery.release_id)
                                                         ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.737..25.259 rows=27 loops=1)
                                                               Hash Cond: (animal_release.animal_id = animal.id)
                                                               ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.604 rows=3920 loops=1)
                                                               ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.723..23.723 rows=35 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.549..23.707 rows=35 loops=1)
                                                                           Hash Cond: (animal.species_id = species.id)
                                                                           ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.527 rows=4023 loops=1)
                                                                           ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.516..22.516 rows=1 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                 ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.605..22.507 rows=1 loops=1)
                                                                                       Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                       Rows Removed by Filter: 36586
                                                         ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.747..1.747 rows=3923 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.897 rows=3923 loops=1)
                                                   ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=27)
                                                         Index Cond: (id = surgery.tag_id)
                                                         Heap Fetches: 0
                                             ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=27)
                                                   Index Cond: (tag_id = tag.id)
                                       ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.023..0.146 rows=80 loops=27)
                                             Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                 ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.887..3.887 rows=5710 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                       ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.535 rows=5710 loops=1)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.507..1.507 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.150..1.140 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.195 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.140..0.140 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.091 rows=173 loops=1)
                     ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.235..2.235 rows=1964 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 280kB
                           ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.158..1.427 rows=1964 loops=1)
                                 Hash Cond: (installation_station.installation_id = installation.id)
                                 ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.274 rows=1964 loops=1)
                                 ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.148..0.148 rows=110 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                       ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.051..0.115 rows=110 loops=1)
                                             Hash Cond: (installation.project_id = receiver_project.id)
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                             ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.040..0.040 rows=75 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.020 rows=75 loops=1)
               ->  Hash  (cost=286.00..286.00 rows=7227 width=28) (actual time=6.828..6.828 rows=7227 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 389kB
                     ->  Hash Join  (cost=1.36..286.00 rows=7227 width=28) (actual time=0.021..4.922 rows=7227 loops=1)
                           Hash Cond: (receiver.model_id = device_model.id)
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.969 rows=7227 loops=1)
                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.042..0.042 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.022 rows=51 loops=1)
 Total runtime: 65.786 ms
(75 rows)

-- Test Case 10 - 1065 rows
explain analyze select * from detection_extract_test_view
  where timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 300000;
                                                                                                                               QUERY PLAN                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4862.46..5832.53 rows=488 width=279) (actual time=32.970..45.675 rows=1065 loops=1)
   ->  Nested Loop Left Join  (cost=4862.46..5832.53 rows=488 width=279) (actual time=32.968..45.408 rows=1065 loops=1)
         ->  Hash Right Join  (cost=4862.17..4952.37 rows=488 width=239) (actual time=32.880..34.638 rows=1065 loops=1)
               Hash Cond: (animal.id = animal_release.animal_id)
               ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.531 rows=4023 loops=1)
               ->  Hash  (cost=4856.07..4856.07 rows=488 width=239) (actual time=32.602..32.602 rows=1065 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 352kB
                     ->  Nested Loop Left Join  (cost=4528.01..4856.07 rows=488 width=239) (actual time=26.191..31.509 rows=1065 loops=1)
                           ->  Hash Right Join  (cost=4527.73..4641.32 rows=488 width=215) (actual time=26.166..27.997 rows=1065 loops=1)
                                 Hash Cond: (surgery.tag_id = tag.id)
                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.503 rows=3923 loops=1)
                                 ->  Hash  (cost=4521.63..4521.63 rows=488 width=215) (actual time=26.013..26.013 rows=1065 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 327kB
                                       ->  Nested Loop Left Join  (cost=867.27..4521.63 rows=488 width=215) (actual time=13.124..24.780 rows=1065 loops=1)
                                             ->  Hash Left Join  (cost=866.99..4359.32 rows=488 width=215) (actual time=13.072..21.336 rows=1065 loops=1)
                                                   Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   ->  Hash Join  (cost=686.58..4161.98 rows=459 width=193) (actual time=10.273..17.644 rows=1065 loops=1)
                                                         Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                                         ->  Hash Join  (cost=675.68..4144.75 rows=466 width=187) (actual time=10.131..16.918 rows=1065 loops=1)
                                                               Hash Cond: (receiver.organisation_id = organisation.id)
                                                               ->  Hash Join  (cost=673.54..4132.70 rows=1400 width=168) (actual time=10.087..16.300 rows=1065 loops=1)
                                                                     Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                                                     ->  Hash Join  (cost=614.36..4054.27 rows=1400 width=168) (actual time=9.265..14.843 rows=1065 loops=1)
                                                                           Hash Cond: (receiver.model_id = device_model.id)
                                                                           ->  Hash Join  (cost=613.00..4033.66 rows=1400 width=171) (actual time=9.245..14.261 rows=1065 loops=1)
                                                                                 Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                                                                                 ->  Hash Join  (cost=337.39..3728.30 rows=1400 width=156) (actual time=5.255..9.492 rows=1065 loops=1)
                                                                                       Hash Cond: (installation.project_id = receiver_project.id)
                                                                                       ->  Hash Join  (cost=334.70..3706.36 rows=1400 width=125) (actual time=5.202..8.857 rows=1065 loops=1)
                                                                                             Hash Cond: (installation_station.installation_id = installation.id)
                                                                                             ->  Hash Join  (cost=330.23..3682.64 rows=1400 width=109) (actual time=5.132..8.198 rows=1065 loops=1)
                                                                                                   Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                                                                                   ->  Hash Join  (cost=260.04..3591.45 rows=1400 width=60) (actual time=4.054..6.454 rows=1065 loops=1)
                                                                                                         Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                                                         ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.103..1.495 rows=1065 loops=1)
                                                                                                               Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                                         ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.931..3.931 rows=5710 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                                                                               ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.567 rows=5710 loops=1)
                                                                                                   ->  Hash  (cost=45.64..45.64 rows=1964 width=57) (actual time=1.068..1.068 rows=1964 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 179kB
                                                                                                         ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.004..0.500 rows=1964 loops=1)
                                                                                             ->  Hash  (cost=3.10..3.10 rows=110 width=32) (actual time=0.061..0.061 rows=110 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 8kB
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.024 rows=110 loops=1)
                                                                                       ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.041..0.041 rows=75 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.003..0.019 rows=75 loops=1)
                                                                                 ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.983..3.983 rows=7227 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 415kB
                                                                                       ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.003..2.196 rows=7227 loops=1)
                                                                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.006 rows=16 loops=1)
                                                                     ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.814..0.814 rows=1519 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                                                           ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.464 rows=1519 loops=1)
                                                               ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.034..0.034 rows=51 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                     ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.023 rows=51 loops=1)
                                                         ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.134..0.134 rows=173 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.006..0.090 rows=173 loops=1)
                                                   ->  Hash  (cost=114.07..114.07 rows=5307 width=22) (actual time=2.783..2.783 rows=5307 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                                         ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.005..1.382 rows=5307 loops=1)
                                             ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=1065)
                                                   Index Cond: (id = sensor.tag_id)
                                                   Heap Fetches: 0
                           ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=1065)
                                 Index Cond: (surgery.release_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=1065)
               Index Cond: (animal.species_id = id)
 Total runtime: 46.137 ms
(74 rows)

-- Test Case 11 - 5909 ^ 2153 -> 609 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
limit 300000;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=38.612..45.906 rows=609 loops=1)
   ->  Hash Join  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=38.611..45.757 rows=609 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2613.26..42042.23 rows=3051 width=260) (actual time=38.500..42.274 rows=609 loops=1)
               Hash Cond: (receiver.model_id = device_model.id)
               ->  Hash Join  (cost=2611.90..41998.91 rows=3051 width=263) (actual time=38.481..41.935 rows=609 loops=1)
                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=34.539..37.529 rows=609 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=34.397..37.070 rows=609 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=33.636..35.979 rows=609 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.172..35.255 rows=2153 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.200..30.159 rows=2153 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.152..27.787 rows=27 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.138..27.666 rows=27 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.113..27.546 rows=27 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.359..25.759 rows=27 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.525 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=24.344..24.344 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=23.192..24.327 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.515 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=23.159..23.159 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.162..23.152 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.740..1.740 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.894 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=27)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=27)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.007..0.051 rows=80 loops=27)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.957..3.957 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.553 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.108..0.108 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.062..0.101 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.043..0.068 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.014 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.014..0.025 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.751..0.751 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.399 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.128..0.128 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.083 rows=173 loops=1)
                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.931..3.931 rows=7227 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.131 rows=7227 loops=1)
               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.022 rows=51 loops=1)
 Total runtime: 46.282 ms
(75 rows)

-- Test Case 12 - 5909 ^ 1065 -> 55 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 300000;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.587..3.892 rows=55 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3384.54 rows=6 width=279) (actual time=0.586..3.872 rows=55 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3373.72 rows=6 width=239) (actual time=0.537..3.270 rows=55 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3371.58 rows=6 width=239) (actual time=0.518..3.063 rows=55 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3368.94 rows=6 width=215) (actual time=0.511..2.872 rows=55 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3366.85 rows=6 width=215) (actual time=0.488..2.669 rows=55 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3364.85 rows=6 width=215) (actual time=0.480..2.498 rows=55 loops=1)
                                       ->  Nested Loop  (cost=27.78..3361.41 rows=6 width=193) (actual time=0.423..2.196 rows=55 loops=1)
                                             ->  Nested Loop  (cost=27.63..3360.22 rows=6 width=187) (actual time=0.418..2.034 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3356.96 rows=19 width=168) (actual time=0.415..1.889 rows=55 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3349.38 rows=19 width=168) (actual time=0.410..1.700 rows=55 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 825
                                                               ->  Nested Loop  (cost=27.21..3343.62 rows=19 width=171) (actual time=0.403..1.415 rows=55 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3335.78 rows=19 width=156) (actual time=0.395..1.175 rows=55 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.026..0.667 rows=1065 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.251..0.251 rows=64 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.059..0.216 rows=64 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.051..0.089 rows=15 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.041..0.066 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.017 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.018 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.006..0.015 rows=15 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.006 rows=4 loops=15)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=55)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=55)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.56 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=55)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.002..0.002 rows=1 loops=55)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.003 rows=1 loops=55)
               Index Cond: (animal.species_id = id)
 Total runtime: 4.208 ms
(58 rows)

-- Test Case 13 -  2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 300000;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.69..5500.06 rows=2 width=279) (actual time=33.136..34.235 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.69..5500.06 rows=2 width=279) (actual time=33.135..34.226 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.004..0.010 rows=51 loops=1)
         ->  Materialize  (cost=2141.69..5493.92 rows=6 width=260) (actual time=0.621..0.642 rows=55 loops=51)
               ->  Nested Loop  (cost=2141.69..5493.89 rows=6 width=260) (actual time=31.645..32.423 rows=55 loops=1)
                     ->  Nested Loop  (cost=2141.55..5492.70 rows=6 width=254) (actual time=31.636..32.269 rows=55 loops=1)
                           ->  Nested Loop  (cost=2141.27..5490.31 rows=6 width=254) (actual time=31.625..32.084 rows=55 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 825
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=1)
                                 ->  Materialize  (cost=2141.27..5487.72 rows=6 width=257) (actual time=1.775..1.980 rows=55 loops=16)
                                       ->  Nested Loop  (cost=2141.27..5487.69 rows=6 width=257) (actual time=28.393..31.547 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.99..5485.22 rows=6 width=242) (actual time=28.384..31.358 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.84..5483.53 rows=6 width=211) (actual time=28.375..31.207 rows=55 loops=1)
                                                         Join Filter: (installation_station.installation_id = installation.id)
                                                         Rows Removed by Join Filter: 5995
                                                         ->  Index Scan using installation_project_id_index on installation  (cost=0.14..16.50 rows=110 width=32) (actual time=0.005..0.043 rows=110 loops=1)
                                                         ->  Materialize  (cost=2140.70..5457.14 rows=6 width=195) (actual time=0.244..0.262 rows=55 loops=110)
                                                               ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.797..28.158 rows=55 loops=1)
                                                                     ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.786..27.968 rows=55 loops=1)
                                                                           ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.728..27.721 rows=55 loops=1)
                                                                                 ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.714..27.548 rows=55 loops=1)
                                                                                       Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                                                       ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.025..0.636 rows=1065 loops=1)
                                                                                             Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                                                       ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.548..26.548 rows=27 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                                             ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.200..26.529 rows=27 loops=1)
                                                                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.175..26.372 rows=27 loops=1)
                                                                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.506 rows=3923 loops=1)
                                                                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.148..25.148 rows=27 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.658..25.130 rows=27 loops=1)
                                                                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.602 rows=3920 loops=1)
                                                                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.646..23.646 rows=35 loops=1)
                                                                                                                           Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.492..23.628 rows=35 loops=1)
                                                                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.476 rows=4023 loops=1)
                                                                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.460..22.460 rows=1 loops=1)
                                                                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.557..22.453 rows=1 loops=1)
                                                                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                                             Rows Removed by Filter: 36586
                                                                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=27)
                                                                                                         Index Cond: (tag_id = surgery.tag_id)
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=55)
                                                                                       Index Cond: (id = sensor.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=55)
                                                                                 Index Cond: (id = valid_detection.receiver_deployment_id)
                                                                     ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=55)
                                                                           Index Cond: (id = receiver_deployment.station_id)
                                                   ->  Index Scan using project_pkey on project receiver_project  (cost=0.14..0.27 rows=1 width=39) (actual time=0.002..0.002 rows=1 loops=55)
                                                         Index Cond: (id = installation.project_id)
                                             ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=55)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.002 rows=1 loops=55)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 34.573 ms
(66 rows)

-- Test Case 14 -  5909 ^ 2153 ^ 1065 -> 55 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2014-07-30 12:00:00+00' and '2014-07-30 18:00:00+00'
limit 300000;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.956..33.251 rows=55 loops=1)
   ->  Nested Loop  (cost=2141.26..5478.84 rows=1 width=279) (actual time=26.954..33.238 rows=55 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2750
         ->  Nested Loop  (cost=2141.26..5476.66 rows=1 width=260) (actual time=26.881..31.992 rows=55 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 9460
               ->  Nested Loop  (cost=2141.26..5465.77 rows=1 width=254) (actual time=26.811..29.105 rows=55 loops=1)
                     ->  Nested Loop  (cost=2140.98..5465.37 rows=1 width=254) (actual time=26.801..28.895 rows=55 loops=1)
                           Join Filter: (receiver.model_id = device_model.id)
                           Rows Removed by Join Filter: 825
                           ->  Nested Loop  (cost=2140.98..5464.01 rows=1 width=257) (actual time=26.788..28.539 rows=55 loops=1)
                                 ->  Nested Loop  (cost=2140.70..5463.60 rows=1 width=242) (actual time=26.778..28.343 rows=55 loops=1)
                                       Join Filter: (installation_station.installation_id = installation.id)
                                       ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.025..0.065 rows=1 loops=1)
                                             Join Filter: (installation.project_id = receiver_project.id)
                                             Rows Removed by Join Filter: 109
                                             ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.023 rows=1 loops=1)
                                                   Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                   Rows Removed by Filter: 74
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                       ->  Nested Loop  (cost=2140.70..5457.11 rows=6 width=195) (actual time=26.747..28.248 rows=55 loops=1)
                                             ->  Nested Loop  (cost=2140.42..5455.12 rows=6 width=146) (actual time=26.737..28.054 rows=55 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..5450.59 rows=6 width=138) (actual time=26.726..27.844 rows=55 loops=1)
                                                         ->  Hash Join  (cost=2139.86..5448.58 rows=6 width=154) (actual time=26.711..27.615 rows=55 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3303.97 rows=1400 width=52) (actual time=0.026..0.658 rows=1065 loops=1)
                                                                     Index Cond: (("timestamp" >= '2014-07-30 12:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2014-07-30 18:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.544..26.544 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.235..26.517 rows=27 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.211..26.387 rows=27 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.464 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.181..25.181 rows=27 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.736..25.162 rows=27 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.567 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.724..23.724 rows=35 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.553..23.708 rows=35 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.496 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.521..22.521 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.618..22.514 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=27)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=55)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.75 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=55)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=55)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                 ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=55)
                                       Index Cond: (id = receiver_deployment.receiver_id)
                           ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=55)
                     ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.39 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=55)
                           Index Cond: (id = valid_detection.receiver_download_id)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.026 rows=173 loops=55)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=55)
 Total runtime: 33.558 ms
(66 rows)

-- Mixed selectivity filtering
-- Test Case 15 - 5909 ^ 833188 -> 184 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
limit 300000;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=52.549..1665.852 rows=184 loops=1)
   ->  Hash Join  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=52.548..1665.793 rows=184 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2613.26..42042.23 rows=3051 width=260) (actual time=52.436..1663.956 rows=184 loops=1)
               Hash Cond: (receiver.model_id = device_model.id)
               ->  Hash Join  (cost=2611.90..41998.91 rows=3051 width=263) (actual time=52.416..1663.779 rows=184 loops=1)
                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=48.474..1659.605 rows=184 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=48.332..1659.311 rows=184 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=47.569..1658.377 rows=184 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=30.366..1535.246 rows=833188 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=26.400..1146.333 rows=833188 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=26.288..30.752 rows=147 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=26.274..29.703 rows=119 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=26.249..28.359 rows=119 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.427..26.283 rows=117 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.683 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=24.387..24.387 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=23.265..24.327 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.526 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=23.112..23.112 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.807..23.103 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.807..1.807 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.958 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.007..0.008 rows=1 loops=119)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.005..0.007 rows=1 loops=119)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.031..5.149 rows=5668 loops=147)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.953..3.953 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.478 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.106..0.106 rows=15 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.061..0.100 rows=15 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.042..0.067 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.018 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.023..0.023 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.012..0.022 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.014..0.023 rows=15 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.754..0.754 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.418 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.128..0.128 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.077 rows=173 loops=1)
                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.931..3.931 rows=7227 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.117 rows=7227 loops=1)
               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.005 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.040..0.040 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.006..0.025 rows=51 loops=1)
 Total runtime: 1666.175 ms
(75 rows)

-- Test Case 16 - 5909 ^ 17098775 -> 3889 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=4127.15..128717.35 rows=75008 width=279) (actual time=64.195..105.592 rows=3889 loops=1)
   ->  Hash Left Join  (cost=4127.15..128717.35 rows=75008 width=279) (actual time=64.193..104.653 rows=3889 loops=1)
         Hash Cond: (animal.species_id = species.id)
         ->  Hash Left Join  (cost=1638.94..117659.78 rows=75008 width=239) (actual time=22.804..38.830 rows=3889 loops=1)
               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
               ->  Hash Join  (cost=385.43..113805.51 rows=70502 width=193) (actual time=1.343..14.125 rows=3854 loops=1)
                     Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                     ->  Hash Join  (cost=374.54..112820.97 rows=71634 width=187) (actual time=1.197..11.975 rows=3854 loops=1)
                           Hash Cond: (receiver.organisation_id = organisation.id)
                           ->  Hash Join  (cost=372.39..111295.26 rows=215258 width=168) (actual time=1.157..10.066 rows=3854 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Nested Loop  (cost=313.21..108276.29 rows=215258 width=168) (actual time=0.375..6.866 rows=3854 loops=1)
                                       ->  Nested Loop  (cost=0.98..70.39 rows=76 width=132) (actual time=0.050..0.779 rows=64 loops=1)
                                             ->  Nested Loop  (cost=0.84..57.72 rows=76 width=135) (actual time=0.046..0.588 rows=64 loops=1)
                                                   ->  Nested Loop  (cost=0.56..26.36 rows=76 width=120) (actual time=0.041..0.267 rows=64 loops=1)
                                                         ->  Nested Loop  (cost=0.28..8.57 rows=26 width=104) (actual time=0.033..0.096 rows=15 loops=1)
                                                               ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.022..0.065 rows=1 loops=1)
                                                                     Join Filter: (installation.project_id = receiver_project.id)
                                                                     Rows Removed by Join Filter: 109
                                                                     ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.008..0.019 rows=1 loops=1)
                                                                           Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                                           Rows Removed by Filter: 74
                                                                     ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.003..0.020 rows=110 loops=1)
                                                               ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.009..0.017 rows=15 loops=1)
                                                                     Index Cond: (installation_id = installation.id)
                                                         ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.008 rows=4 loops=15)
                                                               Index Cond: (station_id = installation_station.id)
                                                   ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.004 rows=1 loops=64)
                                                         Index Cond: (id = receiver_deployment.receiver_id)
                                             ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=64)
                                                   Index Cond: (id = receiver.model_id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=312.23..1339.01 rows=8475 width=52) (actual time=0.030..0.071 rows=60 loops=64)
                                             Recheck Cond: (receiver_deployment_id = receiver_deployment.id)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 32
                                             ->  Bitmap Index Scan on valid_detection_receiver_deployment_index  (cost=0.00..310.12 rows=27670 width=0) (actual time=0.015..0.015 rows=92 loops=64)
                                                   Index Cond: (receiver_deployment_id = receiver_deployment.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.773..0.773 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.460 rows=1519 loops=1)
                           ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.033..0.033 rows=51 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 4kB
                                 ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.021 rows=51 loops=1)
                     ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.135..0.135 rows=173 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 10kB
                           ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.005..0.083 rows=173 loops=1)
               ->  Hash  (cost=1187.18..1187.18 rows=5307 width=46) (actual time=21.444..21.444 rows=5488 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 386kB
                     ->  Hash Right Join  (cost=890.51..1187.18 rows=5307 width=46) (actual time=12.187..19.714 rows=5488 loops=1)
                           Hash Cond: (surgery.tag_id = tag.id)
                           ->  Hash Left Join  (cost=321.72..555.25 rows=3923 width=40) (actual time=4.167..9.133 rows=3923 loops=1)
                                 Hash Cond: (animal_release.animal_id = animal.id)
                                 ->  Hash Left Join  (cost=201.20..366.08 rows=3923 width=40) (actual time=2.490..5.601 rows=3923 loops=1)
                                       Hash Cond: (surgery.release_id = animal_release.id)
                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.536 rows=3923 loops=1)
                                       ->  Hash  (cost=152.20..152.20 rows=3920 width=32) (actual time=2.466..2.466 rows=3920 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 241kB
                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..1.517 rows=3920 loops=1)
                                 ->  Hash  (cost=70.23..70.23 rows=4023 width=16) (actual time=1.667..1.667 rows=4023 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 189kB
                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.821 rows=4023 loops=1)
                           ->  Hash  (cost=502.45..502.45 rows=5307 width=22) (actual time=8.011..8.011 rows=5307 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 291kB
                                 ->  Hash Left Join  (cost=275.61..502.45 rows=5307 width=22) (actual time=3.024..6.763 rows=5307 loops=1)
                                       Hash Cond: (sensor.tag_id = tag.id)
                                       ->  Seq Scan on sensor  (cost=0.00..114.07 rows=5307 width=22) (actual time=0.002..0.709 rows=5307 loops=1)
                                       ->  Hash  (cost=185.27..185.27 rows=7227 width=8) (actual time=3.010..3.010 rows=7227 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 283kB
                                             ->  Seq Scan on device tag  (cost=0.00..185.27 rows=7227 width=8) (actual time=0.002..1.486 rows=7227 loops=1)
         ->  Hash  (cost=1672.87..1672.87 rows=36587 width=56) (actual time=41.284..41.284 rows=36587 loops=1)
               Buckets: 2048  Batches: 4  Memory Usage: 824kB
               ->  Seq Scan on species  (cost=0.00..1672.87 rows=36587 width=56) (actual time=0.006..24.310 rows=36587 loops=1)
 Total runtime: 106.334 ms
(73 rows)

-- Test Case 17 - 2716283 ^ 464 -> 448 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
limit 300000;
                                                                                                        QUERY PLAN                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=36.326..42.492 rows=448 loops=1)
   ->  Hash Join  (cost=2615.40..42093.88 rows=1015 width=279) (actual time=36.324..42.361 rows=448 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=2613.26..42042.23 rows=3051 width=260) (actual time=36.213..39.751 rows=448 loops=1)
               Hash Cond: (receiver.model_id = device_model.id)
               ->  Hash Join  (cost=2611.90..41998.91 rows=3051 width=263) (actual time=36.194..39.505 rows=448 loops=1)
                     Hash Cond: (receiver_deployment.receiver_id = receiver.id)
                     ->  Hash Join  (cost=2336.29..41658.47 rows=3051 width=248) (actual time=32.250..35.246 rows=448 loops=1)
                           Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                           ->  Hash Join  (cost=2325.40..41605.45 rows=3100 width=242) (actual time=32.108..34.869 rows=448 loops=1)
                                 Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                                 ->  Hash Join  (cost=2266.22..41503.64 rows=3100 width=242) (actual time=31.334..33.817 rows=448 loops=1)
                                       Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                       ->  Hash Join  (cost=2258.26..40593.12 rows=232476 width=146) (actual time=31.172..33.414 rows=464 loops=1)
                                             Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                             ->  Nested Loop  (cost=1998.79..35684.13 rows=232476 width=138) (actual time=27.167..29.064 rows=464 loops=1)
                                                   ->  Nested Loop  (cost=1998.22..2179.34 rows=22 width=86) (actual time=27.082..27.847 rows=24 loops=1)
                                                         ->  Nested Loop  (cost=1997.94..2172.06 rows=20 width=88) (actual time=27.068..27.719 rows=20 loops=1)
                                                               ->  Hash Join  (cost=1997.66..2165.20 rows=20 width=80) (actual time=27.042..27.607 rows=20 loops=1)
                                                                     Hash Cond: (animal_release.id = surgery.release_id)
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=25.242..25.783 rows=20 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.528 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=24.346..24.346 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=23.288..24.334 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.004..0.508 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=23.132..23.132 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.696..23.126 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                                     ->  Hash  (cost=96.23..96.23 rows=3923 width=16) (actual time=1.786..1.786 rows=3923 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 184kB
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.004..0.937 rows=3923 loops=1)
                                                               ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.004..0.004 rows=1 loops=20)
                                                                     Index Cond: (id = surgery.tag_id)
                                                                     Heap Fetches: 0
                                                         ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.005 rows=1 loops=20)
                                                               Index Cond: (tag_id = tag.id)
                                                   ->  Index Scan using valid_transmitterid_index on valid_detection  (cost=0.56..1262.77 rows=26017 width=52) (actual time=0.012..0.038 rows=19 loops=24)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.989..3.989 rows=5710 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                                   ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.524 rows=5710 loops=1)
                                       ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.146..0.146 rows=45 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                             ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.064..0.126 rows=45 loops=1)
                                                   ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.043..0.069 rows=1 loops=1)
                                                         Hash Cond: (installation.project_id = receiver_project.id)
                                                         ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                         ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.021..0.021 rows=1 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                               ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.020 rows=1 loops=1)
                                                                     Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                     Rows Removed by Filter: 74
                                                   ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.017..0.041 rows=45 loops=1)
                                                         Index Cond: (installation_id = installation.id)
                                 ->  Hash  (cost=40.19..40.19 rows=1519 width=16) (actual time=0.763..0.763 rows=1519 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 72kB
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.003..0.420 rows=1519 loops=1)
                           ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.130..0.130 rows=173 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                 ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.086 rows=173 loops=1)
                     ->  Hash  (cost=185.27..185.27 rows=7227 width=31) (actual time=3.933..3.933 rows=7227 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 415kB
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..2.220 rows=7227 loops=1)
               ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.010..0.010 rows=16 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.020 rows=51 loops=1)
 Total runtime: 42.852 ms
(75 rows)

-- Test Case 18 - 2716283 ^ 2005 -> 4 rows
explain analyze select * from detection_extract_test_view
where project = 'AATAMS Heron Island'
  and timestamp between '2013-06-08 00:00:00+00' and '2013-06-08 01:00:00+00'
limit 300000;
                                                                                                                             QUERY PLAN                                                                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.653..3.330 rows=4 loops=1)
   ->  Nested Loop Left Join  (cost=29.47..3896.81 rows=7 width=279) (actual time=2.652..3.327 rows=4 loops=1)
         ->  Nested Loop Left Join  (cost=29.18..3884.18 rows=7 width=239) (actual time=2.595..3.238 rows=4 loops=1)
               ->  Nested Loop Left Join  (cost=28.90..3881.69 rows=7 width=239) (actual time=2.575..3.208 rows=4 loops=1)
                     ->  Nested Loop Left Join  (cost=28.62..3878.61 rows=7 width=215) (actual time=2.566..3.187 rows=4 loops=1)
                           ->  Nested Loop Left Join  (cost=28.34..3876.17 rows=7 width=215) (actual time=2.546..3.157 rows=4 loops=1)
                                 ->  Nested Loop Left Join  (cost=28.06..3873.84 rows=7 width=215) (actual time=2.537..3.136 rows=4 loops=1)
                                       ->  Nested Loop  (cost=27.78..3870.07 rows=7 width=193) (actual time=2.513..3.096 rows=4 loops=1)
                                             ->  Nested Loop  (cost=27.63..3868.68 rows=7 width=187) (actual time=2.506..3.081 rows=4 loops=1)
                                                   ->  Nested Loop  (cost=27.49..3864.90 rows=22 width=168) (actual time=2.501..3.066 rows=4 loops=1)
                                                         ->  Nested Loop  (cost=27.21..3856.39 rows=22 width=168) (actual time=2.479..3.034 rows=4 loops=1)
                                                               Join Filter: (receiver.model_id = device_model.id)
                                                               Rows Removed by Join Filter: 60
                                                               ->  Nested Loop  (cost=27.21..3849.91 rows=22 width=171) (actual time=2.468..2.997 rows=4 loops=1)
                                                                     ->  Hash Join  (cost=26.93..3840.83 rows=22 width=156) (actual time=2.459..2.972 rows=4 loops=1)
                                                                           Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                                                           ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..3808.21 rows=1613 width=52) (actual time=0.089..1.916 rows=1839 loops=1)
                                                                                 Index Cond: (("timestamp" >= '2013-06-08 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-06-08 01:00:00+00'::timestamp with time zone))
                                                                           ->  Hash  (cost=25.42..25.42 rows=76 width=120) (actual time=0.710..0.710 rows=282 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 38kB
                                                                                 ->  Nested Loop  (cost=2.51..25.42 rows=76 width=120) (actual time=0.061..0.563 rows=282 loops=1)
                                                                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.053..0.117 rows=45 loops=1)
                                                                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.042..0.067 rows=1 loops=1)
                                                                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.004..0.011 rows=110 loops=1)
                                                                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.022..0.022 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.009..0.019 rows=1 loops=1)
                                                                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                                                                               Rows Removed by Filter: 74
                                                                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.008..0.034 rows=45 loops=1)
                                                                                                   Index Cond: (installation_id = installation.id)
                                                                                       ->  Index Scan using receiver_deployment_installation_station_id_index on receiver_deployment  (cost=0.28..0.65 rows=3 width=24) (actual time=0.003..0.007 rows=6 loops=45)
                                                                                             Index Cond: (station_id = installation_station.id)
                                                                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                                                                           Index Cond: (id = receiver_deployment.receiver_id)
                                                               ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.002..0.004 rows=16 loops=4)
                                                                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.007 rows=16 loops=1)
                                                         ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.38 rows=1 width=16) (actual time=0.007..0.007 rows=1 loops=4)
                                                               Index Cond: (id = valid_detection.receiver_download_id)
                                                   ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=4)
                                                         Index Cond: (id = receiver.organisation_id)
                                             ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.002..0.003 rows=1 loops=4)
                                                   Index Cond: (id = receiver_download_file.requesting_user_id)
                                       ->  Index Scan using transmitter_id_index on sensor  (cost=0.28..0.53 rows=1 width=22) (actual time=0.008..0.009 rows=1 loops=4)
                                             Index Cond: ((valid_detection.transmitter_id)::text = (transmitter_id)::text)
                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.32 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=4)
                                       Index Cond: (id = sensor.tag_id)
                                       Heap Fetches: 0
                           ->  Index Scan using tag_id_index on surgery  (cost=0.28..0.34 rows=1 width=16) (actual time=0.006..0.006 rows=1 loops=4)
                                 Index Cond: (tag.id = tag_id)
                     ->  Index Scan using animal_release_pkey on animal_release  (cost=0.28..0.43 rows=1 width=32) (actual time=0.003..0.004 rows=1 loops=4)
                           Index Cond: (surgery.release_id = id)
               ->  Index Scan using animal_pkey on animal  (cost=0.28..0.35 rows=1 width=16) (actual time=0.006..0.007 rows=1 loops=4)
                     Index Cond: (animal_release.animal_id = id)
         ->  Index Scan using species_pkey on species  (cost=0.29..1.77 rows=1 width=56) (actual time=0.003..0.004 rows=1 loops=4)
               Index Cond: (animal.species_id = id)
 Total runtime: 3.637 ms
(58 rows)

-- Test Case 19 - 464 ^ 17098775 -> 6 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                            QUERY PLAN                                                                                             
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=3206.38..41361.67 rows=23321 width=279) (actual time=39.763..41.723 rows=6 loops=1)
   ->  Hash Join  (cost=3206.38..41361.67 rows=23321 width=279) (actual time=39.761..41.720 rows=6 loops=1)
         Hash Cond: (receiver.organisation_id = organisation.id)
         ->  Hash Join  (cost=3204.23..40222.20 rows=70078 width=260) (actual time=39.652..41.574 rows=6 loops=1)
               Hash Cond: (receiver_deployment.receiver_id = receiver.id)
               ->  Hash Join  (cost=2827.89..38356.70 rows=70078 width=248) (actual time=32.888..34.804 rows=6 loops=1)
                     Hash Cond: (receiver_deployment.station_id = installation_station.id)
                     ->  Hash Join  (cost=2722.02..37199.66 rows=70078 width=152) (actual time=30.643..32.557 rows=6 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.075..30.983 rows=6 loops=1)
                                 Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                 ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.211..27.112 rows=6 loops=1)
                                       ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.170..26.404 rows=24 loops=1)
                                             ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.155..26.302 rows=20 loops=1)
                                                   ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.126..26.205 rows=20 loops=1)
                                                         Hash Cond: (surgery.release_id = animal_release.id)
                                                         ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.494 rows=3923 loops=1)
                                                         ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=24.964..24.964 rows=20 loops=1)
                                                               Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                               ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.451..24.956 rows=20 loops=1)
                                                                     Hash Cond: (animal_release.animal_id = animal.id)
                                                                     ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.546 rows=3920 loops=1)
                                                                     ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.545..23.545 rows=20 loops=1)
                                                                           Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                           ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.526..23.533 rows=20 loops=1)
                                                                                 Hash Cond: (animal.species_id = species.id)
                                                                                 ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.499 rows=4023 loops=1)
                                                                                 ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.370..22.370 rows=1 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                       ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.515..22.365 rows=1 loops=1)
                                                                                             Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                             Rows Removed by Filter: 36586
                                                   ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=20)
                                                         Index Cond: (id = surgery.tag_id)
                                                         Heap Fetches: 0
                                             ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=20)
                                                   Index Cond: (tag_id = tag.id)
                                       ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.028..0.028 rows=0 loops=24)
                                             Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                             Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                             Rows Removed by Filter: 19
                                             ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.009..0.009 rows=19 loops=24)
                                                   Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                 ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.852..3.852 rows=5710 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                       ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.004..2.488 rows=5710 loops=1)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.556..1.556 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.141..1.198 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.002..0.224 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.130..0.130 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.088 rows=173 loops=1)
                     ->  Hash  (cost=81.32..81.32 rows=1964 width=104) (actual time=2.231..2.231 rows=1964 loops=1)
                           Buckets: 1024  Batches: 1  Memory Usage: 280kB
                           ->  Hash Join  (cost=8.68..81.32 rows=1964 width=104) (actual time=0.155..1.337 rows=1964 loops=1)
                                 Hash Cond: (installation_station.installation_id = installation.id)
                                 ->  Seq Scan on installation_station  (cost=0.00..45.64 rows=1964 width=57) (actual time=0.003..0.260 rows=1964 loops=1)
                                 ->  Hash  (cost=7.30..7.30 rows=110 width=63) (actual time=0.145..0.145 rows=110 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 12kB
                                       ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.050..0.113 rows=110 loops=1)
                                             Hash Cond: (installation.project_id = receiver_project.id)
                                             ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.010 rows=110 loops=1)
                                             ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.040..0.040 rows=75 loops=1)
                                                   Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                   ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.017 rows=75 loops=1)
               ->  Hash  (cost=286.00..286.00 rows=7227 width=28) (actual time=6.753..6.753 rows=7227 loops=1)
                     Buckets: 1024  Batches: 1  Memory Usage: 389kB
                     ->  Hash Join  (cost=1.36..286.00 rows=7227 width=28) (actual time=0.020..4.798 rows=7227 loops=1)
                           Hash Cond: (receiver.model_id = device_model.id)
                           ->  Seq Scan on device receiver  (cost=0.00..185.27 rows=7227 width=31) (actual time=0.002..0.985 rows=7227 loops=1)
                           ->  Hash  (cost=1.16..1.16 rows=16 width=13) (actual time=0.009..0.009 rows=16 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                 ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.004 rows=16 loops=1)
         ->  Hash  (cost=1.51..1.51 rows=51 width=35) (actual time=0.041..0.041 rows=51 loops=1)
               Buckets: 1024  Batches: 1  Memory Usage: 4kB
               ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.005..0.024 rows=51 loops=1)
 Total runtime: 42.014 ms
(79 rows)

-- Test Case 20 - 833188 ^ 5489 -> 210 rows
explain analyze select * from species_detection_extract_test_view
where spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 300000;
                                                                                                                                             QUERY PLAN                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2473.59..12305.40 rows=7 width=279) (actual time=272.568..276.870 rows=210 loops=1)
   ->  Nested Loop  (cost=2473.59..12305.40 rows=7 width=279) (actual time=272.567..276.827 rows=210 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 10500
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.003..0.008 rows=51 loops=1)
         ->  Materialize  (cost=2473.59..12288.44 rows=20 width=260) (actual time=5.075..5.317 rows=210 loops=51)
               ->  Nested Loop  (cost=2473.59..12288.34 rows=20 width=260) (actual time=258.815..269.998 rows=210 loops=1)
                     ->  Nested Loop  (cost=2473.44..12284.37 rows=20 width=254) (actual time=258.806..269.436 rows=210 loops=1)
                           ->  Nested Loop  (cost=2473.16..12277.66 rows=20 width=254) (actual time=258.795..268.732 rows=210 loops=1)
                                 Join Filter: (receiver.model_id = device_model.id)
                                 Rows Removed by Join Filter: 3150
                                 ->  Nested Loop  (cost=2473.16..12271.66 rows=20 width=257) (actual time=258.778..267.759 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2472.88..12263.40 rows=20 width=242) (actual time=258.766..266.965 rows=210 loops=1)
                                             Join Filter: (installation_station.installation_id = installation.id)
                                             Rows Removed by Join Filter: 22890
                                             ->  Hash Join  (cost=2.69..7.30 rows=110 width=63) (actual time=0.059..0.149 rows=110 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.024 rows=110 loops=1)
                                                   ->  Hash  (cost=1.75..1.75 rows=75 width=39) (actual time=0.042..0.042 rows=75 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.75 rows=75 width=39) (actual time=0.002..0.014 rows=75 loops=1)
                                             ->  Materialize  (cost=2470.19..12223.15 rows=20 width=195) (actual time=0.813..2.347 rows=210 loops=110)
                                                   ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=89.385..255.898 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=89.373..255.137 rows=210 loops=1)
                                                               ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=89.361..254.252 rows=210 loops=1)
                                                                     ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.984..28.505 rows=147 loops=1)
                                                                           ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.969..27.902 rows=119 loops=1)
                                                                                 ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.942..27.345 rows=119 loops=1)
                                                                                       Hash Cond: (surgery.release_id = animal_release.id)
                                                                                       ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.575 rows=3923 loops=1)
                                                                                       ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.827..25.827 rows=117 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                             ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.329..25.771 rows=117 loops=1)
                                                                                                   Hash Cond: (animal_release.animal_id = animal.id)
                                                                                                   ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.538 rows=3920 loops=1)
                                                                                                   ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=24.292..24.292 rows=125 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                                         ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=23.179..24.228 rows=125 loops=1)
                                                                                                               Hash Cond: (animal.species_id = species.id)
                                                                                                               ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.490 rows=4023 loops=1)
                                                                                                               ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=23.040..23.040 rows=1 loops=1)
                                                                                                                     Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                                     ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.731..23.033 rows=1 loops=1)
                                                                                                                           Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                                           Rows Removed by Filter: 36586
                                                                                 ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                       Index Cond: (id = surgery.tag_id)
                                                                                       Heap Fetches: 0
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                                 Index Cond: (tag_id = tag.id)
                                                                     ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.532..1.533 rows=1 loops=147)
                                                                           Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                                           ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.531..1.531 rows=0 loops=147)
                                                                                 ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.652..0.652 rows=5041 loops=147)
                                                                                       Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                                 ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.860..0.860 rows=5668 loops=147)
                                                                                       Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.003..0.003 rows=1 loops=210)
                                                                     Index Cond: (id = valid_detection.receiver_deployment_id)
                                                         ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=210)
                                                               Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=210)
                                             Index Cond: (id = receiver_deployment.receiver_id)
                                 ->  Materialize  (cost=0.00..1.24 rows=16 width=13) (actual time=0.000..0.002 rows=16 loops=210)
                                       ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.003..0.009 rows=16 loops=1)
                           ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.003 rows=1 loops=210)
                                 Index Cond: (id = valid_detection.receiver_download_id)
                     ->  Index Scan using sec_user_pkey on sec_user  (cost=0.14..0.19 rows=1 width=22) (actual time=0.001..0.002 rows=1 loops=210)
                           Index Cond: (id = receiver_download_file.requesting_user_id)
 Total runtime: 277.215 ms
(70 rows)

-- Test Case 21 - 5909 ^ 2153 ^ 17098775 -> 284 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018003'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.705..40.264 rows=284 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.703..40.186 rows=284 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=33.640..37.625 rows=284 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=33.631..36.893 rows=284 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=33.622..35.621 rows=284 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=32.044..33.865 rows=284 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.182..33.385 rows=1435 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.302..28.746 rows=1435 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.073..26.495 rows=27 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.061..26.383 rows=27 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.034..26.254 rows=27 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.512 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.003..25.003 rows=27 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.597..24.989 rows=27 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.003..0.520 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.582..23.582 rows=35 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.431..23.567 rows=35 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.469 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.399..22.399 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.501..22.390 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018003'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.003 rows=1 loops=27)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=27)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.026..0.065 rows=53 loops=27)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 27
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.018..0.018 rows=80 loops=27)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.868..3.868 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.003..2.550 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.091..0.091 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.047..0.085 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.034..0.059 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.016 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.017..0.017 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.015 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.010..0.017 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.566..1.566 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.146..1.165 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.004..0.187 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.132..0.132 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.003..0.089 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=284)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.001..0.002 rows=1 loops=284)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.001..0.002 rows=1 loops=284)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 40.600 ms
(73 rows)

-- Test Case 22 - 5909 ^ 833188 ^ 5489 -> 13 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2013-09-24 00:00:00+00' and '2013-09-24 04:00:00+00'
limit 300000;
                                                                                                                                       QUERY PLAN                                                                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2470.75..12251.27 rows=1 width=279) (actual time=89.031..259.238 rows=13 loops=1)
   ->  Nested Loop  (cost=2470.75..12251.27 rows=1 width=279) (actual time=89.029..259.231 rows=13 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 650
         ->  Nested Loop  (cost=2470.75..12249.09 rows=1 width=260) (actual time=88.958..258.894 rows=13 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 2236
               ->  Nested Loop  (cost=2470.75..12238.20 rows=1 width=254) (actual time=88.889..258.214 rows=13 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 195
                     ->  Nested Loop  (cost=2470.75..12236.84 rows=1 width=257) (actual time=88.879..258.125 rows=13 loops=1)
                           ->  Nested Loop  (cost=2470.47..12236.43 rows=1 width=242) (actual time=88.869..258.068 rows=13 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 197
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.025..0.065 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.010..0.022 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2470.47..12229.77 rows=20 width=195) (actual time=88.831..257.937 rows=210 loops=1)
                                       ->  Nested Loop  (cost=2470.19..12223.05 rows=20 width=195) (actual time=88.822..257.275 rows=210 loops=1)
                                             ->  Nested Loop  (cost=2469.92..12216.41 rows=20 width=146) (actual time=88.811..256.560 rows=210 loops=1)
                                                   ->  Nested Loop  (cost=2469.63..12207.44 rows=20 width=138) (actual time=88.798..255.755 rows=210 loops=1)
                                                         ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.552..28.083 rows=147 loops=1)
                                                               ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.538..27.449 rows=119 loops=1)
                                                                     ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.512..26.885 rows=119 loops=1)
                                                                           Hash Cond: (surgery.release_id = animal_release.id)
                                                                           ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.540 rows=3923 loops=1)
                                                                           ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.407..25.407 rows=117 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                                 ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.916..25.359 rows=117 loops=1)
                                                                                       Hash Cond: (animal_release.animal_id = animal.id)
                                                                                       ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.534 rows=3920 loops=1)
                                                                                       ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.878..23.878 rows=125 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                             ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.762..23.830 rows=125 loops=1)
                                                                                                   Hash Cond: (animal.species_id = species.id)
                                                                                                   ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.483 rows=4023 loops=1)
                                                                                                   ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.624..22.624 rows=1 loops=1)
                                                                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                         ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.377..22.616 rows=1 loops=1)
                                                                                                               Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                               Rows Removed by Filter: 36586
                                                                     ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=119)
                                                                           Index Cond: (id = surgery.tag_id)
                                                                           Heap Fetches: 0
                                                               ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=119)
                                                                     Index Cond: (tag_id = tag.id)
                                                         ->  Bitmap Heap Scan on valid_detection  (cost=449.34..457.36 rows=2 width=52) (actual time=1.546..1.546 rows=1 loops=147)
                                                               Recheck Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone) AND ((transmitter_id)::text = (sensor.transmitter_id)::text))
                                                               ->  BitmapAnd  (cost=449.34..449.34 rows=2 width=0) (actual time=1.544..1.544 rows=0 loops=147)
                                                                     ->  Bitmap Index Scan on valid_timestamp_index  (cost=0.00..98.10 rows=4554 width=0) (actual time=0.642..0.642 rows=5041 loops=147)
                                                                           Index Cond: (("timestamp" >= '2013-09-24 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-24 04:00:00+00'::timestamp with time zone))
                                                                     ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.883..0.883 rows=5668 loops=147)
                                                                           Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.44 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=210)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.003 rows=1 loops=210)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.33 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=210)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.003..0.003 rows=1 loops=13)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.002 rows=16 loops=13)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=13)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.006 rows=51 loops=13)
 Total runtime: 259.575 ms
(69 rows)

-- Test Case 23 - 5909 ^ 833188 ^ 17098775 -> 54 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Coffs Harbour line'
  and spcode = '37018021'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.567..1350.204 rows=54 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=33.565..1350.183 rows=54 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=33.491..1349.337 rows=54 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=33.472..1349.138 rows=54 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=33.461..1348.795 rows=54 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=31.848..1347.126 rows=54 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=30.867..1249.621 rows=694779 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=26.986..941.264 rows=694779 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.353..28.935 rows=147 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.338..27.982 rows=119 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.313..26.811 rows=119 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.583 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.206..25.206 rows=117 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 11kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.691..25.151 rows=117 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.562 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.653..23.653 rows=125 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.539..23.609 rows=125 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.472 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.400..22.400 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=20.176..22.392 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37018021'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.006..0.007 rows=1 loops=119)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.004..0.006 rows=1 loops=119)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=1.221..4.852 rows=4726 loops=147)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 942
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.920..0.920 rows=5668 loops=147)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.870..3.870 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.534 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.090..0.090 rows=15 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.046..0.076 rows=15 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.033..0.057 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.012 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.016..0.016 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.016 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Coffs Harbour line'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.011..0.015 rows=15 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.599..1.599 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.147..1.202 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.005..0.219 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.132..0.132 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.086 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=54)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=54)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=54)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 1350.518 ms
(73 rows)

-- Test Case 24 - 2716283 ^ 464 ^ 3129 -> 2 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 300000;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.570..30.432 rows=2 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.568..30.429 rows=2 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 100
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.496..30.322 rows=2 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 344
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=27.428..30.201 rows=2 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 30
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=27.417..30.179 rows=2 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=27.409..30.167 rows=2 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.025..0.066 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.023 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=27.378..30.094 rows=2 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=27.366..30.077 rows=2 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=27.354..30.061 rows=2 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=27.328..30.029 rows=2 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=27.313..30.009 rows=2 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.129..2.604 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=26.545..26.545 rows=24 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 3kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.393..26.521 rows=24 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.366..26.414 rows=20 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.002..0.493 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.208..25.208 rows=20 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.699..25.200 rows=20 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.532 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.783..23.783 rows=20 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.727..23.770 rows=20 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.496 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.569..22.569 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.658..22.563 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.004..0.004 rows=1 loops=20)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.007..0.007 rows=1 loops=2)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.012..0.012 rows=1 loops=2)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.005..0.006 rows=1 loops=2)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.005..0.006 rows=1 loops=2)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.005 rows=1 loops=2)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.002..0.005 rows=16 loops=2)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=2)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.002..0.009 rows=51 loops=2)
 Total runtime: 30.757 ms
(66 rows)

-- Test Case 25 - 2716283 ^ 464 ^ 17098775 -> 4 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37346004'
  and timestamp between '2012-03-01' and '2013-09-01'
limit 300000;
                                                                                                     QUERY PLAN                                                                                                     
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2730.53..37239.14 rows=311 width=279) (actual time=31.123..32.977 rows=4 loops=1)
   ->  Nested Loop  (cost=2730.53..37239.14 rows=311 width=279) (actual time=31.121..32.974 rows=4 loops=1)
         ->  Nested Loop  (cost=2730.39..37070.26 rows=934 width=260) (actual time=31.056..32.877 rows=4 loops=1)
               ->  Nested Loop  (cost=2730.26..36914.60 rows=934 width=263) (actual time=31.048..32.860 rows=4 loops=1)
                     ->  Hash Join  (cost=2729.98..36529.16 rows=934 width=248) (actual time=31.038..32.835 rows=4 loops=1)
                           Hash Cond: (valid_detection.receiver_download_id = receiver_download_file.id)
                           ->  Hash Join  (cost=2639.56..36425.85 rows=949 width=242) (actual time=29.424..31.217 rows=4 loops=1)
                                 Hash Cond: (receiver_deployment.station_id = installation_station.id)
                                 ->  Hash Join  (cost=2631.61..36141.45 rows=71203 width=146) (actual time=29.135..31.077 rows=6 loops=1)
                                       Hash Cond: (valid_detection.receiver_deployment_id = receiver_deployment.id)
                                       ->  Nested Loop  (cost=2372.13..34457.92 rows=71203 width=138) (actual time=25.265..27.202 rows=6 loops=1)
                                             ->  Nested Loop  (cost=2020.30..2145.01 rows=22 width=86) (actual time=25.223..26.489 rows=24 loops=1)
                                                   ->  Nested Loop  (cost=2020.01..2137.73 rows=20 width=88) (actual time=25.208..26.389 rows=20 loops=1)
                                                         ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.183..26.293 rows=20 loops=1)
                                                               Hash Cond: (surgery.release_id = animal_release.id)
                                                               ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.508 rows=3923 loops=1)
                                                               ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.018..25.018 rows=20 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                     ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=24.505..25.008 rows=20 loops=1)
                                                                           Hash Cond: (animal_release.animal_id = animal.id)
                                                                           ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.002..0.558 rows=3920 loops=1)
                                                                           ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.607..23.607 rows=20 loops=1)
                                                                                 Buckets: 1024  Batches: 1  Memory Usage: 2kB
                                                                                 ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.537..23.596 rows=20 loops=1)
                                                                                       Hash Cond: (animal.species_id = species.id)
                                                                                       ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.002..0.472 rows=4023 loops=1)
                                                                                       ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.381..22.381 rows=1 loops=1)
                                                                                             Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                             ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=6.489..22.375 rows=1 loops=1)
                                                                                                   Filter: ((COALESCE(spcode, ''::character varying))::text = '37346004'::text)
                                                                                                   Rows Removed by Filter: 36586
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.003..0.004 rows=1 loops=20)
                                                               Index Cond: (id = surgery.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.35 rows=1 width=22) (actual time=0.003..0.004 rows=1 loops=20)
                                                         Index Cond: (tag_id = tag.id)
                                             ->  Bitmap Heap Scan on valid_detection  (cost=351.84..1389.08 rows=7969 width=52) (actual time=0.028..0.028 rows=0 loops=24)
                                                   Recheck Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                                   Filter: (("timestamp" >= '2012-03-01 00:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-09-01 00:00:00+00'::timestamp with time zone))
                                                   Rows Removed by Filter: 19
                                                   ->  Bitmap Index Scan on valid_transmitterid_index  (cost=0.00..349.84 rows=26017 width=0) (actual time=0.009..0.009 rows=19 loops=24)
                                                         Index Cond: ((transmitter_id)::text = (sensor.transmitter_id)::text)
                                       ->  Hash  (cost=188.10..188.10 rows=5710 width=24) (actual time=3.859..3.859 rows=5710 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 313kB
                                             ->  Seq Scan on receiver_deployment  (cost=0.00..188.10 rows=5710 width=24) (actual time=0.002..2.529 rows=5710 loops=1)
                                 ->  Hash  (cost=7.63..7.63 rows=26 width=104) (actual time=0.126..0.126 rows=45 loops=1)
                                       Buckets: 1024  Batches: 1  Memory Usage: 6kB
                                       ->  Nested Loop  (cost=2.23..7.63 rows=26 width=104) (actual time=0.048..0.104 rows=45 loops=1)
                                             ->  Hash Join  (cost=1.95..5.47 rows=1 width=63) (actual time=0.033..0.057 rows=1 loops=1)
                                                   Hash Cond: (installation.project_id = receiver_project.id)
                                                   ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.017 rows=110 loops=1)
                                                   ->  Hash  (cost=1.94..1.94 rows=1 width=39) (actual time=0.017..0.017 rows=1 loops=1)
                                                         Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                         ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.006..0.016 rows=1 loops=1)
                                                               Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                                               Rows Removed by Filter: 74
                                             ->  Index Scan using installation_station_installation_id_index on installation_station  (cost=0.28..1.97 rows=19 width=57) (actual time=0.012..0.034 rows=45 loops=1)
                                                   Index Cond: (installation_id = installation.id)
                           ->  Hash  (cost=71.73..71.73 rows=1495 width=22) (actual time=1.601..1.601 rows=1495 loops=1)
                                 Buckets: 1024  Batches: 1  Memory Usage: 81kB
                                 ->  Hash Join  (cost=10.89..71.73 rows=1495 width=22) (actual time=0.147..1.190 rows=1495 loops=1)
                                       Hash Cond: (receiver_download_file.requesting_user_id = sec_user.id)
                                       ->  Seq Scan on receiver_download_file  (cost=0.00..40.19 rows=1519 width=16) (actual time=0.005..0.194 rows=1519 loops=1)
                                       ->  Hash  (cost=8.73..8.73 rows=173 width=22) (actual time=0.133..0.133 rows=173 loops=1)
                                             Buckets: 1024  Batches: 1  Memory Usage: 10kB
                                             ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.002..0.091 rows=173 loops=1)
                     ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.004..0.004 rows=1 loops=4)
                           Index Cond: (id = receiver_deployment.receiver_id)
               ->  Index Scan using device_model_pkey on device_model  (cost=0.14..0.16 rows=1 width=13) (actual time=0.002..0.002 rows=1 loops=4)
                     Index Cond: (id = receiver.model_id)
         ->  Index Scan using organisation_pkey on organisation  (cost=0.14..0.16 rows=1 width=35) (actual time=0.002..0.003 rows=1 loops=4)
               Index Cond: (id = receiver.organisation_id)
 Total runtime: 33.274 ms
(73 rows)

-- Test Case 26 - 2716283 ^ 3913743 ^ 3129 -> 52 rows
explain analyze select * from species_detection_extract_test_view
where project = 'AATAMS Heron Island'
  and spcode = '37018030'
  and timestamp between '2013-04-02 05:00:00+00' and '2013-04-02 07:00:00+00'
limit 300000;
                                                                                                          QUERY PLAN                                                                                                           
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.956..43.520 rows=52 loops=1)
   ->  Nested Loop  (cost=2141.26..7406.23 rows=1 width=279) (actual time=27.955..43.501 rows=52 loops=1)
         Join Filter: (receiver.organisation_id = organisation.id)
         Rows Removed by Join Filter: 2600
         ->  Nested Loop  (cost=2141.26..7404.06 rows=1 width=260) (actual time=27.884..42.302 rows=52 loops=1)
               Join Filter: (receiver_download_file.requesting_user_id = sec_user.id)
               Rows Removed by Join Filter: 8944
               ->  Nested Loop  (cost=2141.26..7393.16 rows=1 width=254) (actual time=27.816..39.725 rows=52 loops=1)
                     Join Filter: (receiver.model_id = device_model.id)
                     Rows Removed by Join Filter: 780
                     ->  Nested Loop  (cost=2141.26..7391.80 rows=1 width=257) (actual time=27.805..39.385 rows=52 loops=1)
                           ->  Nested Loop  (cost=2140.98..7391.39 rows=1 width=242) (actual time=27.797..39.185 rows=52 loops=1)
                                 Join Filter: (installation.id = installation_station.installation_id)
                                 Rows Removed by Join Filter: 554
                                 ->  Nested Loop  (cost=0.00..6.41 rows=1 width=63) (actual time=0.025..0.064 rows=1 loops=1)
                                       Join Filter: (installation.project_id = receiver_project.id)
                                       Rows Removed by Join Filter: 109
                                       ->  Seq Scan on project receiver_project  (cost=0.00..1.94 rows=1 width=39) (actual time=0.011..0.023 rows=1 loops=1)
                                             Filter: ((name)::text = 'AATAMS Heron Island'::text)
                                             Rows Removed by Filter: 74
                                       ->  Seq Scan on installation  (cost=0.00..3.10 rows=110 width=32) (actual time=0.002..0.018 rows=110 loops=1)
                                 ->  Nested Loop  (cost=2140.98..7384.85 rows=10 width=195) (actual time=27.766..38.967 rows=606 loops=1)
                                       ->  Nested Loop  (cost=2140.70..7381.20 rows=10 width=195) (actual time=27.754..37.038 rows=606 loops=1)
                                             ->  Nested Loop  (cost=2140.42..7377.88 rows=10 width=146) (actual time=27.741..35.001 rows=606 loops=1)
                                                   ->  Nested Loop  (cost=2140.14..7371.95 rows=10 width=138) (actual time=27.682..32.740 rows=606 loops=1)
                                                         ->  Hash Join  (cost=2139.86..7368.60 rows=10 width=154) (actual time=27.668..30.822 rows=606 loops=1)
                                                               Hash Cond: ((valid_detection.transmitter_id)::text = (sensor.transmitter_id)::text)
                                                               ->  Index Scan using valid_timestamp_index on valid_detection  (cost=0.56..5220.91 rows=2213 width=52) (actual time=0.037..1.851 rows=2743 loops=1)
                                                                     Index Cond: (("timestamp" >= '2013-04-02 05:00:00+00'::timestamp with time zone) AND ("timestamp" <= '2013-04-02 07:00:00+00'::timestamp with time zone))
                                                               ->  Hash  (cost=2139.02..2139.02 rows=22 width=102) (actual time=27.605..27.605 rows=215 loops=1)
                                                                     Buckets: 1024  Batches: 1  Memory Usage: 30kB
                                                                     ->  Nested Loop  (cost=2020.01..2139.02 rows=22 width=102) (actual time=25.461..27.450 rows=215 loops=1)
                                                                           ->  Hash Join  (cost=2019.73..2130.87 rows=20 width=80) (actual time=25.436..26.756 rows=168 loops=1)
                                                                                 Hash Cond: (surgery.release_id = animal_release.id)
                                                                                 ->  Seq Scan on surgery  (cost=0.00..96.23 rows=3923 width=16) (actual time=0.003..0.534 rows=3923 loops=1)
                                                                                 ->  Hash  (cost=2019.48..2019.48 rows=20 width=72) (actual time=25.412..25.412 rows=167 loops=1)
                                                                                       Buckets: 1024  Batches: 1  Memory Usage: 17kB
                                                                                       ->  Hash Join  (cost=1852.39..2019.48 rows=20 width=72) (actual time=23.899..25.356 rows=167 loops=1)
                                                                                             Hash Cond: (animal_release.animal_id = animal.id)
                                                                                             ->  Seq Scan on animal_release  (cost=0.00..152.20 rows=3920 width=32) (actual time=0.001..0.554 rows=3920 loops=1)
                                                                                             ->  Hash  (cost=1852.14..1852.14 rows=20 width=56) (actual time=23.814..23.814 rows=174 loops=1)
                                                                                                   Buckets: 1024  Batches: 1  Memory Usage: 16kB
                                                                                                   ->  Hash Join  (cost=1766.62..1852.14 rows=20 width=56) (actual time=22.553..23.752 rows=174 loops=1)
                                                                                                         Hash Cond: (animal.species_id = species.id)
                                                                                                         ->  Seq Scan on animal  (cost=0.00..70.23 rows=4023 width=16) (actual time=0.003..0.480 rows=4023 loops=1)
                                                                                                         ->  Hash  (cost=1764.34..1764.34 rows=183 width=56) (actual time=22.526..22.526 rows=1 loops=1)
                                                                                                               Buckets: 1024  Batches: 1  Memory Usage: 1kB
                                                                                                               ->  Seq Scan on species  (cost=0.00..1764.34 rows=183 width=56) (actual time=19.624..22.518 rows=1 loops=1)
                                                                                                                     Filter: ((COALESCE(spcode, ''::character varying))::text = '37018030'::text)
                                                                                                                     Rows Removed by Filter: 36586
                                                                           ->  Index Scan using sensor_tag_id_transmitter_type_id_key on sensor  (cost=0.28..0.40 rows=1 width=22) (actual time=0.003..0.003 rows=1 loops=168)
                                                                                 Index Cond: (tag_id = surgery.tag_id)
                                                         ->  Index Only Scan using device_pkey on device tag  (cost=0.28..0.33 rows=1 width=8) (actual time=0.002..0.002 rows=1 loops=606)
                                                               Index Cond: (id = sensor.tag_id)
                                                               Heap Fetches: 0
                                                   ->  Index Scan using receiver_deployment_pkey on receiver_deployment  (cost=0.28..0.58 rows=1 width=24) (actual time=0.002..0.003 rows=1 loops=606)
                                                         Index Cond: (id = valid_detection.receiver_deployment_id)
                                             ->  Index Scan using installation_station_pkey on installation_station  (cost=0.28..0.32 rows=1 width=57) (actual time=0.002..0.002 rows=1 loops=606)
                                                   Index Cond: (id = receiver_deployment.station_id)
                                       ->  Index Scan using receiver_download_file_pkey on receiver_download_file  (cost=0.28..0.36 rows=1 width=16) (actual time=0.002..0.002 rows=1 loops=606)
                                             Index Cond: (id = valid_detection.receiver_download_id)
                           ->  Index Scan using device_pkey on device receiver  (cost=0.28..0.40 rows=1 width=31) (actual time=0.002..0.003 rows=1 loops=52)
                                 Index Cond: (id = receiver_deployment.receiver_id)
                     ->  Seq Scan on device_model  (cost=0.00..1.16 rows=16 width=13) (actual time=0.001..0.003 rows=16 loops=52)
               ->  Seq Scan on sec_user  (cost=0.00..8.73 rows=173 width=22) (actual time=0.001..0.024 rows=173 loops=52)
         ->  Seq Scan on organisation  (cost=0.00..1.51 rows=51 width=35) (actual time=0.001..0.007 rows=51 loops=52)
 Total runtime: 43.830 ms
(67 rows)

\q
